\documentclass[12pt]{article}
\usepackage{import}
\input{/Users/henrytwiss/Documents/Documents/LaTeX/Vignettes/preamble.tex}

%=================%
%  Title & Index  %
%=================%
\title{Summation formulas}
\author{Henry Twiss}
\makeindex

\begin{document}
  \date{}
  \maketitle
  \section{Summation Formulas}
    Summation formulas are important because they often allow for a difficult to estimate sums to be replaced with one that is much easier to estimate. In fact, the most useful summation formulas replace a discrete sum with an integral of a continuous function. This allows for much more precise estimation of the original sum. We first setup some notation. If \((a_{n})_{n \ge 1}\) is a sequence of complex numbers for every \(X \ge 0\) let
    \[
        A(X) = \sum_{n \le X}a_{n}.
    \]
    Note that \(A(X) = 0\) unless \(X \ge 1\). The most well-known summation formula is (classical) \textbf{summation by parts}\index{summation by parts}:

    \begin{theorem*}[Summation by parts, classical]
      Let \((a_{n})_{n \ge 1}\) and \((b_{n})_{n \ge 1}\) be two sequences of complex numbers. Then for any positive integers \(N\) and \(M\) with \(1 \le M \le N\), we have
      \[
        \sum_{M \le n \le N}a_{n}(b_{n+1}-b_{n}) = (a_{N+1}b_{N+1}-a_{M}b_{M})-\sum_{M \le n \le N}b_{n+1}(a_{n+1}-a_{n}).
      \]
    \end{theorem*}
    \begin{proof}
      It is equivalent to prove that
      \[
        \sum_{M \le n \le N}a_{n}(b_{n+1}-b_{n})+\sum_{M \le n \le N}b_{n+1}(a_{n+1}-a_{n}) = (a_{N+1}b_{N+1}-a_{M}b_{M}).
      \]
      This is just a computation:
      \begin{align*}
        \sum_{M \le n \le N}a_{n}(b_{n+1}-b_{n})+\sum_{M \le n \le N}b_{n+1}(a_{n+1}-a_{n}) &= \sum_{M \le n \le N}a_{n}b_{n+1}-a_{n}b_{n}+a_{n+1}b_{n+1}-a_{n}b_{n+1} \\
        &= \sum_{M \le n \le N}a_{n+1}b_{n+1}-a_{n}b_{n} \\
        &= a_{N+1}b_{N+1}-a_{M}b_{M}.
      \end{align*}
    \end{proof}

    Replacing the sequences \((a_{n})_{n \ge 1}\) and \((b_{n})_{n \ge 1}\) with \((b_{n})_{n \ge 0}\) and \((A(n-1))_{n \ge 1}\) respectively gives (partial sum) \textbf{summation by parts}\index{summation by parts}:

    \begin{theorem*}[Summation by parts, partial sum]
      Let \((a_{n})_{n \ge 1}\) and \((b_{n})_{n \ge 0}\) be two sequences of complex numbers. Then for any integers \(M\) and \(N\) with \(0 \le M \le N\), we have
      \[
        \sum_{M+1 \le n \le N}a_{n}b_{n} = A(N)b_{N}-A(M)b_{M}-\sum_{M \le n \le N-1}A(n)(b_{n+1}-b_{n}).
      \]
    \end{theorem*}
    \begin{proof}
      Classical summation by parts gives
      \[
        \sum_{M+1 \le n \le N}b_{n}(A(n)-A(n-1)) = A(N)b_{N+1}-A(M)b_{M+1}-\sum_{M+1 \le n \le N}A(n)(b_{n+1}-b_{n}).
      \]
      As \(A(n)-A(n-1) = a_{n}\), this formula becomes
      \[
        \sum_{M+1 \le n \le N}a_{n}b_{n} = A(N)b_{N+1}-A(M)b_{M+1}-\sum_{M+1 \le n \le N}A(n)(b_{n+1}-b_{n}),
      \]
      which we can rewrite as
      \[
        \sum_{M+1 \le n \le N}a_{n}b_{n} = A(N)b_{N}-A(M)b_{M}-\sum_{M \le n \le N-1}A(n)(b_{n+1}-b_{n}).
      \]
      This is the desired formula so the proof is complete.
    \end{proof}
    
    Taking \(M = 0\) gives a useful corollary:

    \begin{corollary}\label{cor:partial_sum_summation_by_parts_corollary}
      Let \((a_{n})_{n \ge 1}\) and \((b_{n})_{n \ge 0}\) be two sequences of complex numbers. Then for any positive integer \(N \ge 1\), we have
      \[
        \sum_{n \le N}a_{n}b_{n} = A(N)b_{N}-\sum_{n \le N-1}A(n)(b_{n+1}-b_{n}).
      \]
    \end{corollary}
    \begin{proof}
      Taking \(M = 0\) in partial sum summation by parts and observing that \(A(M) = 0\) gives the result.
    \end{proof}
    
    Both classical and partial sum summation by parts give ways of rewriting finite sums. If we want to express a finite sum in the form of an integral, we need to do more work. One of the most well-known results of this type is known as \textbf{Abel's summation formula}\index{Abel's summation formula}:

    \begin{theorem*}[Abel's summation formula]
      Let \((a_{n})_{n \ge 1}\) be a sequence of complex numbers. For any \(X\) and \(Y\) with \(0 \le X < Y\) and continuously differentiable function \(\phi:[X,Y] \to \C\), we have
      \[
        \sum_{X < n \le Y}a_{n}\phi(n) = A(Y)\phi(Y)-A(X)\phi(X)-\int_{X}^{Y}A(u)\phi'(u)\,du.
      \]
    \end{theorem*}
    \begin{proof}
      Let \(M = \lfloor X \rfloor\) and \(N = \lfloor Y \rfloor\) so that \(0 \le M \le N\). Then \(X < n \le Y\) if and only if \(M+1 \le n \le N\), so that partial sum summation by parts gives
      \[
        \sum_{X < n \le Y}a_{n}\phi(n) = A(N)\phi(N)-A(M)\phi(M)-\sum_{M \le n \le N-1}A(n)(\phi(n+1)-\phi(n)).
      \]
      As \(\phi\) is continuously differentiable, we can express the sum on the right-hand side as
      \begin{align*}
        \sum_{M \le n \le N-1}A(n)(\phi(n+1)-\phi(n)) &= \sum_{M \le n \le N-1}A(n)\int_{n}^{n+1}\phi'(u)\,du \\
        &= \sum_{M \le n \le N-1}\int_{n}^{n+1}A(u)\phi'(u)\,du \\
        &= \int_{M}^{N}A(u)\phi'(u)\,du,
      \end{align*}
      where in the second equality we have used that \(A(u)\) is constant on the interval \([n,n+1)\) for every \(n \ge 0\). Thus
      \[
        \sum_{X < n \le Y}a_{n}\phi(n) = A(N)\phi(N)-A(M)\phi(M)-\int_{M}^{N}A(u)\phi'(u)\,du.
      \]
      Using again the fact that \(A(u)\) is constant on the interval \([n,n+1)\) for every \(n \ge 0\), we can express the integral as
      \begin{align*}
        \int_{M}^{N}A(u)\phi'(u)\,du &= \int_{X}^{Y}A(u)\phi'(u)\,du+\int_{M}^{X}A(u)\phi'(u)\,du-\int_{N}^{Y}A(u)\phi'(u)\,du \\
        &= \int_{X}^{Y}A(u)\phi'(u)\,du+A(M)\int_{M}^{X}\phi'(u)\,du-A(N)\int_{N}^{Y}\phi'(u)\,du \\
        &= \int_{X}^{Y}A(u)\phi'(u)\,du+A(M)\phi(X)-A(M)\phi(M)-A(N)\phi(Y)+A(N)\phi(N) \\
        &= \int_{X}^{Y}A(u)\phi'(u)\,du+A(X)\phi(X)-A(M)\phi(M)-A(Y)\phi(Y)+A(N)\phi(N).
      \end{align*}
      Substituting this result gives 
      \[
        \sum_{X < n \le Y}a_{n}\phi(n) = A(Y)\phi(Y)-A(X)\phi(X)-\int_{X}^{Y}A(u)\phi'(u)\,du,
      \]
      which is the desired formula.
    \end{proof}

    There are also some useful corollaries. The first is when we sum every term up to \(Y\):

    \begin{corollary}\label{cor:Abels_summation_formula_zero_version}
      Let \((a_{n})_{n \ge 1}\) be a sequence of complex numbers. For any \(Y > 0\) and continuously differentiable function \(\phi:(0,Y] \to \C\), we have
      \[
        \sum_{n \le Y}a_{n}\phi(n) = A(Y)\phi(Y)-\int_{1}^{Y}A(u)\phi'(u)\,du.
      \]
    \end{corollary}
    \begin{proof}
      This follows from Abel's summation formula upon letting \(0 < X < 1\) and noting that \(A(u) = 0\) on the interval \([0,1)\).
    \end{proof}
    
    The second corollary is useful as it extends Abel's summation formula to infinite sums:

    \begin{corollary}\label{cor:Abels_summation_formula_limit_version}
      Let \((a_{n})_{n \ge 1}\) be a sequence of complex numbers. For any \(X \ge 0\) and continuously differentiable function \(\phi:[X,\infty) \to \C\), we have
      \[
        \sum_{n > X}a_{n}\phi(n) = \lim_{Y \to \infty}A(Y)\phi(Y)-A(X)\phi(X)-\int_{X}^{\infty}A(u)\phi'(u)\,du.
      \]
    \end{corollary}
    \begin{proof}
      This follows from Abel's summation formula upon taking the limit as \(Y \to \infty\).
    \end{proof}

    The last corollary is a combination of the former two:

    \begin{corollary}\label{cor:Abels_summation_formula_limit_version_specialization}
      Let \((a_{n})_{n \ge 1}\) be a sequence of complex numbers. For any continuously differentiable function \(\phi:(0,\infty) \to \C\), we have
      \[
        \sum_{n \ge 1}a_{n}\phi(n) = \lim_{Y \to \infty}A(Y)\phi(Y)-\int_{1}^{\infty}A(u)\phi'(u)\,du.
      \]
    \end{corollary}
    \begin{proof}
       This follows from \cref{cor:Abels_summation_formula_zero_version} upon taking the limit as \(Y \to \infty\).
    \end{proof}

    Abel's summation formula and its corollaries are immensely useful for approximating finite or infinite sums by integrals. In the special case where \(a_{n} = 1\) for \(n \ge 1\), we are really estimating the sum of a continuously differentiable function at integer values. We can very well use Abel's summation formula here, but it's possible to improve the result by appealing to integration by parts. If we do this, we obtain a result known as the \textbf{Euler-Maclaurin summation formula}\index{Euler-Maclaurin summation formula}:

    \begin{theorem*}[Euler-Maclaurin summation formula]
      For any \(X\) and \(Y\) with \(0 \le X < Y\) and continuously differentiable function \(\phi:[X,Y] \to \C\), we have
      \[
        \sum_{X < n \le Y}\phi(n) = \left(X-\lfloor X \rfloor-\frac{1}{2}\right)\phi(X)-\left(Y-\lfloor Y \rfloor-\frac{1}{2}\right)\phi(Y)+\int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du.
      \]
    \end{theorem*}
    \begin{proof}
      Let \(M = \lfloor X \rfloor\) and \(N = \lfloor Y \rfloor\) so that \(0 \le M \le N\). Then \(X < n \le Y\) if and only if \(M+1 \le n \le N\), so that partial sum summation by parts gives
      \[
        \sum_{X < n \le Y}\phi(n) = N\phi(N)-M\phi(M)-\sum_{M \le n \le N-1}n(\phi(n+1)-\phi(n)).
      \]
      Now observe that
      \[
        \sum_{M \le n \le N-1}(n-M-1)(\phi(n+1)-\phi(n)) = (M+1)\phi(M)-(M+1)\phi(N)+\sum_{M \le n \le N-1}n(\phi(n+1)-\phi(n)),
      \]
      since the sum on the left-hand side telescopes. Using this identity to replace the sum above, we obtain
      \[
        \sum_{X < n \le Y}\phi(n) = (N-M-1)\phi(N)+\phi(M)-\sum_{M \le n \le N-1}(n-M-1)(\phi(n+1)-\phi(n)).
      \]
      As \(\phi\) is continuously differentiable, we can express the sum on the right-hand side as
      \begin{align*}
       \sum_{M \le n \le N-1}(n-M-1)(\phi(n+1)-\phi(n)) &= \sum_{M \le n \le N-1}(n-M-1)\int_{n}^{n+1}\phi'(u)\,du \\
        &= \sum_{M \le n \le N-1}\int_{n}^{n+1}(\lfloor u \rfloor-M-1)\phi'(u)\,du \\
        &= \int_{M}^{N}(\lfloor u \rfloor-M-1)\phi'(u)\,du \\
        &= -(M+1)\int_{M}^{N}\phi'(u)\,du+\int_{M}^{N}\lfloor u \rfloor\phi'(u)\,du \\
        &= (M+1)\phi(M)-(M+1)\phi(N)+\int_{M}^{N}\lfloor u \rfloor\phi'(u)\,du,
      \end{align*}
      where in the second equality we have used that \(\lfloor u \rfloor\) is constant on the interval \([n,n+1)\) for every \(n \ge 0\). Thus
      \[
        \sum_{X < n \le Y}\phi(n) = N\phi(N)-M\phi(M)-\int_{M}^{N}\lfloor u \rfloor\phi'(u)\,du.
      \]
      We will continue to rewrite the right-hand side. Integration by parts shows that
      \[
        \int_{M}^{N}u\phi'(u)\,du = N\phi(N)-M\phi(M)-\int_{M}^{N}\phi(u)\,du,
      \]
      and therefore our previous identity becomes
      \begin{align*}
        \sum_{X < n \le Y}\phi(n) = \int_{M}^{N}\phi(u)+(u-\lfloor u \rfloor)\phi'(u)\,du.
      \end{align*}
      Using the identity
      \[
        \frac{\phi(N)-\phi(M)}{2} = \int_{M}^{N}\frac{1}{2}\phi'(u)\,du,
      \]
      we get
      \[
        \sum_{X < n \le Y}\phi(n) = \frac{\phi(N)-\phi(M)}{2}+\int_{M}^{N}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du.
      \]
      Using again that \(\lfloor u \rfloor\) is constant on the interval \([n,n+1)\) for every \(n \ge 0\), we can express the integral as
      \begin{align*}
        \int_{M}^{N}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du &= \int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du \\
        &+ \int_{M}^{X}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du \\
        &- \int_{N}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du \\
        &= \int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du \\
        &+M\phi(M)-M\phi(X)+\frac{\phi(M)-\phi(X)}{2}+\int_{M}^{X}\phi(u)+u\phi'(u)\,du \\
        &+N\phi(Y)-N\phi(N)+\frac{\phi(Y)-\phi(N)}{2}-\int_{N}^{Y}\phi(u)+u\phi'(u)\,du \\
        &= \int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du \\
        &+M\phi(M)-M\phi(X)+\frac{\phi(M)-\phi(X)}{2}+\int_{M}^{X}\phi(u)\,du+\int_{M}^{X}u\phi'(u)\,du \\
        &+N\phi(Y)-N\phi(N)+\frac{\phi(Y)-\phi(N)}{2}-\int_{N}^{Y}\phi(u)\,du-\int_{N}^{Y}u\phi'(u)\,du.
      \end{align*}
      Two more applications of integration by parts shows that
      \[
        \int_{M}^{X}u\phi'(u)\,du = X\phi(X)-M\phi(M)-\int_{M}^{X}\phi(u)\,du,
      \]
      and
      \[
        \int_{N}^{Y}u\phi'(u)\,du = Y\phi(Y)-N\phi(N)-\int_{N}^{Y}\phi(u)\,du,
      \]
      whence
      \begin{align*}
        \int_{M}^{N}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du &= \frac{\phi(M)-\phi(N)}{2}+\left(X-M-\frac{1}{2}\right)\phi(X)-\left(Y-N-\frac{1}{2}\right)\phi(Y) \\
        &+ \int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du.
      \end{align*}
      Substituting this result back into our formula above gives
      \[
        \sum_{X < n \le Y}\phi(n) = \left(X-M-\frac{1}{2}\right)\phi(X)-\left(Y-N-\frac{1}{2}\right)\phi(Y)+\int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du,
      \]
      which is equivalent to
      \[
        \sum_{X < n \le Y}\phi(n) = \left(X-\lfloor X \rfloor-\frac{1}{2}\right)\phi(X)-\left(Y-\lfloor Y \rfloor-\frac{1}{2}\right)\phi(Y)+\int_{X}^{Y}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du,
      \]
      since \(M = \lfloor X \rfloor\) and \(N = \lfloor Y \rfloor\), thus completing the proof.
    \end{proof}

    Like Abel's summation formula, there are some useful corollaries. The first one is in the special case where both \(X\) and \(Y\) are integers:

    \begin{corollary}\label{cor:Euler_Maclaurin_summation_formula_integer_version}
      For any integers \(M\) and \(N\) with \(0 \le M < N\) and continuously differentiable function \(\phi:[M,N] \to \C\), we have
      \[
        \sum_{M < n \le N}\phi(n) = \frac{\phi(M)-\phi(N)}{2}+\int_{M}^{N}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du.
      \]
    \end{corollary}
    \begin{proof}
      This follows immediately from the Euler-Maclaurin summation formula since \(M-\lfloor M \rfloor = 0\) and \(N-\lfloor N \rfloor = 0\).
    \end{proof}

    The second corollary deals with infinite sums:

    \begin{corollary}\label{cor:Euler_Maclaurin_summation_formula_integer_limit_version_specialization}
      For any integer \(M \ge 0\) and continuously differentiable function \(\phi:[M,\infty) \to \C\), we have
      \[
        \sum_{n > M}\phi(n) = \lim_{N \to \infty}\frac{\phi(M)-\phi(N)}{2}+\int_{M}^{\infty}\phi(u)+\left(u-\lfloor u \rfloor-\frac{1}{2}\right)\phi'(u)\,du.
      \]
    \end{corollary}
    \begin{proof}
      This follows from \cref{cor:Euler_Maclaurin_summation_formula_integer_version} upon taking the limit as \(N \to \infty\).
    \end{proof}
\end{document}