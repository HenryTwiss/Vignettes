\documentclass[12pt]{article}
\usepackage{import}
\input{/Users/henrytwiss/Documents/Documents/LaTeX/Vignettes/preamble.tex}

%=================%
%  Title & Index  %
%=================%
\title{The Poisson summation formula}
\author{Henry Twiss}
\makeindex

\begin{document}
  \date{}
  \maketitle
  \section{The Fourier Transform}
    Let \(f(\mathbf{x})\) be absolutely integrable on \(\R^{n}\). Its \textit{Fourier transform} \((\mc{F}f)(\boldsymbol{\xi})\) is defined by
    \[
      (\mc{F}f)(\boldsymbol{\xi}) = \int_{\R^{n}}f(\mathbf{x})e^{-2\pi i\<\boldsymbol{\xi},\mathbf{x}\>}\,d\mathbf{x},
    \]
    for \(\boldsymbol{\xi} \in \R^{n}\). It is absolutely bounded precisely because \(f(\mathbf{x})\) is absolutely integrable on \(\R^{n}\). Let us first demonstrate some properties of the Fourier transform.

    \begin{proposition}
      Let \(f(\mathbf{x})\) and \(g(\mathbf{x})\) be absolutely integrable on \(\R^{n}\). Then the following properties hold:
      \begin{enumerate}[label*=(\roman*)]
        \item For any \(\a,\b \in \R\), we have
        \[
          (\mc{F}(\a f+\b g))(\boldsymbol{\xi}) = \a(\mc{F}f)(\boldsymbol{\xi})+\b(\mc{F}g)(\boldsymbol{\xi}).
        \]
        \item If \(g(\mathbf{x}) = f(\mathbf{x}+\boldsymbol{\a})\) for any \(\boldsymbol{\a} \in \R^{n}\) then
        \[
          (\mc{F}g)(\boldsymbol{\xi}) = e^{2\pi i\<\boldsymbol{\a},\boldsymbol{\xi}\>}(\mc{F}f)(\boldsymbol{\xi}).
        \]
        \item If \(g(\mathbf{x}) = f(A\mathbf{x})\) for any \(A \in \GL_{n}(\R)\) then
        \[
          (\mc{F}g)(\boldsymbol{\xi}) = \frac{1}{|\det(A)|}(\mc{F}f)((A^{-1})^{t}\boldsymbol{\xi}).
        \]
      \end{enumerate}
    \end{proposition}
    \begin{proof}
      Property (i) is immediate from linearity of the integral while (ii) follows by applying the change of variables \(\mathbf{x} \mapsto \mathbf{x}-\boldsymbol{\a}\). Property (iii) is proved by performing the change of variables \(\mathbf{x} \mapsto A^{-1}\mathbf{x}\) which has Jacobian matrix \(A^{-1}\) and Jacobian determinant \(\frac{1}{|\det(A)|}\).
    \end{proof}
  \section{Fourier Series}
    The Fourier transform is intimately related to periodic functions. Let \(\L\) be a complete integral lattice in \(\R^{n}\) with fundamental domain \(\mc{M}\) and denote the dual lattice by \(\L^{\vee}\). Suppose \(f(\mathbf{x})\) is \(\L\)-periodic and integrable on \(\mc{M}\). Then we define the \(\l^{\vee}\)-th \textit{Fourier coefficient} \(\hat{f}(\l^{\vee})\) of \(f(\mathbf{x})\) by
    \[
      \hat{f}(\l^{\vee}) = \int_{\mc{M}}f(\mathbf{x})e^{-2\pi i\<\l^{\vee},\mathbf{x}\>}\,d\mathbf{x}.
    \]
    The \textit{Fourier series} \(S_{f}(x)\) is defined by
    \[
      S_{f}(\mathbf{x}) = \frac{1}{V_{\L}}\sum_{\l^{\vee} \in \L^{\vee}}\hat{f}(\l^{\vee})e^{2\pi i\<\l^{\vee},\mathbf{x}\>}.
    \]
    Notice that the Fourier coefficients are only defined for elements of the dual lattice and that the Fourier series is a sum over these elements. A crucial question is where the Fourier series of \(f(\mathbf{x})\) converges, if at all, and if so does it even converge to \(f(\mathbf{x})\) itself. Under quite reasonable conditions the Fourier series converges uniformly to the function itself, but we first make a reduction. Fix a basis \(\l_{1},\ldots,\l_{n}\) for \(\L\) and let \(P\) be the associated generator matrix. This means \(P\) is the base change matrix from the standard basis to \(\l_{1},\ldots,\l_{n}\) so that \(P\) is the unique invertible linear transformation on \(\R^{n}\) satisfying \(\L = P\Z^{n}\) and \(\L^{\vee} = (P^{-1})^{t}\Z^{n}\). Letting \( f_{P}(\mathbf{x}) = f(P\mathbf{x})\), we see that \(f_{P}(\mathbf{x})\) is \(1\)-periodic in each component and integrable on \([0,1]^{n}\). As \(\Z^{n}\) is self-dual and its covolume is \(1\), the \(\mathbf{n}\)-th Fourier coefficient \(\hat{f}_{P}(\mathbf{n})\) of \(f_{P}(\mathbf{x})\) is given by
    \[
      \hat{f}_{P}(\mathbf{n}) = \int_{[0,1]^{n}}f(\mathbf{x})e^{-2\pi i\<\mathbf{n},\mathbf{x}\>}\,d\mathbf{x}.
    \]
    and the Fourier series is
    \[
      S_{f_{P}}(\mathbf{x}) = \sum_{\mathbf{n} \in \Z^{n}}\hat{f}_{P}(\mathbf{n})e^{2\pi i\<\mathbf{n},\mathbf{x}\>}.
    \]
    As \(P\) is invertible, it suffices to study the convergence properties of this Fourier series. The reduction here this that we may assume our Fourier series are \(1\)-periodic in each component and in this case we have the following well-known result:

    \begin{theorem}
      Suppose \(f(\mathbf{x})\) is a smooth function on \(\R^{n}\) and is \(1\)-periodic in each component. Then the Fourier series of \(f(\mathbf{x})\) converges uniformly everywhere to \(f(\mathbf{x})\).
    \end{theorem}

    In the case of \(1\)-periodic functions of a single variable, we can do better as we may merely assume \(f(x)\) is of bounded variation. This is known as the \textit{Dirichlet-Jordan test}:

    \begin{theorem*}[Dirichlet-Jodan test]
      Suppose \(f(x)\) is a function on \(\R\) which is \(1\)-periodic and of bounded variation. Then the Fourier series of \(f(x)\) converges locally uniformly to \(f(x)\) on every set where \(f(x)\) is continuous. Moreover, at any jump discontinuity, the Fourier series of \(f(x)\) converges to the average of the left-hand and right-hand limits of \(f(x)\). In particular, this holds for all continuously differentiable functions with at most a finite number of jump discontinuities.
    \end{theorem*}
  \section{Poisson Summation}
    Returning to the general setting, there are two ways of building a function from \(f(\mathbf{x})\) that is \(\l\)-periodic. The first is to average \(f(\mathbf{x})\) over all translates by elements of \(\L\) while the second is to considering its Fourier series \(f(\mathbf{x})\). This gives us the two series
    \[
      \sum_{\l \in \L}f(\mathbf{x}+\l) \quad \text{or} \quad \frac{1}{V_{\L}}\sum_{\l^{\vee} \in \L^{\vee}}(\mc{F}f)(\l^{\vee})e^{2\pi i\<\l^{\vee},\mathbf{x}\>}.
    \]
    The link between the Fourier transform and Fourier series is given by the \textit{Poisson summation formula} which says that these two expressions are the same under some mild assumptions.

    \begin{theorem*}[Poisson summation formula]
      Suppose \(\L\) is a complete integral lattice in \(\R^{n}\), \(f(\mathbf{x})\) is absolutely integrable on \(\R^{n}\), and the function
      \[
        F(\mathbf{x}) = \sum_{\l \in \L}f(\mathbf{x}+\l),
      \]
      is smooth. Then
      \[
        \sum_{\l \in \L}f(\mathbf{x}+\l) = \frac{1}{V_{\L}}\sum_{\l^{\vee} \in \L^{\vee}}(\mc{F}f)(\l^{\vee})e^{2\pi i\<\l^{\vee},\mathbf{x}\>},
      \]
      and
      \[
        \sum_{\l \in \L}f(\l) = \frac{1}{V_{\L}}\sum_{\l^{\vee} \in \L^{\vee}}(\mc{F}f)(\l^{\vee}).
      \]
    \end{theorem*}
    \begin{proof}
      Fix a basis \(\l_{1},\ldots,\l_{n}\) for \(\L\) and let \(P\) be the associated generator matrix. Then \(\L = P\Z^{n}\) and \(\L^{\vee} = (P^{-1})^{t}\Z^{n}\). Letting \( F_{P}(\mathbf{x}) = F(P\mathbf{x})\), we may write
      \[
        F_{P}(\mathbf{x}) = \sum_{\mathbf{n} \in \Z^{n}}f(P\mathbf{x}+P\mathbf{n}).
      \]
      \(F_{P}(\mathbf{x})\) is smooth and \(1\)-periodic in each component because \(F(\mathbf{x})\) is smooth and invariant under translation by \(\L\). Whence \(F_{P}(\mathbf{x})\) admits a Fourier series converging uniformly everywhere to \(F_{P}(\mathbf{x})\). Moreover, \(F_{P}(\mathbf{x})\) is absolutely integrable on \([0,1]^{n}\). We will compute the \(\mathbf{t}\)-th Fourier coefficient of \(F_{P}(\mathbf{x})\) given by
      \[
        \hat{F}_{P}(\mathbf{t}) = \int_{[0,1]^{n}}F_{P}(\mathbf{x})e^{-2\pi i\<\mathbf{t},\mathbf{x}\>}\,d\mathbf{x} 
      \]
      The absolute integrability of \(f(\mathbf{x})\) permits the interchange of sum and integral to obtain
      \[
        \sum_{\mathbf{n} \in \Z^{n}}\int_{[0,1]^{n}}f(P\mathbf{x}+P\mathbf{n})e^{-2\pi i\<\mathbf{t},\mathbf{x}\>}\,d\mathbf{x}.
      \]
      The change of variables \(\mathbf{x} \mapsto P^{-1}\mathbf{x}\) gives
      \[
        \frac{1}{V_{\L}}\sum_{\mathbf{n} \in \Z^{n}}\int_{P[0,1]^{n}}f(\mathbf{x}+P\mathbf{n})e^{-2\pi i\<(P^{-1})^{t}\mathbf{t},\mathbf{x}\>},
      \]
      because the Jacobian matrix is \(P^{-1}\) with Jacobian determinant \(\frac{1}{V_{\L}}\). This expression is simply
      \[
        \frac{1}{V_{\L}}\int_{\R^{n}}f(\mathbf{x})e^{-2\pi i\left\<(P^{-1})^{t}\mathbf{t},\mathbf{x}\right\>}\,d\mathbf{x} = \frac{1}{V_{\L}}(\mc{F}f)\left((P^{-1})^{t}\mathbf{t}\right).
      \]
      Whence
      \[
        \sum_{\l \in \L}f(P\mathbf{x}+\l) = \frac{1}{V_{\L}}\sum_{\mathbf{t} \in \Z^{n}}(\mc{F}f)\left((P^{-1})^{t}\mathbf{t}\right)e^{2\pi i\<\mathbf{t},\mathbf{x}\>}.
      \]
      Changing variables \(\mathbf{x} \mapsto P^{-1}\mathbf{x}\) results in
      \[
        \sum_{\l \in \L}f(\mathbf{x}+\l) = \frac{1}{V_{\L}}\sum_{\l^{\vee} \in \L^{\vee}}(\mc{F}f)(\l^{\vee})e^{2\pi i\<\l^{\vee},\mathbf{x}\>}.
      \]
      This proves the first statement. Setting \(\mathbf{x} = \mathbf{0}\) proves the second statement.
    \end{proof}

    For convenience, we state the Poisson summation formula in the simplified case for the complete integral lattice \(\Z^{n}\) as a corollary since it is how the Poisson summation formula is usually applied.

    \begin{corollary}
      Suppose \(f(\mathbf{x})\) is absolutely integrable on \(\R^{n}\), and the function
      \[
        F(\mathbf{x}) = \sum_{\mathbf{n} \in \Z^{n}}f(\mathbf{x}+\mathbf{n}),
      \]
      is smooth. Then
      \[
        \sum_{\mathbf{n} \in \Z^{n}}f(\mathbf{x}+\mathbf{n}) = \sum_{\mathbf{t} \in \Z^{n}}(\mc{F}f)(\mathbf{t})e^{2\pi i\<\mathbf{t},\mathbf{x}\>},
      \]
      and
      \[
        \sum_{\mathbf{n} \in \Z^{n}}f(\mathbf{n}) = \sum_{\mathbf{t} \in \Z^{n}}(\mc{F}f)(\mathbf{t}).
      \]
    \end{corollary}
    \begin{proof}
      This is the Poisson summation formula for the complete integral lattice \(\Z^{n}\) since \(\Z^{n}\) is self-dual and \(V_{\Z^{n}} = 1\).
    \end{proof}

    Using the Dirichlet-Jordan test, we can prove a slightly stronger form of the Poisson summation formula in the single variable setting for the complete integral lattice \(\Z\).

    \begin{theorem}
      Suppose \(f(x)\) is absolutely integrable on \(\R\), and the function
      \[
        F(x) = \asum_{n \in \Z}f(x+n),
      \]
      satisfies the Dirichlet-Jordan test, where the \(\ast\) in the sum indicates that \(f(x+n)\) is meant to represent the average of the left-hand and right-hand limits at jump discontinuities. Then
      \[
        \asum_{n \in \Z}f(x+n) = \sum_{t \in \Z}(\mc{F}f)(t)e^{2\pi itx},
      \]
      and
      \[
        \asum_{n \in \Z}f(n) = \sum_{t \in \Z}(\mc{F}f)(t).
      \]
    \end{theorem}
    \begin{proof}
      Observe that \(F(x)\) is \(1\)-periodic. As \(F(x)\) satisfies the Dirichlet-Jordan test by assumption, it admits a Fourier series converging locally uniformly to \(F(x)\) wherever \(F(x)\) is continuous. In fact, by the construction of \(F(x)\) and that the Fourier series of \(F(x)\) converges to the average of the left-hand and right-hand limits at jump discontinuities, the Fourier series of \(F(x)\) converges locally uniformly to \(F(x)\) everywhere. Moreover, \(F(x)\) is absolutely integrable on \([0,1]\). We compute the \(t\)-th Fourier coefficient of \(F(x)\) given by
      \[
        \hat{F}(t) = \int_{0}^{1}F(x)e^{-2\pi itx}\,dx.
      \]
      The absolute integrability of \(f(x)\) permits the interchange of sum and integral to obtain
      \[
        \int_{-\infty}^{\infty}f(x)e^{-2\pi itx}\,dx = (\mc{F}f)(t).
      \]
      Whence
      \[
        \asum_{n \in \Z}f(x+n) = \sum_{t \in \Z}(\mc{F}f)(t)e^{2\pi itx}.
      \]
      This proves the first statement. Setting \(x = 0\) proves the second statement.
    \end{proof}

    In practical settings, we need a class of functions \(f(\mathbf{x})\) for which the assumptions of the Poisson summation formula hold. We say that \(f(\mathbf{x})\) is of \textit{Schwarz class} if \(f \in C^{\infty}(\R^{n})\) and \(f(\mathbf{x})\) along with all of its partial derivatives have rapid decay. If \(f(\mathbf{x})\) is of Schwarz class, the rapid decay implies that \(f(\mathbf{x})\) and all of its derivatives are absolutely integrable over \(\R^{n}\). Moreover, \(F(\mathbf{x}) = \sum_{\mathbf{n} \in \Z^{n}}f(\mathbf{x}+\mathbf{n})\) and all of its derivatives are locally absolutely uniformly convergent by the Weierstrass \(M\)-test. The uniform limit theorem then ensures \(F(\mathbf{x})\) is smooth and thus the conditions of the Poisson summation formula are satisfied. So in most practical applications only only needed to ensure that \(f(\mathbf{x})\) is Schwarz class.

    We now introduce some explicit Schwarz class functions and compute their Fourier transforms. The classic example is \(e^{-2\pi x^{2}}\). This function is particularly important because it is essentially its own Fourier transform.

    \begin{proposition}\label{prop:Fourier_transform_of_exponential_single_variable}
      Let \(\a > 0\) and set \(f(x) = e^{-2\pi\a x^{2}}\). Then
      \[
        (\mc{F}f)(\z) = \frac{e^{-\frac{\pi\z^{2}}{2\a}}}{\sqrt{2\a}}.
      \]
      In particular, \(e^{-\pi x^{2}}\) is its own Fourier transform.
    \end{proposition}
    \begin{proof}
      Consider
      \[
        (\mc{F}f)(\z) = \int_{-\infty}^{\infty}e^{-2\pi(\a x^{2}+i\z x)}\,dx.
      \]
      The change of variables \(x \mapsto \frac{x}{\sqrt{\a}}\) transforms this integral into
      \[
        \frac{1}{\sqrt{\a}}\int_{-\infty}^{\infty}e^{-2\pi\left(x^{2}+\frac{i\z x}{\sqrt{\a}}\right)}\,dx.
      \]
      Complete the square in the exponent by observing
      \[
        x^{2}+\frac{i\z x}{\sqrt{\a}} = \left(x+\frac{i\z}{2\sqrt{\a}}\right)^{2}+\frac{\z^{2}}{4\a},
      \]
      so that the previous integral is equal to
      \[
        \frac{e^{-\frac{\pi\z^{2}}{2\a}}}{\sqrt{\a}}\int_{-\infty}^{\infty}e^{-2\pi\left(x+\frac{i\z}{2\sqrt{\a}}\right)^{2}}\,dx.
      \]
      By rapid decay of the integrand, the change of variables \(x \mapsto \frac{x}{\sqrt{2}}-\frac{i\z}{\sqrt{\a}}\) is permitted giving
      \[
        \frac{e^{-\frac{\pi\z^{2}}{2\a}}}{\sqrt{2\a}}\int_{-\infty}^{\infty}e^{-\pi x^{2}}\,dx = \frac{e^{-\frac{\pi\z^{2}}{2\a}}}{\sqrt{2\a}},
      \]
      because the remaining integral is the Gaussian integral. This proves the first statement. The second statement follows by taking \(\a = \frac{1}{2}\).
    \end{proof}

    The analog of \(e^{-2\pi x^{2}}\) on \(\R^{n}\) is \(e^{-2\pi\<\mathbf{x},\mathbf{x}\>}\) which is Schwarz class because \(e^{-2\pi x^{2}}\) is. We also obtain a generalization of the previous result this Schwarz class function as a corollary.

    \begin{corollary}
      Let \(\a > 0\) and set \(f(\mathbf{x}) = e^{-2\pi\a\<\mathbf{x},\mathbf{x}\>}\). Then
      \[
        (\mc{F}f)(\boldsymbol{\xi}) = \frac{e^{-\frac{\pi\<\boldsymbol{\xi},\boldsymbol{\xi}\>}{2\a}}}{(2\a)^{\frac{n}{2}}}.
      \]
      In particular, \(e^{-\pi\<\mathbf{x},\mathbf{x}\>}\) is its own Fourier transform.
    \end{corollary}
    \begin{proof}
      Applying \cref{prop:Fourier_transform_of_exponential_single_variable} to each variable separately proves the first statement. The second statement follows upon setting \(\a = \frac{1}{2}\).
    \end{proof}
    
\end{document}