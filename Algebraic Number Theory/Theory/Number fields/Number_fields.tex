\documentclass[12pt]{article}
\usepackage{import}
\input{/Users/henrytwiss/Documents/Documents/LaTeX/Vignettes/preamble.tex}

%=================%
%  Title & Index  %
%=================%
\title{Number fields}
\author{Henry Twiss}
\makeindex

\begin{document}
  \date{}
  \maketitle
  \section{Integrality}
    Let \(B/A\) be an extension of rings. We say that \(b \in B\) is \textbf{integral}\index{integral} over \(A\) if \(\b\) is the root of a monic polynomial \(f(x) \in A[x]\). In other words, \(\b\) satisfies
    \[
      \b^{n}+\a_{n-1}\b^{n-1}+\cdots+\a_{0} = 0,
    \]
    for some \(n \ge 1\) and \(\a_{i} \in A\) for \(0 \le i \le n-1\). We say that \(B\) is \textbf{integral}\index{integral} over \(A\) if every element of \(B\) is integral over \(A\). The following proposition shows that integral elements form a ring:

    \begin{proposition}\label{prop:integral_if_finitely_generated}
      Let \(B/A\) be an extension of rings. Then the finitely many elements \(\b_{1},\ldots,\b_{n} \in B\) are all integral over \(A\) if and only if \(A[\b_{1},\ldots,\b_{n}]\) is a finitely generated \(A\)-module. In particular, the elements of \(B\) that are integral over \(A\) form a ring.
    \end{proposition}
    \begin{proof}
      First suppose \(\b \in B\) is integral over \(A\). Then there exists a monic polynomial \(f(x) \in A[x]\), of say degree \(n \ge 1\), such that \(f(\b) = 0\). Now for any \(g(x) \in A[x]\), Euclidean division implies
      \[
        g(x) = q(x)f(x)+r(x),
      \]
      with \(q(x),r(x) \in A[x]\) and \(\deg(r(x)) < n\). Letting
      \[
        r(x) = \a_{n-1}x^{n-1}+\cdots+\a_{1}x+a_{0},
      \]
      with \(\a_{i} \in \Z\) for \(0 \le i \le n-1\), it follows that
      \[
        g(\b) = r(\b) = \a_{n-1}\b^{n-1}+\cdots+\a_{1}\b+\a_{0}.
      \]
      As \(g(x)\) was arbitrary, we see that \(1,\b,\ldots,\b^{n-1}\) generates \(A[\b]\) as an \(A\)-module. Now suppose \(\b_{1},\ldots,\b_{n} \in B\) are all integral over \(A\). We will prove that \(A[\b_{1},\ldots,\b_{n}]\) is finitely generated as an \(A\)-module by induction. Our previous work implies the base case. So assume by induction that \(R = A[\b_{1},\ldots,\b_{n-1}]\) is a finitely generated \(A\)-module. Then \(R[\b_{n}] = A[\b_{1},\ldots,\b_{n}]\) is a finitely generated \(R\)-module and hence a finitely generated \(\Z\)-module as well by our induction hypothesis. This proves the forward implication of the first statement. For the reverse implication, suppose \(A[\b_{1},\ldots,\b_{n}]\) is a finitely generated \(A\)-module. Let \(\w_{1},\ldots,\w_{r}\) be a basis of \(A[\b_{1},\ldots,\b_{n}]\). Then for any \(\b \in A[\b_{1},\ldots,\b_{n}]\), we have
      \[
        \b\w_{i} = \sum_{1 \le j \le r}\a_{i,j}\w_{j},
      \]
      with \(\a_{i,j} \in A\) for \(1 \le i,j \le r\). We can rewrite this as
      \[
        (\b-\a_{i,i})\w_{i}-\sum_{\substack{1 \le j \le r \\ j \neq i}}\a_{i,j}\w_{j} = 0,
      \]
      for all \(i\). These \(r\) equations are equivalent to the identity
      \[
        \begin{pmatrix} \b-\a_{1,1} & \a_{1,2} & \cdots & -\a_{1,r} \\ -\a_{2,1} & \b-\a_{2,2} & & \\ \vdots & & \ddots & \\ -\a_{r,1} & & & \b-\a_{r,r} \end{pmatrix}\begin{pmatrix} \w_{1} \\ \w_{2} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
      \]
      Thus the determinant of the matrix on the left-hand side must be zero. This shows that \(\b\) is the root of the characteristic polynomial \(\det(xI-(\a_{i,j})_{i,j})\) which is a monic polynomial with coefficients in \(A\). Hence \(\b\) is integral over \(A\). As \(\b\) was arbitrary, this shows that the elements \(\b_{1},\ldots,\b_{n}\) are all integral over \(A\) and that the sum and product of elements that are integral over \(A\) are also integral over \(A\). This proves the reverse implication and the second statement completing the proof.
    \end{proof}

    Integrality is also transitive via the following statement:

    \begin{proposition}\label{prop:integrality_is_transitive}
      Let \(C/B/A\) be an extension of rings. If \(C\) is integral over \(B\) and \(B\) is integral over \(A\) then \(C\) is integral over \(A\).
    \end{proposition}
    \begin{proof}
      Let \(\g \in C\). Since \(C\) is integral over \(B\), we have
      \[
        \g^{n}+\b_{n-1}\g^{n-1}+\cdots+\b_{0} = 0,
      \]
      for some \(n \ge 1\) and \(\b_{i} \in B\) for \(0 \le i \le n-1\). Set \(R = A[\b_{0},\ldots,\b_{n-1}]\). Then \(R[\g]\) is a finitely generated \(R\)-module and since \(B\) is integral over \(A\), \cref{prop:integral_if_finitely_generated} implies that \(R[\g]\) is also a finitely generated \(A\)-module. Thus \(\g\) is integral over \(A\) by \cref{prop:integral_if_finitely_generated} again. As \(\g\) was arbitrary, \(C\) is integral over \(A\).
    \end{proof}

    In light of \cref{prop:integrality_is_transitive}, we define the \textbf{integral closure}\index{integral closure} \(\overline{A}\) of \(A\) in \(B\) by
    \[
      \overline{A} = \{\b \in B:\b \text{ is integral over } A\}.
    \]
    Clearly \(A \subseteq \overline{A}\). Moreover, we say that \(A\) is \textbf{integrally closed}\index{integrally closed} in \(B\) if \(A = \overline{A}\). As \(A \subseteq \overline{A} \subseteq \overline{\overline{A}}\), \cref{prop:integrality_is_transitive} implies that \(\overline{A}\) is automatically integrally closed in \(B\). Now suppose \(A\) is an integral domain with field of fractions \(K\). Then we call the integral closure \(\overline{A}\) of \(A\) in \(K\) the \textbf{normalization}\index{normalization} of \(A\) and simply say that \(A\) is \textbf{integrally closed}\index{integrally closed} if \(A\) is equal to its normalization. It turns out that every unique factorization domain is integrally closed:

    \begin{lemma}\label{lemma:unique_factorization_domains_are_integrally_closed}
      Let \(A\) be a unique factorization domain with field of fractions \(K\). Then \(A\) is integrally closed. In particular, every principal ideal domain is integrally closed.
    \end{lemma}
    \begin{proof}
      Since every principal ideal domain is a unique factorization domain, the second statement follows immediately from the first. To prove the first statement, let \(\k \in K\) be such that
      \[
        \k^{n}+\a_{n-1}\k^{n-1}+\cdots+\a_{0} = 0,
      \]
      for some \(n \ge 1\) and \(\a_{i} \in A\) for \(0 \le i \le n-1\). Since \(A\) is a unique factorization domain, we may write \(\k = \frac{\a}{\b}\) for \(\a,\b \in A\) with \(\b\) nonzero and \((\a,\b) = 1\). Multiplying by \(\b^{n}\) and isolating the leading term shows that
      \[
        \a^{n} = -(\a_{n-1}\b\a^{n-1}+\cdots+\a_{0}\b^{n}).
      \] 
      As \(\b\) divides the right-hand side it divides the left-hand side as well. But then \(\b \mid \a\) and hence \(\b\) is a unit in \(A\) because \((\a,\b) = 1\). This means \(\k \in A\) and so \(A\) is integrally closed.
    \end{proof}
    
    Despite \cref{lemma:unique_factorization_domains_are_integrally_closed}, we will often consider the following more general setting: \(A\) is an integrally closed integral domain with field of fractions \(K\), \(L/K\) is a finite separable extension, and \(B\) is the integral closure of \(A\) in \(L\). In this setting, the field of fractions of \(B\) has a simple description:

    \begin{proposition}\label{prop:field_of_fractions_AKBL}
      Let \(A\) be an integrally closed integral domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(B\) be the integral closure of \(A\) in \(L\). Then every \(\l \in L\) is of the form
      \[
        \l = \frac{\b}{\a},
      \]
      for some \(\b \in B\) and nonzero \(\a \in A\). In particular, \(L\) is the field of fractions of \(B\). Moreover, \(\l \in L\) is integral over \(A\) if and only if the minimal polynomial \(m_{\l}(x)\) of \(\l\) over \(K\) has coefficients in \(A\).
    \end{proposition}
    \begin{proof}
      As \(L/K\) is finite, it is necessarily algebraic so that any \(\l \in L\) satisfies
      \[
        \a\l^{n}+\a_{n-1}\l^{n-1}+\cdots+\a_{0} = 0,
      \]
      with \(\a_{i} \in A\) for \(0 \le i \le n-1\) and nonzero \(\a \in A\). We claim that \(\a\l\) is integral over \(A\). Indeed, multiplying the previous identity by \(\a^{n-1}\) yields
      \[
        (\a\l)^{n}+\a'_{n-1}(\a\l)^{n-1}+\cdots+\a'_{0} = 0,
      \]
      where \(\a'_{i} = \a_{i}\a^{n-1-i}\) for \(0 \le i \le n-1\), and so \(\a\l\) is the root of a monic polynomial with coefficients in \(A\). Then \(\a\l \in B\) and so \(\a\l = \b\) for some \(\b \in B\) which is equivalent to \(\l = \frac{\b}{\a}\). As \(A \subseteq B\), this also implies that \(L\) is the field of fractions of \(B\). For the last statement, suppose \(\l \in L\). If the minimal polynomial \(m_{\l}(x)\) of \(\l\) over \(K\) has coefficients in \(A\) then \(\l\) is automatically integral over \(A\) (since minimal polynomials are monic). So suppose \(\l\) is an integral over \(A\) so that \(\l\) is a root of a monic polynomial \(f(x) \in A[x]\). Then \(m_{\l}(x)\) divides \(f(x)\) in \(A[x]\) and thus all of the roots of \(m_{\l}(x)\) are integral over \(A\) too. By Vieta's formulas, the coefficients of \(m_{\k}(x)\) integral over \(A\) as well. But then \(m_{\k}(x) \in A[x]\). This completes the proof.
    \end{proof}

    We are now ready to introduce number fields. A \textbf{number field}\index{number field} \(K\) is a finite extension of \(\Q\). That is, \(K\) is a finite dimensional \(\Q\)-vector space. In particular, \(K/\Q\) is a finite separable extension since \(\Q\) is perfect so that the primitive element theorem applies. Moreover, \(K/\Q\) is Galois if and only if it is normal. We say that the \textbf{degree}\index{degree} of \(K\) is \([K:\Q]\) which is simply the degree of \(K\) as a \(\Q\)-vector space. If \(K\) is of degree \(2\), \(3\), etc.\ then we say it is \textbf{quadratic}\index{quadratic}, \textbf{cubic}\index{cubic}, etc. Any \(\k \in K\) is called an \textbf{algebraic number}\index{algebraic number}. We define the \textbf{ring of integers}\index{ring of integers} \(\mc{O}_{K}\) of \(K\) to be the integral closure of \(\Z\) in \(K\). In other words,
    \[
      \mc{O}_{K} = \{\k \in K:\k \text{ is integral over } \Z\}.
    \]
    Any \(\a \in \mc{O}_{K}\) is called an \textbf{algebraic integer}\index{algebraic integer}. Then \(\a\) is an algebraic integer if and only if it is the root of a monic polynomial \(f(x) \in \Z[x]\).

    \begin{remark}\label{rem:integers_are_integrally_closed}
      By \cref{lemma:unique_factorization_domains_are_integrally_closed}, \(\Z\) is integrally closed and therefore the ring of integers for the number field \(\Q\) is exactly \(\Z\).
    \end{remark}

    Let \(K\) be a number field of degree \(n\). It follows from \cref{prop:field_of_fractions_AKBL} that \(K\) is the field of fractions of \(\mc{O}_{K}\) and every \(\k \in K\) is of the form
    \[
      \k = \frac{\a}{a},
    \]
    for some \(\a \in \mc{O}_{K}\) and nonzero \(a \in \Z\). Moreover, \(\k \in K\) is an algebraic integers if and only if the minimal polynomial \(m_{\k}(x)\) of \(\k\) over \(\Q\) has coefficients in \(\Z\).
  \section{Traces and Norms}
    We will now introduce norms and traces of free modules. Let \(B/A\) be an extension of rings such that \(B\) is a free \(A\)-module of rank \(n\). Then the \textbf{trace}\index{trace} and \textbf{norm}\index{norm} of \(B\) over \(A\), denoted \(\Trace_{B/A}\) and \(\Norm_{B/A}\) respectively, are defined by
    \[
      \Trace_{B/A}(\b) = \tr(T_{\b}) \quad \text{and} \quad \Norm_{B/A}(\b) = \det(T_{\b}),
    \]
    for any \(\b \in B\), where \(T_{\b}:B \to B\) is the linear operator defined by
    \[
      T_{\b}(x) = \b x,
    \]
    for all \(x \in B\). That is, \(T_{\b}\) is the multiplication by \(\b\) map. Letting \(f_{\b}(x)\) denote the characteristic polynomial of \(T_{\b}\), we have
    \[
      f_{\b}(x) = \det(xI-T_{\b}) = x^{n}-\a_{n-1}x^{n-1}+\cdots+(-1)^{n}\a_{0},
    \]
    with \(\a_{i} \in A\) for \(0 \le i \le n-1\). Then the trace and the norm are given by
    \begin{equation}\label{equ:trace_and_norm_characteristic_polynomial}
      \Trace_{B/A}(\b) = \a_{n-1} \quad \text{and} \quad \Norm_{B/A}(\b) = \a_{0},
    \end{equation}
    and therefore take values in \(A\). Moreover, we have
    \[
      \Trace_{B/A}(\a\b) = \a\Trace_{B/A}(\b) \quad \text{and} \quad \Norm_{B/A}(\a\b) = \a^{n}\Norm_{B/A}(\b),
    \]
    for all \(\a \in A\) because \(T_{\a\l} = \a T_{\l}\). Also note that \(T_{\b+\g} = T_{\b}+T_{\g}\) and \(T_{\b\g} = T_{\b}T_{\g}\) for all \(\b,\g \in B\). Moreover, recall that the trace and determinant of a linear map are additive and multiplicative respectively with respect to direct sums (since any matrix representation of the linear map becomes block upper triangular). Then if \(B = B_{1} \op B_{2}\) and \(\b = \b_{1}+\b_{2}\) with \(\b_{1} \in B_{1}\) and \(\b_{2} \in B_{2}\), we have
    \begin{equation}\label{equ:trace_and_norm_direct_sums}
      \Trace_{B/A}(\b) = \Trace_{B_{1}/A}(\b_{1})+\Trace_{B_{2}/A}(\b_{2}) \quad \text{and} \quad \Norm_{B/A}(\b) = \Norm_{B_{1}/A}(\b_{1})\Norm_{B_{2}/A}(\b_{2}).
    \end{equation}
    In the case of a degree \(n\) extension \(L/K\), we call \(\Trace_{L/K}\) and \(\Norm_{L/K}\) the \textbf{trace}\index{trace} and \textbf{norm}\index{norm} of \(L/K\). Moreover, \(\Norm_{L/K}(\l) = 0\) if and only if \(\l = 0\) because otherwise \(T_{\l}\) has inverse \(T_{\l^{-1}}\) and hence nonzero determinant. Therefore we obtain homomorphisms
    \[
      \Trace_{L/K}:L \to K \quad \text{and} \quad \Norm_{L/K}:L^{\ast} \to K^{\ast}.
    \]
    When \(L/K\) is also separable, we can derive alternative descriptions of the trace and norm of \(L/K\). This additional assumption is weak because we are mostly interested in finite extensions of \(\Q\) and \(\F_{p}\) which are always separable (because both \(\Q\) and \(\F_{p}\) are perfect). In any case, to do this we need to work in the algebraic closure \(\conj{K}\) of \(K\). As \(L/K\) is a degree \(n\) separable extension, there are exactly \(n\) distinct \(K\)-embeddings \(\s_{1},\ldots,\s_{n}\) of \(L\) into \(\conj{K}\) (each given by letting \(\t\) be a primitive element for \(L/K\) so that \(L = K(\t)\) and sending \(\t\) to one of its conjugate roots in the minimal polynomial \(m_{\t}(x)\) of \(\t\) over \(K\)). In other words, there are \(n\) elements of \(\Hom_{K}(L,\conj{K})\). Moreover, we prove the following proposition:

    \begin{proposition}\label{prop:formulas_for_trace_and_norm}
      Let \(L/K\) be a degree \(n\) separable extension and let \(\s\) run over the elements of \(\Hom_{K}(L,\conj{K})\). For any \(\l \in L\), the characteristic polynomial \(f_{\l}(x)\) of \(T_{\l}\) over \(K\) is a power of the minimal polynomial \(m_{\l}(x)\) of \(\l\) over \(K\) and satisfies
      \[
        f_{\l}(x) = \prod_{\s}(x-\s(\l)).
      \]
      We also have
      \[
        \Trace_{L/K}(\l) = \sum_{\s}\s(\l) \quad \text{and} \quad \Norm_{L/K}(\l) = \prod_{\s}\s(\l).
      \]
      Moreover, if \(L/K\) is Galois and \(\l_{1},\ldots,\l_{n}\) are the conjugates of \(\l\) then
      \[
        \Trace_{L/K}(\l) = \sum_{1 \le i \le n}\l_{i} \quad \text{and} \quad \Norm_{L/K}(\l) = \prod_{1 \le i \le n}\l_{i}.
      \]
    \end{proposition}
    \begin{proof}
      Write
      \[
        m_{\l}(x) = x^{m}+\k_{m-1}x^{m-1}+\cdots+\k_{0},
      \]
      with \(\k_{i} \in K\) for \(0 \le i \le m-1\) (necessarily \(m\) is the degree of \(K(\l)/K\)) and let \(d\) be the degree of \(L/K(\l)\). We first show that \(f_{\l}(x)\) is a power of \(m_{\l}(x)\). In particular, we claim
      \[
        f_{\l}(x) = m_{\l}(x)^{d}.
      \]
      To see this, recall that \(1,\l,\ldots,\l^{n-1}\) is a basis of \(K(\l)/K\). If \(\a_{1},\ldots,\a_{d}\) is a basis for \(L/K(\l)\) then
      \[
        \a_{1},\a_{1}\l,\ldots,\a_{1}\l^{m-1},\ldots,\a_{d},\a_{d}\l,\ldots,\a_{d}\l^{m-1},
      \]
      is a basis for \(L/K\). Because \(m_{\l}(x)\) gives the linear relation
      \[
        \l^{m} = -\k_{0}-k_{1}\l-\cdots-\k_{m-1}\l^{m-1},
      \]
      the matrix of \(T_{\l}\) is block diagonal with \(d\) blocks each of the form
      \[
        \begin{pmatrix} & 1 & & \\ & & \ddots & \\ & & & 1 \\ -\k_{0} & -\k_{1} & \cdots & -\k_{m-1} \\ \end{pmatrix}.
      \]
      This is the companion matrix to \(m_{\l}(x)\) and hence the characteristic polynomial is \(m_{\l}(x)\) as well. Our claim follows since the matrix of \(T_{\l}\) is block diagonal. Since \(\l\) is algebraic over \(K\) of degree \(m\), \(K(\l)\) is the splitting field of \(m_{\l}(x)\) and there are \(m\) elements of \(\Hom_{K}(K(\l),\conj{K})\). Then the elements of \(\Hom_{K}(L,\conj{K})\) are partitioned into \(m\) many equivalence classes each of size \(d\) (because \(L/K(\l)\) is degree \(d\)) where \(\s\) and \(\s'\) are in the same class if and only if \(\s(\l) = \s'(\l)\). In particular, a complete set of representatives is given by the \(\tau\). But then
      \[
        f_{\l}(x) = m_{\l}(x)^{d} = \left(\prod_{\tau}(x-\tau(\l))\right)^{d} = \prod_{\s}(x-\s(\l)),
      \]
      which proves the first statement. The formulas for the trace and norm follow from Vieta's formulas and \cref{equ:trace_and_norm_characteristic_polynomial} which proves the second statement. Now suppose \(L/K\) is Galois. Then \(\Gal(L/K) = \Hom_{K}(L,\conj{K})\). Therefore the conjugates of \(\l\) are exactly the images of \(\l\) under these \(K\)-embeddings and the last claim follows.
    \end{proof}

    As an application of \cref{prop:formulas_for_trace_and_norm}, we can show how the field trace and field norm act when \(A\) is an integrally closed integral domain with field of fractions \(K\), \(L/K\) is a finite separable extension, and \(B\) is the integral closure of \(A\) in \(L\):

    \begin{proposition}\label{prop:trace_and_norm_AKBL}
      Let \(A\) be an integrally closed integral domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(B\) be the integral closure of \(A\) in \(L\). If \(\b \in B\) then the trace and norm of \(\b\) are in \(A\).
    \end{proposition}
    \begin{proof}
      By \cref{prop:field_of_fractions_AKBL}, the minimal polynomial \(m_{\b}(x)\) of \(\b\) over \(K\) has coefficients in \(A\). By \cref{prop:formulas_for_trace_and_norm}, the characteristic polynomial \(f_{\b}(x)\) is a power of \(m_{\b}(x)\) and hence \(f_{\b}(x)\) has coefficients in \(A\) too. From \cref{equ:trace_and_norm_characteristic_polynomial} we conclude that the trace and norm of \(\b\) are in \(A\).
    \end{proof}

    We can also classify the units of \(B\) in terms of the units of \(A\):

    \begin{proposition}\label{prop:unit_if_and_only_if_AKBL}
      Let \(A\) be an integrally closed integral domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(B\) be the integral closure of \(A\) in \(L\). Then \(\b \in B\) is a unit if and only if \(\Norm_{L/K}(\b) \in A\) is a unit
    \end{proposition}
    \begin{proof}
      First suppose \(\b \in B\) is a unit. Then \(\frac{1}{\b} \in B\) and so
      \[
        \Norm_{L/K}(\b)\Norm_{L/K}\left(\frac{1}{\b}\right) = \Norm_{L/K}(1) = 1.
      \]
      By \cref{prop:trace_and_norm_AKBL}, \(\Norm_{L/K}(\b),\Norm_{L/K}\left(\frac{1}{\b}\right) \in A\) and hence \(\Norm_{L/K}(\b)\) is a unit. Now suppose \(\Norm_{L/K}(\b) \in A\) is a unit. By \cref{prop:field_of_fractions_AKBL}, the minimal polynomial \(m_{\b}(x)\) of \(\b\) over \(K\) has coefficients in \(A\). Moreover, \cref{equ:trace_and_norm_characteristic_polynomial,prop:formulas_for_trace_and_norm} together imply that the constant term is a unit because \(\Norm_{L/K}(\b)\) is. Letting the degree of \(m_{\b}(x)\) be \(m\), we have shown that
      \[
        m_{\b}(x) = x^{m}+\a_{m-1}x^{m-1}+\cdots+\a,
      \]
      with \(\a_{i} \in A\) for \(1 \le i \le m-1\) and \(\a \in A\) a unit. Dividing \(m_{\b}(\b)\) by \(\b^{m}\), we find that \(\frac{1}{\b}\) is a root of the polynomial
      \[
        f(x) = \a x^{m}+\a_{1}x^{m-1}+\cdots+1.
      \]
      Multiplying by \(\frac{1}{\a}\), it follows that \(\frac{1}{\b}\) is a root of a monic polynomial with coefficients in \(A\). Hence \(\frac{1}{\b} \in B\) and thus \(\b\) is a unit.
    \end{proof}

    Having introduced traces and norms, we discuss discriminants of free modules. Let \(B/A\) be an extension of rings such that \(B\) is a free \(A\)-module of rank \(n\). If \(\b_{1},\ldots,\b_{n}\) is a basis for \(B\), we define its \textbf{trace matrix}\index{trace matrix} \(\Trace_{B/A}(\b_{1},\ldots,\b_{n})\) by
    \[
      \Trace_{B/A}(\b_{1},\ldots,\b_{n}) = \begin{pmatrix} \Trace_{B/A}(\b_{1}\b_{1}) & \cdots & \Trace_{B/A}(\b_{1}\b_{n}) \\ \vdots & & \vdots \\ \Trace_{B/A}(\b_{n}\b_{1}) & \cdots & \Trace_{B/A}(\b_{n}\b_{n}) \end{pmatrix}.
    \]
    The trace matrix will play a prominent role in the theory. Most importantly is the \textbf{discriminant}\index{discriminant} \(d_{B/A}(\b_{1},\ldots,\b_{n})\) of \(\b_{1},\ldots,\b_{n}\) defined by
    \[
      d_{B/A}(\b_{1},\ldots,\b_{n}) = \det(\Trace_{B/A}(\b_{1},\ldots,\b_{n})).
    \]
    Equivalently, the discriminant is the determinant of the trace matrix. In particular, the discriminant \(d_{B/A}(\b_{1},\ldots,\b_{n})\) is an element of \(A\). It is also independent of the choice of basis up to elements of \((A^{\ast})^{2}\). For if \(\b_{1}',\ldots,\b_{n}'\) is another basis, we have
    \[
      \b_{i}' = \sum_{1 \le j \le m}\a_{i,j}\b_{j},
    \]
    with \(\a_{i,j} \in A\) for \(1 \le i,j \le n\). Then \((\a_{i,j})_{i,j}\) is the base change matrix from \(\b_{1},\ldots,\b_{n}\) to \(\b_{1}',\ldots,\b_{n}'\) and so has nonzero determinant. Thus \(\det((\a_{i,j})_{i,j}) \in A^{\ast}\). Moreover,
    \[
      \Trace_{B/A}(\b_{1}',\ldots,\b_{n}') = (\a_{i,j})_{i,j}\Trace_{B/A}(\b_{1},\ldots,\b_{n})(\a_{i,j})_{i,j}^{t},
    \]
    which, upon taking the determinant, shows that
    \begin{equation}\label{equ:discriminant_base_change}
      d_{B/A}(\b_{1}',\ldots,\b_{n}') = \det((\a_{i,j})_{i,j})^{2}d_{B/A}(\b_{1},\ldots,\b_{n}),
    \end{equation}
    as claimed. Accordingly, we define the \textbf{discriminant}\index{discriminant} \(d_{A}(B)\) of \(B/A\) to be the coset in \(A/(A^{\ast})^{2}\) represented by any discriminant \(d_{B/A}(\b_{1},\ldots,\b_{n})\). In other words,
    \[
      d_{A}(B) = d_{B/A}(\b_{1},\ldots,\b_{n})(A^{\ast})^{2}.
    \]
    This is well-defined by \cref{equ:discriminant_base_change}. In particular, \(d_{A}(B) = 0\) is independent of the choice of representative. The discriminant is also multiplicative with respect to direct sums:

    \begin{proposition}\label{prop:discriminant_and_direct_sums}
      Let \(B/A\) be an extension of rings such that \(B\) is a free \(A\)-module of rank \(n\). Suppose we have a direct sum decomposition
      \[
        B = B_{1} \op B_{2},
      \]
      for free \(A\)-modules \(B_{1}\) and \(B_{2}\) of ranks \(n_{1}\) and \(n_{2}\) respectively. Also let \(\b_{1,1},\ldots,\b_{n_{1},1}\) and \(\b_{1,2},\ldots,\b_{n_{2},2}\) be bases of \(B_{1}\) and \(B_{2}\) respectively. Then \(\b_{1,1},\ldots,\b_{n_{1},1},\b_{1,2},\ldots,\b_{n_{2},2}\) is a basis of \(B\) with
      \[
        d_{B/A}(\b_{1,1},\ldots,\b_{n_{1},1},\b_{1,2},\ldots,\b_{n_{2},2}) = d_{B_{1}/A}(\b_{1,1},\ldots,\b_{n_{1},1})d_{B_{2}/A}(\b_{1,2},\ldots,\b_{n_{2},2}).
      \]
    \end{proposition}
    \begin{proof}
      Clearly \(\b_{1,1},\ldots,\b_{n_{1},1},\b_{1,2},\ldots,\b_{n_{2},2}\) is a basis for \(B\). We also have \(\b_{i,1}\b_{j,2} = 0\) for all \(1 \le i \le n_{1}\) and \(1 \le j \le n_{2}\). It follows that \(d_{B/A}(\b_{1,1},\ldots,\b_{n_{1},1},\b_{1,2},\ldots,\b_{n_{2},2})\) is the determinant of the block diagonal matrix
      \[
        \begin{pmatrix} \Trace_{B/A}(\b_{1,1},\ldots,\b_{n_{1},1}) & \\ & \Trace_{B/A}(\b_{1,2},\ldots,\b_{n_{2},2}) \end{pmatrix}.
      \]
      Moreover, \cref{equ:trace_and_norm_direct_sums} implies
      \[
        \Trace_{B/A}(\b_{1}) = \Trace_{B_{1}/A}(\b_{1}) \quad \text{and} \quad \Trace_{B/A}(\b_{2}) = \Trace_{B_{2}/A}(\b_{2})
      \]
      for any \(\b_{1} \in B_{1}\) and \(\b_{2} \in B_{2}\) since multiplication by \(\b_{1}\) and \(\b_{2}\) annihilate \(B_{2}\) and \(B_{1}\) respectively. But then the block diagonal matrix above is equal to
      \[
        \begin{pmatrix} \Trace_{B_{1}/A}(\b_{1,1},\ldots,\b_{n_{1},1}) & \\ & \Trace_{B_{2}/A}(\b_{1,2},\ldots,\b_{n_{2},2}) \end{pmatrix}.
      \]
      The determinant of this matrix is \(d_{B_{1}/A}(\b_{1,1},\ldots,\b_{n_{1},1})d_{B_{2}/A}(\b_{1,2},\ldots,\b_{n_{2},2})\) which completes the proof.
    \end{proof}
    
    We now specialize to the setting of a degree \(n\) separable extension \(L/K\). In this case, it turns out that the discriminant of a basis is nonzero. To see this, we require a lemma:

    \begin{lemma}\label{lem:trace_is_nondegenerate}
      Let \(L/K\) be a finite separable extension. Then the map
      \[
        \Trace_{L/K}:L \x L \to K \qquad (\l,\eta) \mapsto \Trace_{L/K}(\l\eta),
      \]
      is a nondegenerate symmetric bilinear form.
    \end{lemma}
    \begin{proof}
      From the definition of the trace, it is clear that the map is a symmetric bilinear form. To see that is is nondegenerate, suppose \(L/K\) is degree \(n\). Then for any nonzero \(\l \in L\), \cref{prop:formulas_for_trace_and_norm} implies that
      \[
        \Trace_{L/K}(\l\l^{-1}) = \Trace_{L/K}(1) = n.
      \]
      Hence the symmetric bilinear form is nondegenerate.
    \end{proof}

    We can now show that the discriminant of any basis for \(L/K\) never vanishes:

    \begin{proposition}\label{prop:discriminant_not_zero}
      Let \(L/K\) be a degree \(n\) separable extension and let \(\l_{1},\ldots,\l_{n}\) be a basis for \(L/K\). Then \(d_{L/K}(\l_{1},\ldots,\l_{n}) \neq 0\).
    \end{proposition}
    \begin{proof}
      Suppose by contradiction that \(d_{L/K}(\l_{1},\ldots,\l_{n}) = 0\). Then the matrix \(\Trace_{L/K}(\l_{1},\ldots,\l_{n})\) is not invertible. Hence there exists \(\k_{i} \in K\) for \(1 \le i \le n\) such that
      \[
        \Trace_{L/K}(\l_{1},\ldots,\l_{n})\begin{pmatrix} \k_{1} \\ \vdots \\ \k_{n} \end{pmatrix} = \mathbf{0}.
      \]
      This is equivalent to the \(n\) equations
      \[
        \sum_{1 \le j \le n}\k_{j}\Trace_{L/K}(\l_{i}\l_{j}) = 0,
      \]
      for all \(i\). Setting
      \[
        \l = \sum_{1 \le j \le n}\k_{j}\l_{j},
      \]
      linearity of the trace implies that these \(n\) equations are equivalent to the fact that \(\Trace_{L/K}(\l\l_{i}) = 0\) for all \(i\). As \(\l_{1},\ldots,\l_{n}\) is a basis for \(L/K\), it follows that \(\l \in L\) is a nonzero element for which \(\Trace_{L/K}(\l\eta) = 0\) for all \(\eta \in L\). This is impossible by \cref{lem:trace_is_nondegenerate}. Hence \(d_{L/K}(\l_{1},\ldots,\l_{n}) \neq 0\) as desired.
    \end{proof}

    In addition to the discriminant \(d_{L/K}(\l_{1},\ldots,\l_{n})\) never vanishing, we can also write it in an alternative form. To do this, we define the \textbf{embedding matrix}\index{embedding matrix} \(M(\l_{1},\ldots,\l_{n})\) of the basis \(\l_{1},\ldots,\l_{n}\) by
    \[
      M(\l_{1},\ldots,\l_{n}) = \begin{pmatrix} \s_{1}(\l_{1}) & \cdots & \s_{1}(\l_{n}) \\ \vdots & & \vdots \\ \s_{n}(\l_{1}) & \cdots & \s_{n}(\l_{n}) \end{pmatrix},
    \]
    where \(\s_{1},\ldots,\s_{n}\) are the elements of \(\Hom_{K}(L,\conj{K})\). Then we have the following result:

    \begin{proposition}\label{disc_as_square_of_embedding_matrix}
      Let \(L/K\) be a degree \(n\) separable extension. Then for any basis \(\l_{1},\ldots,\l_{n}\) of \(L/K\), we have
      \[
        d_{L/K}(\l_{1},\ldots,\l_{n}) = \det(M(\l_{1},\ldots,\l_{n}))^{2}.
      \]
    \end{proposition}
    \begin{proof}
      Recalling that the \((i,j)\)-entry of \(M(\l_{1},\ldots,\l_{n})^{t}M(\l_{1},\ldots,\l_{n})\) is the dot product of the \(i\)-th and \(j\)-th columns of \(M(\l_{1},\ldots,\l_{n})\), we compute
      \begin{align*}
        \det(M(\l_{1},\ldots,\l_{n}))^{2} &= \det(M(\l_{1},\ldots,\l_{n})^{t}M(\l_{1},\ldots,\l_{n})) \\
        &= \det\left(\left(\sum_{\s \in \Hom_{K}(L,\conj{K})}\s(\l_{i})\s(\l_{j})\right)_{i,j}\right) \\
        &= \det\left(\left(\sum_{\s \in \Hom_{K}(L,\conj{K})}\s(\l_{i}\l_{j})\right)_{i,j}\right) \\
        &= \det(\Trace_{L/K}(\l_{1},\ldots,\l_{n})) \\
        &= d_{L/K}(\l_{1},\ldots,\l_{n}),
      \end{align*}
      where the second to last equality follows by \cref{prop:formulas_for_trace_and_norm}, as desired.
    \end{proof}

    When the degree \(n\) separable extension \(L/K\) admits a basis of the form \(1,\l,\ldots,\l^{n-1}\) (in fact such a basis always exists by choosing \(\l\) to be a primitive element for \(L/K\)) \(d_{L/K}(1,\l,\ldots,\l^{n-1})\) can be easily computed. Indeed, the embedding matrix becomes
    \[
      M(1,\l,\ldots,\l^{n-1}) = \begin{pmatrix} 1 & \s_{1}(\l) & \cdots & \s_{1}(\l)^{n-1} \\ \vdots & \vdots & & \vdots \\ 1 & \s_{n}(\l) & \cdots & \s_{n}(\l)^{n-1} \end{pmatrix},
    \]
    which is a Vandermonde matrix. Then
    \begin{equation}\label{equ:Vandermonde_determinant_for_discriminant}
      d_{L/K}(1,\l,\ldots,\l^{n-1}) = \prod_{1 \le i < j \le n}(\s_{i}(\l)-\s_{j}(\l))^{2},
    \end{equation}
    which is the square of the Vandermonde determinant of \(M(1,\l,\ldots,\l^{n-1})\), by \cref{disc_as_square_of_embedding_matrix}. In any case, discriminants of bases are useful because of the following lemma:

    \begin{lemma}\label{lem:lemma_for_integral_basis_AKBL}
      Let \(A\) be an integrally closed integral domain with field of fractions \(K\), \(L/K\) be a degree \(n\) separable extension, and \(B\) be the integral closure of \(A\) in \(L\). If \(\l_{1},\ldots,\l_{n}\) is a basis for \(L/K\) that is contained in \(B\) then
      \[
        d_{L/K}(\l_{1},\ldots,\l_{n})B \subseteq A\l_{1}+\cdots+A\l_{n}.
      \]
    \end{lemma}
    \begin{proof}
      Since \(\l_{1},\ldots,\l_{n}\) is a basis, we may write \(\b = \k_{1}\l_{1}+\cdots+\k_{n}\l_{n}\) for any \(\b \in B\). Linearity of the trace implies
      \[
        \sum_{1 \le j \le n}\k_{j}\Trace_{L/K}(\l_{i}\l_{j}) = \Trace_{L/K}(\l_{i}\b),
      \]
      for \(1 \le i \le n\). These \(n\) equations are equivalent to the identity
      \[
        \Trace_{L/K}(\l_{1},\ldots,\l_{n})\begin{pmatrix} \k_{1} \\ \vdots \\ \k_{n} \end{pmatrix} = \begin{pmatrix} \Trace_{L/K}(\b\l_{1}) \\ \vdots \\ \Trace_{L/K}(\b\l_{n}) \end{pmatrix}.
      \]
      Multiplying on the left by the adjugate \(\adj(\Trace_{L/K}(\l_{1},\ldots,\l_{n}))\) of \(\Trace_{L/K}(\l_{1},\ldots,\l_{n})\) and recalling that a matrix times its adjugate is its determinant times the identity, we see that
      \[
       d_{L/K}(\l_{1},\ldots,\l_{n})\begin{pmatrix} \k_{1} \\ \vdots \\ \k_{n} \end{pmatrix} = \adj(\Trace_{L/K}(\l_{1},\ldots,\l_{n}))\begin{pmatrix} \Trace_{L/K}(\b\l_{1}) \\ \vdots \\ \Trace_{L/K}(\b\l_{n}) \end{pmatrix}.
      \]
      Since \(\l_{1},\ldots,\l_{n}\) is a basis for \(L/K\) that is contained in \(B\), the matrix \(\Trace_{L/K}(\l_{1},\ldots,\l_{n})\) has entries in \(A\) by \cref{prop:trace_and_norm_AKBL} and therefore \(\adj(\Trace_{L/K}(\l_{1},\ldots,\l_{n}))\) does too. Moreover, \cref{prop:trace_and_norm_AKBL} again implies \(\Trace_{L/K}(\b\l_{i}) \in A\) for all \(i\). So the right-hand side has entires in \(A\) and hence the left-hand side must as well. This means \(d_{L/K}(\l_{1},\ldots,\l_{n})\k_{i} \in A\) for all \(i\). But then
      \[
        d_{L/K}(\l_{1},\ldots,\l_{n})B \subseteq A\l_{1}+\cdots+A\l_{n},
      \]
      as desired.
    \end{proof}

    Again suppose \(A\) is an integrally closed integral domain with field of fractions \(K\), \(L/K\) is a degree \(n\) separable extension, and \(B\) is the integral closure of \(A\) in \(L\). We say that \(\b_{1},\ldots,\b_{n}\) is an \textbf{integral basis}\index{integral basis} for \(B/A\) if \(\b_{1},\ldots,\b_{n}\) is such that
    \[
      B = A\b_{1}+\cdots+A\b_{n}.
    \]
    Equivalently, \(B\) is a free \(A\)-module of rank \(n\). An integral basis is necessarily a basis for \(L/K\) by \cref{prop:field_of_fractions_AKBL}. However, an integral basis need not always exist. For if \(\l_{1},\ldots,\l_{n}\) is a basis of \(L/K\), \cref{prop:field_of_fractions_AKBL} implies that we can multiply by a nonzero element of \(A\) to ensure that this basis is contained in \(B\). However, \(\l_{1},\ldots,\l_{n}\) need not also be a basis of \(B\) as an \(A\)-module. Nevertheless, if \(A\) is a principal ideal domain then we can ensure the existence of an integral basis:
    
    \begin{theorem}\label{thm:integral_basis_AKBL}
      Let \(A\) be a principal ideal domain with field of fractions \(K\), let \(L/K\) be a degree \(n\) separable extension, and let \(B\) be the integral closure of \(A\) in \(L\). Then \(B\) admits an integral basis over \(A\). Moreover, every finitely generated nonzero \(B\)-submodule of \(L\) is a free \(A\)-module of rank \(n\).
    \end{theorem}
    \begin{proof}
      \(A\) is integrally closed by \cref{lemma:unique_factorization_domains_are_integrally_closed}. Let \(\l_{1},\ldots,\l_{n}\) be a basis for \(L/K\). By \cref{prop:field_of_fractions_AKBL} we may multiply by a nonzero element of \(A\), if necessary, to ensure that this basis belongs to \(B\). Then \cref{lem:lemma_for_integral_basis_AKBL} implies
      \[
        d_{L/K}(\l_{1},\ldots,\l_{n})B \subseteq A\l_{1}+\cdots+A\l_{n}.
      \]
      Since \(A\l_{1}+\cdots+A\l_{n}\) is a free \(A\)-module of rank \(n\) and \(A\) is a principal ideal domain, it follows from the structure theorem of finitely generated modules over principal ideal domains that \(B\) is also a free \(A\)-module of rank at most \(n\). But any basis for \(B\) as an \(A\)-module must also be a basis for \(L/K\) by \cref{prop:field_of_fractions_AKBL}. Hence the rank is exactly \(n\) and \(B\) admits an integral basis over \(A\) which proves the first statement. Now suppose \(M\) is a nonzero \(B\)-submodule of \(L\) and let \(\w_{1},\ldots,\w_{r}\) be generators. By \cref{prop:field_of_fractions_AKBL} again we may multiply by a nonzero element of \(A\), if necessary, to ensure that these generators belong to \(B\). But then
      \[
        d_{L/K}(\w_{1},\ldots,\w_{n})M \subseteq d_{L/K}(\w_{1},\ldots,\w_{n})B.
      \]
      By the structure theorem of finitely generated modules over principal ideal domains again, \(M\) is a free \(A\)-module of rank at most \(n\). To see that the rank is at least \(n\), let \(\a \in M\) be nonzero and, as before, let \(\l_{1},\ldots,\l_{n}\) be a basis for \(L/K\) that is contained in \(B\). Then \(\a\l_{1},\ldots,\a\l_{n}\) is a basis for \(L/K\) contained in \(M\). Thus the rank of \(M\) is at least \(n\), and in particular it must be \(n\). This completes the proof.
    \end{proof}

    Recall that if \(L_{1}/K\) and \(L_{2}/K\) are finite separable extensions then the composite \(L\) of \(L_{1}\) and \(L_{2}\) is such that \(L/K\) is also a finite separable extension. Integral bases behave well with respect to composite fields provided the fields are linearly disjoint:

    \begin{proposition}\label{prop:linearly_disjoint_integral_basis}
      Let \(A\) be an integrally closed integral domain with field of fractions \(K\), \(L_{1}/K\) and \(L_{2}/K\) be degree \(n_{1}\) and \(n_{2}\) separable extensions respectively, and \(B_{1}\) and \(B_{2}\) be the integral closures of \(A\) in \(L_{1}\) and \(L_{2}\) respectively. Suppose \(L_{1}\) and \(L_{2}\) are linearly disjoint over \(K\) in \(\conj{K}\) and that \(B_{1}\) and \(B_{2}\) admit integral bases \(\b_{1,1},\ldots,\b_{n_{1},1}\) and \(\b_{1,2},\ldots,\b_{n_{2},2}\) over \(A\) with
      \[
        \a_{1}d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})+\a_{2}d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2}) = 1,
      \]
      for some \(\a_{1},\a_{2} \in A\). Let \(L\) be the composite of \(L_{1}\) and \(L_{2}\) and let \(B\) be the integral closure of \(A\) in \(L\). Then \(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}\) is an integral basis for \(B\) over \(A\) with
      \[
        \d_{L/K}(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}) = d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})^{n_{2}}d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})^{n_{1}}.
      \]
      In particular,
      \[
        B = B_{1}B_{2}.
      \]
    \end{proposition}
    \begin{proof}
      The last statement clearly follows from the first so we will start by proving that \(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}\) is an integral basis for \(B\) over \(A\). Since \(L_{1}\) and \(L_{2}\) are linearly disjoint over \(K\) in \(\conj{K}\), it must be that \(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}\) is a basis for \(L\) as a \(K\)-vector space. Therefore any \(\l \in B\) is of the form
      \[
        \l = \sum_{\substack{1 \le i \le n_{1} \\ 1 \le j \le n_{i}}}\k_{i,j}\b_{i,1}\b_{j,2},
      \]
      for some \(\k_{i,j} \in K\) for \(1 \le i \le n_{1}\) and \(1 \le j \le n_{2}\). Then we need to show that \(\k_{i,j} \in A\) for all \(i\) and \(j\). Now let
      \[
        \a_{i,2} = \sum_{1 \le j \le n_{2}}\k_{i,j}\b_{j,2} \quad \text{and} \quad \a_{j,1} = \sum_{1 \le i \le n_{1}}\k_{i,j}\b_{i,1},
      \]
      for all \(i\) and \(j\) so that
      \[
        \l = \sum_{1 \le i \le n_{1}}\a_{i,2}\b_{i,1} \quad \text{and} \quad \l = \sum_{1 \le j \le n_{2}}\a_{j,1}\b_{j,2}.
      \]
      In particular, \(\a_{i,2} \in L_{2}\) and \(\a_{j,1} \in L_{1}\). By linear disjointness, we have
      \[
        \Hom_{K}(L,\conj{K}) \cong \Hom_{K}(L_{1},\conj{K}) \x \Hom_{K}(L_{2},\conj{K}).
      \]
      So letting \(\s_{1,1},\ldots,\s_{n_{1},1}\) and \(\s_{1,2},\ldots,\s_{n_{2},2}\) be the elements of \(\Hom_{K}(L_{1},\conj{K})\) and \(\Hom_{K}(L_{2},\conj{K})\) respectively, \(\s_{1,1}\s_{1,2},\ldots,\s_{n_{1},1}\s_{n_{2},2}\) are the elements of \(\Hom_{K}(L,\conj{K})\). In particular, we may view \(\s_{1,1},\ldots,\s_{n_{1},1}\) and \(\s_{1,2},\ldots,\s_{n_{2},2}\) as elements of \(\Hom_{K}(L,\conj{K})\) that act as the identity on \(L_{2}\) and \(L_{1}\) respectively. Then the \(n_{1}\) and \(n_{2}\) equations
      \[
        \sum_{1 \le k \le n_{1}}\s_{i,1}(\b_{k,1})\a_{k,2} = \s_{i,1}(\l) \quad \text{and} \quad \sum_{1 \le k \le n_{2}}\s_{j,2}(\b_{k,2})\a_{k,1} = \s_{j,2}(\l),
      \]
      respectively are equivalent to the identities
      \[
        M(\b_{1,1},\ldots,\b_{n_{1},1})\begin{pmatrix} \a_{1,2} \\ \vdots \\ \a_{n_{1},2} \end{pmatrix} = \begin{pmatrix} \s_{1,1}(\l) \\ \vdots \\ \s_{n_{1},1}(\l) \end{pmatrix} \quad \text{and} \quad M(\b_{1,2},\ldots,\b_{n_{2},2})\begin{pmatrix} \a_{1,1} \\ \vdots \\ \a_{n_{2},1} \end{pmatrix} = \begin{pmatrix} \s_{1,2}(\l) \\ \vdots \\ \s_{n_{2},2}(\l) \end{pmatrix},
      \]
      respectively. Multiplying on the left by the adjugates \(\adj(M(\b_{1,1},\ldots,\b_{n_{1},1}))\) and \(\adj(M(\b_{1,2},\ldots,\b_{n_{2},2}))\) of \(M(\b_{1,1},\ldots,\b_{n_{1},1})\) and \(M(\b_{1,2},\ldots,\b_{n_{2},2})\) respectively and recalling that a matrix times its adjugate is its determinant times the identity, we obtain
      \[
        \det(M(\b_{1,1},\ldots,\b_{n_{1},1}))\begin{pmatrix} \a_{1,2} \\ \vdots \\ \a_{n_{1},2} \end{pmatrix} = \adj(M(\b_{1,1},\ldots,\b_{n_{1},1}))\begin{pmatrix} \s_{1,1}(\l) \\ \vdots \\ \s_{n_{1},1}(\l) \end{pmatrix},
      \]
      and
      \[
        \det(M(\b_{1,2},\ldots,\b_{n_{2},2}))\begin{pmatrix} \a_{1,1} \\ \vdots \\ \a_{n_{2},1} \end{pmatrix} = \adj(M(\b_{1,2},\ldots,\b_{n_{2},2}))\begin{pmatrix} \s_{1,2}(\l) \\ \vdots \\ \s_{n_{2},2}(\l) \end{pmatrix}.
      \]
      Since \(\l \in B\), we have \(\s_{i,1}(\l) \in B\) and \(\s_{j,2}(\b) \in B\) for all \(i\) and \(j\). Moreover, \(M(\b_{1,1},\ldots,\b_{n_{1},1})\) and \(M(\b_{1,2},\ldots,\b_{n_{2},2})\) have entries in \(B\) and thus \(\adj(M(\b_{1,1},\ldots,\b_{n_{1},1}))\) and \(\adj(M(\b_{1,2},\ldots,\b_{n_{2},2}))\) do too. This means the two right-hand sides have entries in \(B\) and so the two left-hand sides must as well. It follows from this fact and \cref{disc_as_square_of_embedding_matrix} that \(d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})\a_{i,2} \in B\) and \(d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})\a_{j,1} \in B\) for all \(i\) and \(j\). But as \(d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})\) and \(d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})\) are in \(A\), \(\a_{i,2} \in L_{2}\), and \(\a_{j,1} \in L_{1}\), we find that \(d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})\a_{i,2} \in B_{2}\) and \(d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})\a_{j,1} \in B_{1}\). Expanding \(\a_{i,2}\) and \(\a_{j,1}\) shows that \(d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})\k_{i,j} \in A\) and \(d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})\k_{i,j} \in A\). From the identity
      \[
        k_{i,j} = k_{i,j}(\a_{1}d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})+\a_{2}d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})),
      \]
      we conclude \(k_{i,j}\) is in \(A\) as desired. This proves \(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}\) is an integral basis for \(B\) over \(A\). We will now compute the discriminant of this basis. As \(\s_{1,1}\s_{1,2},\ldots,\s_{n_{1},1}\s_{n_{2},2}\) are the elements of \(\Hom_{K}(L,\conj{K})\), we have
      \[
        M(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}) = \begin{pmatrix} \s_{1,1}(\b_{1,1})\s_{1,2}(\b_{1,2}) & \cdots & \s_{1,1}(\b_{n_{1},1})\s_{1,2}(\b_{n_{2},2}) \\ \vdots & & \vdots \\ \s_{n_{1},1}(\b_{1,1})\s_{n_{2},2}(\b_{1,2}) & \cdots & \s_{n_{1},1}(\b_{n_{1},1})\s_{n_{2},2}(\b_{n_{2},2}) \end{pmatrix}.
      \]
      This latter matrix admits the block factorization
      \[
        \begin{pmatrix} M(\b_{1,1},\ldots,\b_{n_{1},1}) & & \\ & \ddots & \\ & & M(\b_{1,1},\ldots,\b_{n_{1},1}) \end{pmatrix}\begin{pmatrix} I\s_{1,2}(\b_{1,2}) & \cdots & I\s_{1,2}(\b_{n_{2},2}) \\ \vdots & & \vdots \\ I\s_{n_{2},2}(\b_{1,2}) & \cdots & I\s_{n_{2},2}(\b_{n_{2},2}) \end{pmatrix},
      \]
      where the second matrix is the Kronecker product \(M(\b_{1,2},\ldots,\b_{n_{2},2}) \ox I\). As \(M(\b_{1,2},\ldots,\b_{n_{2},2}) \ox I\) is \((I \ox M(\b_{1,2},\ldots,\b_{n_{2},2}))P\) for some permutation matrix \(P\), it takes the form
      \[
        \begin{pmatrix} M(\b_{1,2},\ldots,\b_{n_{2},2}) & & \\ & \ddots & \\ & & M(\b_{1,2},\ldots,\b_{n_{2},2}) \end{pmatrix}P,
      \]
      with \(\det(P) = \pm 1\). Putting these decompositions together and applying \cref{disc_as_square_of_embedding_matrix} shows
      \[
        \d_{L/K}(\b_{1,1}\b_{1,2},\ldots,\b_{n_{1},1}\b_{n_{2},2}) = d_{L_{1}/K}(\b_{1,1},\ldots,\b_{n_{1},1})^{n_{2}}d_{L_{2}/K}(\b_{1,2},\ldots,\b_{n_{2},2})^{n_{1}}.
      \]
      This completes the proof.
    \end{proof}

    It is generally very difficult to write down an integral basis explicitly. However, there is one instance in which this is possible. We say that \(B\) is \textbf{monogenic}\index{monogenic} over \(A\) if \(B = A[\b]\) for some \(\b \in B\). It follows immediately that \(1,\b,\ldots,\b^{n-1}\) is an integral basis for \(B/A\) since \(B\) is of rank \(n\). The discriminant of this basis is then given by \cref{equ:Vandermonde_determinant_for_discriminant}. In addition, the traces \(\Trace_{L/K}\) and \(\Trace_{B/A}\) and norms \(\Norm_{L/K}\) and \(\Norm_{B/A}\) agree:

    \begin{proposition}\label{prop:trace_and_norm_reduce_for_integral_basis}
      Let \(A\) be an integrally closed integral domain with field of fractions \(K\), \(L/K\) be a degree \(n\) separable extension, and \(B\) be the integral closure of \(A\) in \(L\). If \(B\) admits an integral basis over \(A\) then
      \[
        \Trace_{L/K}(\b) = \Trace_{B/A}(\b) \quad \text{and} \quad \Norm_{L/K}(\b) = \Norm_{B/A}(\b),
      \]
      for all \(\b \in B\).
    \end{proposition}
    \begin{proof}
      Let \(\b_{1},\ldots,\b_{n}\) be an integral basis for \(B/A\). Then \(\b_{1},\ldots,\b_{n}\) is also a basis for \(L/K\). It follows that the multiplication by \(\b\) map in \(L\) has the same matrix representation as it does in \(B\). Therefore
      \[
        \Trace_{L/K}(\b) = \Trace_{B/A}(\b) \quad \text{and} \quad \Norm_{L/K}(\b) = \Norm_{B/A}(\b),
      \]
      as desired.
    \end{proof}

    We now turn to the case of a number field \(K\) of degree \(n\). We write \(\Trace_{K} = \Trace_{K/\Q}\) and \(\Norm_{K} = \Norm_{K/\Q}\) and call these the \textbf{field trace}\index{field trace} and \textbf{field norm}\index{field norm} of \(K\) respectively. Moreover, for any \(\k \in K\) we call \(\Trace_{K}(\k)\) and \(\Norm_{K}(\k)\) the \textbf{trace}\index{trace} and \textbf{norm}\index{norm} of \(\k\) respectively. Then from \cref{prop:trace_and_norm_AKBL,prop:unit_if_and_only_if_AKBL} we see that the trace and norm of algebraic integers are themselves integers and \(\k \in \mc{O}_{K}\) is a unit if and only if \(\Norm_{K}(\k) = \pm 1\) (as these are the only units in \(\Z\)). Moreover, since \(\Z\) is a principal ideal domain \cref{thm:integral_basis_AKBL} implies that \(\mc{O}_{K}\) admits an integral basis over \(\Z\) of degree \(n\). That is, \(\mc{O}_{K}\) is a free abelian group of rank \(n\). Accordingly, we say that \(\a_{1},\ldots,\a_{n}\) is an \textbf{integral basis}\index{integral basis} for \(K\) if it is an integral basis of \(\mc{O}_{K}\) over \(\Z\). Accordingly, we define the \textbf{discriminant}\index{discriminant} \(\D_{K}\) of \(K\) to be the discriminant of \(\mc{O}/\smc{O}\). As \((\Z^{\ast})^{2} = \{1\}\), \(\D_{K}\) is a well-defined integer and satisfies
    \[
      \D_{K} = d_{L/K}(\a_{1},\ldots,\a_{n}),
    \]
    for any integral basis \(\a_{1},\ldots,\a_{n}\) for \(K\). Moreover, \(\D_{K}\) is nonzero by \cref{prop:trace_and_norm_AKBL,lem:trace_is_nondegenerate} and may very well be negative. In light of \cref{disc_as_square_of_embedding_matrix}, we also have
    \[
      |\det(M(\a_{1},\ldots,\a_{n}))| = \sqrt{|\D_{K}|}.
    \]
    Lastly, we say \(K\) is \textbf{monogenic}\index{monogenic} if \(\mc{O}_{K}\) is monogenic over \(\Z\).
  \section{Dedekind Domains}
    Let \(\smc{O}\) be a noetherian integral domain and denote its field of fractions by \(K\). Any nonzero ideal \(\mf{a}\) of \(\smc{O}\) is said to be an \textbf{integral ideal}\index{integral ideal} of \(\smc{O}\). We call any prime integral ideal \(\mf{p}\) of \(\smc{O}\) a \textbf{prime}\index{prime} of \(\smc{O}\) and if \(\mf{p}\) is principal with \(\mf{p} = \a\smc{O}\), with \(\a \in K\) nonzero, we will simply refer to \(\a\) as the prime instead of \(\mf{p}\). In any case, an integral ideal \(\mf{a}\) is just a \(\smc{O}\)-submodule of \(\smc{O}\). Moreover, it is finitely generated since \(\smc{O}\) is noetherian and is therefore a finitely generated \(\smc{O}\)-submodule of \(K\). More generally, we say \(\mf{f}\) is a \textbf{fractional ideal}\index{fractional ideal} of \(\smc{O}\) if \(\mf{f}\) a nonzero finitely generated \(\smc{O}\)-submodule of \(K\). Moreover, we say that a fractional ideal is \textbf{principal}\index{principal} if it is generated by a single element. That is, if \(\mf{f} = \k\smc{O}\) for some nonzero \(\k \in K\). In particular, all integral ideals are fractional ideals and all principal integral ideals are principal fractional ideals. Now let \(\k_{1},\ldots,\k_{r} \in K\) be generators for the fractional ideal \(\mf{f}\). Since \(K\) is the field of fractions of \(\smc{O}\), \(\k_{i} = \frac{\a_{i}}{\d_{i}}\) with \(\a_{i},\d_{i} \in \smc{O}\) and where \(\d_{i}\) is nonzero for \(1 \le i \le r\). Setting \(\d = \d_{1} \cdots \d_{r}\), we have that \(\d\k_{i} \in \smc{O}\) for all \(i\) and hence \(\d\mf{f}\) is an integral ideal. Conversely, if there exists some nonzero \(\d \in \smc{O}\) such that \(\d\mf{f} = \mf{a}\) is an integral ideal then \(\mf{f}\) is a fractional ideal because \(\mf{a}\) is a finitely generated \(\smc{O}\)-submodule of \(K\) and hence \(\mf{f}\) is too. Thus for any fractional ideal \(\mf{f}\), there exists a nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\) such that
    \[
      \mf{f} = \frac{1}{\d}\mf{a}.
    \]
    Every fractional ideal is of this form, and integral ideals are precisely those for which \(\d = 1\), and fractional ideals need not be a subgroup of \(\smc{O}\). We will be able to show that an fractional ideal of \(\smc{O}\) factors into a product of primes provided that \(\smc{O}\) satisfies a few more restrictive conditions. Accordingly, we say that a ring is a \textbf{Dedekind domain}\index{Dedekind domain} if it satisfies the following properties:
    \begin{enumerate}[label*=(\roman*)]
      \item It is an integrally closed integral domain.
      \item It is noetherian.
      \item Every nonzero prime ideal is maximal.
    \end{enumerate}
    In other words, a noetherian integral domain is a Dedekind domain if and only if it is integrally closed and every nonzero prime is maximal.
    
    \begin{remark}
      \(\Z\) is an integrally closed integral domain by \cref{lemma:unique_factorization_domains_are_integrally_closed}. It is also noetherian since \(\Z\) is a principal ideal domain. Every prime is of the form \(p\Z\) for some prime \(p\) and therefore is maximal because \(\Z/p\Z\) is a field. It follows that \(\Z\) is a Dedekind domain and the primes of \(\Z\) are exactly the primes \(p\).
    \end{remark}
    
    With this setup, property (ii) can be rephrased as saying that every integral ideal is finitely generated while property (iii) is equivalent to the fact that every prime is maximal. One should think of Dedekind domains as generalizations of \(\Z\). Note that we have not assumed \(\smc{O}\) is a principal ideal domain. In fact, the most interesting Dedekind domains are not principal ideal domains. Our primary concern regarding Dedekind domains will be to show that, while there need not be prime factorization of elements, fractional ideals admit a factorization into a product of primes. We first show containment in one direction for integral ideals:

    \begin{lemma}\label{lem:integral_ideal_prime_containment}
      Let \(\smc{O}\) be a Dedekind domain. For every integral ideal \(\mf{a}\), there exist primes \(\mf{p}_{1},\ldots,\mf{p}_{k}\) such that
      \[
        \mf{p}_{1}\cdots\mf{p}_{k} \subseteq \mf{a}.
      \]
    \end{lemma}
    \begin{proof}
      Let \(\mc{S}\) be the set of integral ideals which do not contain a product of prime integral. Then it suffices to show \(\mc{S}\) is empty. Assuming otherwise and ordering \(\mc{S}\) by inclusion, the fact that \(\smc{O}\) is noetherian implies that there exists a maximal integral ideal \(\mf{a} \in \mc{S}\). Moreover \(\mf{a}\) cannot be prime for otherwise \(\mf{a}\) contains a product of primes (namely itself). Since \(\mf{a}\) is not prime, there exist \(\a_{1},\a_{2} \in \smc{O}\) with \(\a_{1}\a_{2} \in \mf{a}\) and such that \(\a_{1},\a_{2} \notin \mf{a}\). Now define integral ideals
      \[
        \mf{b}_{1} = \mf{a}+\a_{1}\smc{O} \quad \text{and} \quad \mf{b}_{2} = \mf{a}+\a_{2}\smc{O}.
      \]
      Note that \(\mf{b}_{1}\) and \(\mf{b}_{2}\) strictly contain \(\mf{a}\) because \(\a_{1},\a_{2} \notin \mf{a}\). Moreover, \(\mf{b}_{1}\mf{b}_{2} \subseteq \mf{a}\) because
      \[
        \mf{b}_{1}\mf{b}_{2} = (\mf{a}+\a_{1}\smc{O})(\mf{a}+\a_{2}\smc{O}) = \mf{a}^{2}+\a_{1}\smc{O}+\a_{2}\smc{O}+\a_{1}\a_{2}\smc{O},
      \]
      and \(\a_{1}\a_{2} \in \mf{a}\). Maximality of \(\mf{a}\) implies that there exist primes \(\mf{p}_{1},\ldots,\mf{p}_{k}\) and \(\mf{q}_{1},\ldots,\mf{q}_{\ell}\) such that
      \[
        \mf{p}_{1}\cdots\mf{p}_{k} \subseteq \mf{b}_{1} \quad \text{and} \quad \mf{q}_{1}\cdots\mf{q}_{\ell} \subseteq \mf{b}_{2}.
      \]
      But then
      \[
        \mf{p}_{1}\cdots\mf{p}_{k}\mf{q}_{1}\cdots\mf{q}_{\ell} \subseteq \b_{1}\b_{2} \subseteq \mf{a},
      \]
      which contradicts the fact that \(\mf{a} \in \mc{S}\). Hence \(\mc{S}\) is empty as desired.
    \end{proof}

    In order to obtain the reverse containment in \cref{lem:integral_ideal_prime_containment}, we need to do more work. Precisely, we want to show that every integral ideal factors into a product of primes. Let \(\mf{p}\) be a prime. We define \(\mf{p}^{-1}\) by
    \[
      \mf{p}^{-1} = \{\k \in K:\k\mf{p} \subseteq \smc{O}\}.
    \]
    It turns out that \(\mf{p}^{-1}\) is a fractional ideal. Indeed, since \(\mf{p}\) is an integral ideal there exists a nonzero \(\a \in \mf{p}\). By definition of \(\mf{p}^{-1}\), we have that \(\a\mf{p}^{-1} \subseteq \smc{O}\). Hence \(\a\mf{p}^{-1}\) is an integral ideal and therefore \(\mf{p}^{-1}\) is a fractional ideal. Unlike integral ideals, \(1 \in \mf{p}^{-1}\) so that \(\mf{p}^{-1}\) contains units. The following proposition proves a stronger version of this and more:

    \begin{lemma}\label{lem:inverse_for_prime_ideals}
      Let \(\smc{O}\) be a Dedekind domain and \(\mf{p}\) be a prime. Then the following hold:
      \begin{enumerate}[label*=(\roman*)]
        \item
        \[
          \smc{O} \subset \mf{p}^{-1}.
        \]
        \item
        \[
          \mf{p}^{-1}\mf{p} = \smc{O}.
        \]
      \end{enumerate}
    \end{lemma}
    \begin{proof}
      We will prove the latter two statement separately:
      \begin{enumerate}[label*=(\roman*)]
        \item Clearly \(\smc{O} \subseteq \mf{p}^{-1}\) so it suffices to show that \(\mf{p}^{-1}-\smc{O}\) is nonempty. To this end, let \(\a \in \mf{p}\) be nonzero. By \cref{lem:integral_ideal_prime_containment} let \(k \ge 1\) be the minimal integer such that there exist primes \(\mf{p}_{1},\ldots,\mf{p}_{k}\) with
        \[
          \mf{p}_{1} \cdots \mf{p}_{k} \subseteq \a\smc{O}.
        \]
        As \(\a \in \mf{p}\), we have \(\a\smc{O} \subseteq \mf{p}\). Since \(\mf{p}\) is prime, there must be some \(i\) with \(1 \le i \le k\) such that \(\mf{p}_{i} \subseteq \mf{p}\). Without loss of generality, we may assume \(\mf{p}_{1} \subseteq \mf{p}\). As primes are maximal since \(\smc{O}\) is noetherian, we conclude \(\mf{p}_{1} = \mf{p}\). Moreover, since \(k\) is minimal we must have
        \[
          \mf{p}_{2} \cdots \mf{p}_{k} \not\subseteq \a\smc{O}.
        \]
        Hence there exists \(\b \in \mf{p}_{2} \cdots \mf{p}_{k}\) with \(\b \notin \a\smc{O}\). We will now show that \(\b\a^{-1}\) is an element in \(\mf{p}^{-1}-\smc{O}\). Since \(\mf{p}_{1} = \mf{p}\), what we have previously shown implies \(\b\mf{p} \subseteq \a\smc{O}\) and hence \(\b\a^{-1}\mf{p} \in \smc{O}\) which means \(\b\a^{-1} \in \mf{p}^{-1}\). But as \(\b \notin \a\smc{O}\), we also have \(\b\a^{-1} \notin \smc{O}\). Hence \(\b\a^{-1} \in \mf{p}^{-1}-\smc{O}\) which proves (i).
        \item By (i) and the definition of \(\mf{p}^{-1}\), we have \(\mf{p} \subseteq \mf{p}^{-1}\mf{p} \subseteq \smc{O}\). Since \(\mf{p}\) is maximal because \(\smc{O}\) is noetherian, it follows that \(\mf{p}^{-1}\mf{p}\) is either \(\mf{p}\) or \(\smc{O}\). So it suffices to show that the first case cannot hold. Assume by contradiction that \(\mf{p}^{-1}\mf{p} = \mf{p}\). Let \(\w_{1},\ldots,\w_{r}\) generate \(\mf{p}\) and let \(\a \in \mf{p}^{-1}-\smc{O}\) which exists by (i). Then \(\a\w_{i} \in \mf{p}^{-1}\mf{p}\) for \(1 \le i \le r\) and hence \(\a\mf{p} \subseteq \mf{p}^{-1}\mf{p}\). By our assumption, this further implies that \(\a\mf{p} \subseteq \mf{p}\). But then
        \[
          \a\w_{i} = \sum_{1 \le j \le r}\a_{i,j}\w_{j},
        \]
        with \(\a_{i,j} \in \smc{O}\) for \(1 \le i,j \le r\). We can rewrite this as,
        \[
          (\a-\a_{i,i})\w_{i}-\sum_{\substack{1 \le j \le r \\ j \neq i}}\a_{i,j}\w_{j} = 0,
        \]
        for all \(i\). These \(r\) equations are equivalent to the identity
        \[
          \begin{pmatrix} \a-\a_{1,1} & \a_{1,2} & \cdots & -\a_{1,r} \\ -\a_{2,1} & \a-\a_{2,2} & & \\ \vdots & & \ddots & \\ -\a_{r,1} & & & \a-\a_{r,r} \end{pmatrix}\begin{pmatrix} \w_{1} \\ \w_{2} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
        \]
        Thus the determinant of the matrix on the left-hand side must be zero. But this means \(\a\) is a root of the characteristic polynomial \(\det(xI-(\a_{i,j}))\) which is a monic polynomial with coefficients \(\smc{O}\). As \(\smc{O}\) is integrally closed, \(\a \in \smc{O}\) which is a contraction. Thus \(\mf{p}^{-1}\mf{p} = \smc{O}\) proving (ii).
      \end{enumerate}
    \end{proof}

    We can now show that every integral ideal factors uniquely into a product of primes (up to reordering of the factors):

    \begin{theorem}\label{thm:unique_product_prime_ideals}
      Let \(\smc{O}\) be a Dedekind domain. Then for every integral ideal \(\mf{a}\) there exist primes \(\mf{p}_{1},\ldots,\mf{p}_{k}\) such that \(\mf{a}\) factors as
      \[
        \mf{a} = \mf{p}_{1} \cdots \mf{p}_{k}.
      \]
      Moreover, this factorization is unique up to reordering of the factors.
    \end{theorem}
    \begin{proof}
      We first prove existence and then uniqueness. For existence, let \(\mc{S}\) be the set of integral ideals that are not a product of primes. We will show that \(\mc{S}\) is empty. Assuming otherwise and ordering \(\mc{S}\) by inclusion, the fact that \(\smc{O}\) is noetherian implies that there exists a maximal integral ideal \(\mf{a} \in \mc{S}\). Necessarily \(\mf{a}\) is not prime and since primes are maximal in \(\smc{O}\), there is some prime \(\mf{p}_{1}\) for which \(\mf{a} \subset \mf{p}_{1}\). Then by \cref{lem:inverse_for_prime_ideals} (ii), we have \(\mf{p}_{1}^{-1}\mf{a} \subset \smc{O}\) so that \(\mf{p}_{1}^{-1}\mf{a}\) is also an integral ideal. Also, \cref{lem:inverse_for_prime_ideals} (i) implies that \(\mf{a} \subset \mf{a}\mf{p}_{1}^{-1}\). By maximality of \(\mf{a}\), \(\mf{a}\mf{p}_{1}^{-1}\) factors into a product of primes. That is, there exist primes \(\mf{p}_{2},\ldots,\mf{p}_{k}\) such that
      \[
        \mf{a}\mf{p}_{1}^{-1} = \mf{p}_{2},\ldots,\mf{p}_{k}.
      \]
      Hence
      \[
        \mf{a} = \mf{p}_{1},\ldots,\mf{p}_{k},
      \]
      so that \(\mf{a}\) factors into a product of primes which contradicts the fact that \(\mf{a} \in \mc{S}\). Hence \(\mc{S}\) is empty thus proving the existence of such a factorization. Now we prove uniqueness. Suppose that \(\mf{a}\) admits factorizations
      \[
        \mf{a} = \mf{p}_{1},\ldots,\mf{p}_{k} \quad \text{and} \quad \mf{a} = \mf{q}_{1},\ldots,\mf{q}_{\ell},
      \]
      for primes \(\mf{p}_{i}\) and \(\mf{q}_{j}\) with \(1 \le i \le k\) and \(1 \le j \le \ell\). Since \(\mf{p}_{1}\) is prime, there is some \(j\) for which \(\mf{q}_{j} \subseteq \mf{p}_{1}\). Without loss of generality, we may assume \(\mf{q}_{1} \subseteq \mf{p}_{1}\) and since primes are maximal in \(\smc{O}\) we have \(\mf{q}_{1} = \mf{p}_{1}\). Then
      \[
        \mf{p}_{2},\ldots,\mf{p}_{k} = \mf{q}_{2},\ldots,\mf{q}_{\ell}.
      \]
      Repeating this process, we see that \(k = \ell\) and \(\mf{q}_{i} = \mf{p}_{i}\) for all \(i\). This proves uniqueness of the factorization.
    \end{proof}

    As a near immediate corollary of \cref{thm:unique_product_prime_ideals}, all fractional ideal admits a factorization into a product of primes and their inverses (up to reordering of the factors):

    \begin{corollary}\label{cor:fractional_ideal_prime_factorization}
      Let \(\smc{O}\) be a Dedekind domain. Then for every fractional ideal \(\mf{f}\) there exist primes \(\mf{p}_{1},\ldots,\mf{p}_{k}\) and \(\mf{q}_{1},\ldots,\mf{q}_{\ell}\) such that \(\mf{f}\) factors as
      \[
        \mf{f} = \mf{p}_{1} \cdots \mf{p}_{k}\mf{q}_{1}^{-1},\ldots,\mf{q}_{\ell}^{-1}.
      \]
      Moreover, this factorization is unique up to reordering of the factors.
    \end{corollary}
    \begin{proof}
      If \(\mf{f}\) is a fractional ideal then there exists a nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\) such that \(\mf{f} = \frac{1}{\d}\mf{a}\). In particular, \(\mf{a}\) and \(\d\smc{O}\) are integral ideals such that \(\d\smc{O}\mf{f} = \mf{a}\). By \cref{thm:unique_product_prime_ideals}, \(\mf{a}\) and \(\d\smc{O}\) admit unique factorizations
      \[
        \mf{a} = \mf{p}_{1} \cdots \mf{p}_{k} \quad \text{and} \quad \d\smc{O} = \mf{q}_{1},\ldots,\mf{q}_{\ell},
      \]
      for some primes \(\mf{p}_{1},\ldots,\mf{p}_{k}\) and \(\mf{q}_{1},\ldots,\mf{q}_{\ell}\) up to reordering of the factors. Hence
      \[
        \mf{q}_{1},\ldots,\mf{q}_{\ell}\mf{f} = \mf{p}_{1} \cdots \mf{p}_{k},
      \]
      which is equivalent to the factorization for \(\mf{f}\).
    \end{proof}

    By \cref{cor:fractional_ideal_prime_factorization}, for any fractional ideal \(\mf{f}\) there exist distinct prime \(\mf{p}_{1},\ldots,\mf{p}_{r}\) such that \(\mf{f}\) admits a factorization
    \[
      \mf{f} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
    \]
    with \(e_{i} \in \Z-\{0\}\) for all \(i\), called the \textbf{prime factorization}\index{prime factorization} of \(\mf{f}\) with \textbf{prime factors}\index{prime factors} \(\mf{p}_{1},\ldots,\mf{p}_{r}\). In particular, the prime factorization of an integral ideal \(\mf{a}\) is of the form
    \[
      \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
    \]
    with \(e_{i} \ge 1\) for all \(i\). Accordingly, for any two integral ideal \(\mf{a}\) and \(\mf{b}\) we say that \(\mf{a}\) \textbf{divides}\index{divides} \(\mf{b}\) and write \(\mf{a} \mid \mf{b}\) if \(\mf{b} \subseteq \mf{a}\). Sometimes this condition is expressed as \textit{to contain is to divide} or \textit{to divide is to contain}. By the prime factorization of fractional ideals, this is equivalent to the fact that every prime power factor of \(\mf{a}\) appears in the prime factorization of \(\mf{b}\). We also say that \(\mf{a}\) \textbf{exactly divides}\index{exactly divides} \(\mf{b}\) and write \(\mf{a} \mid\mid \mf{b}\) if \(\mf{a}\) divides \(\mf{b}\) but no power of \(\mf{a}\) divides \(\mf{b}\). This is equivalent to the fact that every prime power factor of \(\mf{a}\) appears in the prime factorization of \(\mf{b}\) but not for any power of \(\mf{a}\). In the case of a prime \(\mf{p}\) and an integral ideal \(\mf{a}\), \(\mf{p} \mid \mf{a}\) if and only if \(\mf{p}\) is a prime factor of \(\mf{a}\) and \(\mf{p}^{e} \mid\mid \mf{a}\), for some \(e \ge 1\), if and only if \(\mf{p}^{e}\) is exactly the power of \(\mf{p}\) appearing in the prime factorization of \(\mf{a}\). Moreover, if \(\mf{a} \mid \mf{p}\) then \(\mf{a} = \mf{p}\). The \textbf{greatest common divisor}\index{greatest common divisor} \((\mf{a},\mf{b})\) of \(\mf{a}\) and \(\mf{b}\) is defined to be the integral ideal that all other common integral ideal divisors divide. Since to divide is to contain, \((\mf{a},\mf{b})\) is the smallest ideal that contains both \(\mf{a}\) and \(\mf{b}\). This is \(\mf{a}+\mf{b}\) and so \((\mf{a},\mf{b}) = \mf{a}+\mf{b}\). The \textbf{least common multiple}\index{least common multiple} \([\mf{a},\mf{b}]\) of \(\mf{a}\) and \(\mf{b}\) is defined to be the integral ideal that divides all other common multiples. Since to divide is to contain, \([\mf{a},\mf{b}]\) is the largest integral ideal that is contained in both \(\mf{a}\) and \(\mf{b}\). This is \(\mf{a} \cap \mf{b}\) and so \([\mf{a},\mf{b}] = \mf{a} \cap \mf{b}\). Moreover, we say that \(\mf{a}\) and \(\mf{b}\) are \textbf{relatively prime}\index{relatively prime} if \((\mf{a},\mf{b}) = \smc{O}\). In other words, we have
    \[
      \mf{a}+\mf{b} = \smc{O}.
    \]
    This is equivalent to the prime factorizations of \(\mf{a}\) and \(\mf{b}\) containing distinct primes. In particular, distinct primes and their powers are relatively prime. Moreover, if \(\mf{a}\) and \(\mf{b}\) and relatively prime then we also have
    \[
      \mf{a} \cap \mf{b} = \mf{a}\mf{b}.
    \]
    The reverse containment is obvious. For the forward containment, since \(\mf{a}+\mf{b} = \smc{O}\) there exists \(\a \in \mf{a}\) and \(\b \in \mf{b}\) such that \(\a+\b = 1\). Now let \(\g \in \mf{a} \cap \mf{b}\). Then \(\g = \g\a+\g\b\) and hence \(\g \in \mf{a}\mf{b}\). The reverse containment follows which proves equality. Just as it is common to suppress the fundamental theorem of arithmetic and just state the prime factorization of an integer, we suppress referencing \cref{thm:unique_product_prime_ideals} and simply state the prime factorization of a fractional ideal. We can now show that for a Dedekind domain, being a principal ideal domain is equivalent to being a unique factorization domain:

    \begin{proposition}\label{prop:UDF_PID_equivalence_for_Dedekind}
      Let \(\smc{O}\) be a Dedekind domain. Then \(\smc{O}\) is a principal ideal domain if and only if it is a unique factorization domain.
    \end{proposition}
    \begin{proof}
      The forward implication is trivial since every principal ideal domain is a unique factorization domain. For the reverse implication, suppose \(\smc{O}\) is a unique factorization domain. Since every integral ideal factors into a product of primes by \cref{thm:unique_product_prime_ideals} and the product of principal integral ideals is principal, it suffices to show that primes are principal. So let \(\mf{p}\) be a prime. Then there exists nonzero \(\a \in \mf{p}\) and \(\a\) is not a unit since \(\mf{p}\) is prime (primes are necessarily proper). Since \(\smc{O}\) is a unique factorization domain, we may write
      \[
        \a = \mu\rho_{1}^{e_{1}} \cdots \rho_{r}^{e_{r}},
      \]
      for some unit \(\mu\) and primes \(\rho_{i} \in \smc{O}\) and integers \(e_{i} \ge 1\) for \(1 \le i \le r\) with \(r \ge 1\). Since \(\mf{p}\) is prime, it follows that there is some \(i\) such that \(\rho_{i} \in \mf{p}\). Without loss of generality, we may assume \(\rho_{1} \in \mf{p}\). Then the integral ideal \(\rho_{1}\smc{O}\) satisfies \(\rho_{1}\smc{O} \subseteq \mf{p}\). As \(\rho_{1}\) is prime and \(\smc{O}\) is a unique factorization domain, \(\rho_{1}\smc{O}\) is a prime and hence maximal since \(\smc{O}\) is also a Dedekind domain. Thus \(\rho_{1}\smc{O} = \mf{p}\) and hence \(\mf{p}\) is principal completing the proof.
    \end{proof}

    With the prime factorization in hand, we will discuss the group structure of the fractional ideals of \(\smc{O}\). Let \(I_{\smc{O}}\) denote the set of fractional ideals of \(\smc{O}\). We call \(I_{\smc{O}}\) the \textbf{ideal group}\index{ideal group} of \(\smc{O}\). The following theorem shows that \(I_{\smc{O}}\) is indeed a group:

    \begin{theorem}\label{thm:ideal_group_is_a_group}
      Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\). Then \(I_{\smc{O}}\) is an abelian group with identity \(\smc{O}\).
    \end{theorem}
    \begin{proof}
      It is clear that the product of fractional ideals is a fractional ideal. Associativity and commutativity of \(I_{\smc{O}}\) are also obvious. The identity is \(\smc{O}\) because every fractional ideal is a finitely generated \(\smc{O}\)-submodule of \(K\). It follows that \(\mf{p}^{-1}\) is the inverse of any prime \(\mf{p}\) by \cref{lem:inverse_for_prime_ideals} (ii). Therefore every prime is invertible. If \(\mf{a}\) is a integral ideal then it admits a prime factorization \(\mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}}\) and then \(\mf{b} = \mf{p}_{1}^{-e_{1}} \cdots \mf{p}_{r}^{-e_{r}}\) is its inverse. Hence every integral ideal is invertible. If \(\mf{f}\) is a fractional ideal, there exists a nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\) such that \(\mf{f} = \frac{1}{\d}\mf{a}\) and hence \(\mf{f}\) is invertible because \(\d\) and \(\mf{a}\) are. It follows that every fractional ideal is invertible which completes the proof.
    \end{proof}

    Now that we have proved that the ideal group \(I_{\smc{O}}\) of \(K\) is indeed a group, we can also deduce the explicit form for the inverse \(\mf{f}^{-1}\) of any fractional ideal \(\mf{f}\):

    \begin{proposition}\label{prop:explicit_inverse_ideal}
      Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\) and let \(\mf{f}\) be a fractional ideal. Then
      \[
        \mf{f}^{-1} = \{\k \in K:\k\mf{f} \subseteq \smc{O}\}.
      \]
      In particular, \(\smc{O} \subseteq \mf{f}\) if and only if \(\mf{f}^{-1}\) is an integral ideal.
    \end{proposition}
    \begin{proof}
      Let \(\mf{f}\) be a fractional ideal. Then the inverse \(\mf{f}^{-1}\) exists by \cref{thm:ideal_group_is_a_group}. In the case of an integral ideal \(\mf{a}\), we have
      \[
        \mf{a}^{-1} = \{\k \in K:\k\mf{a} \subseteq \smc{O}\},
      \]
      by the prime factorization of \(\mf{a}\) and the definition of the inverse of a prime. If \(\mf{f}\) is a fractional ideal, there exists a nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\) such that \(\mf{f} = \frac{1}{\d}\mf{a}\). But then \(\d\mf{f} = \mf{a}\) so that
      \[
        \frac{1}{\d}\mf{f}^{-1} = \{\k \in K:\k\d\mf{f} \subseteq \smc{O}\},
      \]
      which is equivalent to the first statement. For the second statement, if \(\smc{O} \subseteq \mf{f}\) then multiplying by \(\mf{f}^{-1}\) shows \(\mf{f}^{-1} \subseteq \smc{O}\) and hence \(\mf{f}^{-1}\) is an integral ideal. Running this argument backwards by multiplying by \(\mf{f}\) proves the converse.
    \end{proof}

    We will now discuss applications of the Chinese remainder theorem in the context of integral ideals. With it we can prove some interesting results. First, we recall a useful fact. Suppose \(\mf{a}\) is an integral ideal with prime factorization
    \[
      \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}}.
    \]
    As powers of distinct primes are relatively prime, the integral ideals \(\mf{p}_{1}^{e_{1}},\ldots,\mf{p}_{r}^{e_{r}}\) are pairwise relatively prime so that the Chinese remainder theorem gives an isomorphism
    \[
      \smc{O}/\mf{a} \cong \bigop_{1 \le i \le r}\smc{O}/\mf{p}_{i}^{e_{i}}.
    \]
    In particular, for any \(\a_{i} \in \smc{O}\) for all \(i\), there exists a unique \(\a \in \smc{O}\) such that
    \[
      \a \equiv \a_{i} \pmod{\mf{p}_{i}^{e_{i}}},
    \]
    for all \(i\). We will use the Chinese remainder theorem to prove a few useful lemmas about Dedekind domains. For convenience, if \(\smc{O}\) is a Dedekind domain with prime \(\mf{p}\) we will let \(\F_{\mf{p}} = \smc{O}/\mf{p}\) be the residue class field of \(\smc{O}\) by \(\mf{p}\) (recall \(\mf{p}\) is maximal). The first lemma is an isomorphism between the residue class field and quotients by powers of primes:

    \begin{lemma}\label{lem:isomorphism_of_quotient_by_prime_integral_ideals}
      Let \(\smc{O}\) be a Dedekind domain. Then for any prime \(\mf{p}\) and \(n \ge 0\), we have an isomorphism
      \[
        \F_{\mf{p}} \cong \mf{p}^{n}/\mf{p}^{n+1}.
      \]
    \end{lemma}
    \begin{proof}
      By uniqueness of prime factorizations of fractional ideals, there exists \(\b \in \mf{p}^{n}-\mf{p}^{n+1}\). Now consider the homomorphism
      \[
        \phi:\smc{O} \to \mf{p}^{n}/\mf{p}^{n+1} \qquad \a \mapsto \a\b+\mf{p}^{n+1}.
      \]
      By the first isomorphism theorem, it suffices to show \(\ker\phi = \mf{p}\) and that \(\phi\) is surjective. Let us first show \(\ker\phi = \mf{p}\). As \(\b \in \mf{p}^{n}\), it is obvious that \(\mf{p} \subseteq \ker\phi\). Conversely, suppose \(\a \in \smc{O}\) is such that \(\phi(\a) = 0\). Then \(\a\b \in \mf{p}^{n+1}\) and as \(\b \in \mf{p}^{n}-\mf{p}^{n+1}\), we must have \(\a \in \mf{p}\). It follows that \(\ker\phi = \mf{p}\). We now show that \(\phi\) is surjective. Let \(\g\) be a representative of a coset in \(\mf{p}^{n}/\mf{p}^{n+1}\). As \(\b \in \mf{p}^{n}\), we have \(\b\smc{O} \subseteq \mf{p}^{n}\). But since \(\b \notin \mf{p}^{n+1}\), we see that \(\b\smc{O}\mf{p}^{-n}\) is necessarily an integral ideal relatively prime to \(\mf{p}^{n+1}\). As \(\mf{p}^{n+1}\) and \(\b\smc{O}\mf{p}^{-n}\) are relatively prime, the Chinese remainder theorem implies that we can find a unique \(\a \in \smc{O}\) such that
      \[
        \a \equiv \g \pmod{\mf{p}^{n+1}} \quad \text{and} \quad \a \equiv 0 \pmod{\b\smc{O}\mf{p}^{-n}}.
      \]
      The second condition means \(\a \in \b\smc{O}\mf{p}^{-n}\). As \(\g \in \mf{p}^{n}\) and \(\a\) and \(\g\) differ by an element in \(\mf{p}^{n+1} \subset \mf{p}^{n}\), we have that \(\a \in \b\smc{O}\mf{p}^{-n} \cap \mf{p}^{n} = \b\smc{O}\) where the equality holds because the intersection of ideals is equal to their product provided the ideals are relatively prime. Thus \(\a\b^{-1} \in \smc{O}\) and hence
      \[
        \phi(\a\b^{-1}) = \a+\mf{p}^{n+1} = \g+\mf{p}^{n+1}.
      \]
      This shows \(\phi\) is surjective completing the proof.
    \end{proof}

    Our second lemma shows that given two integral ideals, we can multiply by a relatively prime integral ideal and produce a principal integral ideal:

    \begin{lemma}\label{lem:relatively_prime_and_principal}
      Let \(\smc{O}\) be a Dedekind domain and \(\mf{a}\) and \(\mf{b}\) be integral ideals. Then there exists an integral ideal \(\mf{c}\) relatively prime to \(\mf{b}\) such that \(\mf{a}\mf{c}\) is principal.
    \end{lemma}
    \begin{proof}
      Let \(\mf{p}_{1},\ldots,\mf{p}_{r}\) be the prime factors of both \(\mf{a}\) and \(\mf{b}\) so that
      \[
        \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}} \quad \text{and} \quad \mf{b} = \mf{p}_{1}^{f_{1}} \cdots \mf{p}_{r}^{f_{r}},
      \]
      with \(e_{i} \ge 0\) and \(f_{i} \ge 0\) for all \(1 \le i \le r\). By the prime factorization of fractional ideals, there exists \(\a_{i} \in \mf{p}_{i}^{e_{i}}-\mf{p}_{i}^{e_{i}+1}\) for all \(i\). Since \(\mf{p}_{1}^{e_{1}+1},\ldots,\mf{p}_{r}^{e_{r}+1}\) are pairwise relatively prime, the Chinese remainder theorem implies the existence of an \(\a \in \smc{O}\) such that \(\a \equiv \a_{i} \tmod{\mf{p}_{i}^{e_{i}+1}}\) for all \(i\). But then
      \[
        \a \equiv 0 \tmod{\mf{p}_{i}^{e_{i}}} \quad \text{and} \quad \a \equiv \a_{i} \tmod{\mf{p}_{i}^{e_{i}+1}},
      \]
      since \(\a_{i} \in \mf{p}_{i}^{e_{i}}\) for all \(i\). Hence \(\a \in \mf{p}_{i}^{e_{i}}-\mf{p}_{i}^{e_{i}+1}\) and so \(\mf{p}_{i}^{e_{i}} \mid\mid \a\smc{O}\) for all \(i\). It follows that \((\a\smc{O},\mf{a}\mf{b}) = \mf{a}\). Letting \(\mf{c}\) be the integral ideal such that \(\a\smc{O} = \mf{a}\mf{c}\), we have \((\mf{a}\mf{c},\mf{a}\mf{b}) = \mf{a}\). Thus \((\mf{c},\mf{b}) = \smc{O}\) which is to say that \(\mf{c}\) must be relatively prime to \(\mf{b}\).
    \end{proof}

    Our last lemma shows that multiplying by fractional ideals does not affect quotients:

    \begin{lemma}\label{lem:cancellation_isomorphism}
      Let \(\smc{O}\) be a Dedekind domain and \(\mf{f}\), \(\mf{g}\), \(\mf{h}\) be fractional ideals with \(\mf{g} \subseteq \mf{f}\). Then we have an isomorphism
      \[
        \mf{f}/\mf{g} \cong \mf{f}\mf{h}/\mf{g}\mf{h}.
      \]
      In particular,
      \[
        \mf{a}^{-1}/\smc{O} \cong \smc{O}/\mf{a},
      \]
      for any integral ideal \(\mf{a}\).
    \end{lemma}
    \begin{proof}
      We have \(\mf{f} = \frac{\mf{a}}{\a}\), \(\mf{g} = \frac{\mf{b}}{\b}\), and \(\mf{h} = \frac{\mf{c}}{\g}\) for nonzero \(\a,\b,\g \in \smc{O}\) and integral ideals \(\mf{a}\), \(\mf{b}\), and \(\mf{c}\) with \(\mf{b} \subseteq \mf{a}\). In view of the isomorphisms,
      \[
        \mf{f}/\mf{g} \cong \b\mf{a}/\a\mf{b} \quad \text{and} \quad \mf{f}\mf{h}/\mf{g}\mf{h} \cong \b\mf{a}\mf{c}/\a\mf{b}\mf{c},
      \]
      it suffices to show
      \[
        \mf{a}/\mf{b} \cong \mf{a}\mf{c}/\mf{b}\mf{c}.
      \]
      As to contain is to divide, we know \(\mf{a} \mid \mf{b}\). Therefore \(\mf{b}\mf{a}^{-1}\) is an integral ideal. By \cref{lem:relatively_prime_and_principal}, there exists an integral ideal \(\mf{d}\) relatively prime to \(\mf{b}\mf{a}^{-1}\) such that \(\mf{c}\mf{d} = \d\smc{O}\) for some \(\d \in \smc{O}\). But then \(\mf{d}+\mf{b} = \smc{O}\) and hence
      \[
        \d\mf{c}^{-1}+\mf{b}\mf{a}^{-1} = \smc{O}.
      \]
      Multiplying by \(\mf{a}\mf{c}\) yields
      \[
        \d\mf{a}+\mf{b}\mf{c} = \mf{a}\mf{c}.
      \]
      As \(\mf{c}\mf{d} = \d\smc{O}\), we have \(\d\smc{O} \subseteq \mf{c}\) so that \(\d \in \mf{c}\). Therefore we may consider the homomorphism
      \[
        \phi:\mf{a} \to \mf{a}\mf{c}/\mf{b}\mf{c} \qquad \a \mapsto \a\d+\mf{b}\mf{c}.
      \]
      It is surjective by what we have just proved. Moreover, \(\ker\phi = \mf{a} \cap \d^{-1}\mf{b}\mf{c}\). But observe that
      \[
        \mf{a} \cap \d^{-1}\mf{b}\mf{c} = \d^{-1}\mf{a}\mf{c}(\d\mf{c}^{-1} \cap \mf{b}\mf{a}^{-1}) = \d^{-1}\mf{a}\mf{c}(\mf{d} \cap \mf{b}\mf{a}^{-1}) = \mf{b},
      \]
      where the last equality follows since \(\mf{d}\) and \(\mf{b}\mf{a}^{-1}\) are relatively prime so that their intersection is equal to their product. Hence \(\ker\phi = \mf{b}\) and the first statement now follows upon applying the first isomorphism theorem. For the second statement, take \(\mf{f} = \mf{a}^{-1}\), \(\mf{g} = \smc{O}\), and \(\mf{h} = \mf{a}\) (note that \(\smc{O} \subseteq \mf{a}^{-1}\) by \cref{prop:explicit_inverse_ideal}).
    \end{proof}

    We now state two additional interesting facts about Dedekind domains. The first is that any Dedekind domains with only finitely many primes is a principal ideal domain:

    \begin{proposition}\label{prop:Dedekind_with_finite_primes_is_PID}
      Let \(\smc{O}\) be a Dedekind domain. If there are only finitely many primes then \(\smc{O}\) is a principal ideal domain.
    \end{proposition}
    \begin{proof}
      Let \(\mf{p}_{1},\ldots,\mf{p}_{r}\) be the primes of \(\smc{O}\). Then for any integral ideal \(\mf{a}\), the prime factorization is
      \[
        \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
      \]
      with \(e_{i} \ge 0\) for \(1 \le i \le r\). By uniqueness of prime factorizations of fractional ideals, there exists \(\a_{i} \in \mf{p}_{i}^{e_{i}}-\mf{p}_{i}^{e_{i}+1}\) for all \(i\). Since \(\mf{p}_{1}^{e_{1}+1},\ldots,\mf{p}_{r}^{e_{r}+1}\) are pairwise relatively prime, the Chinese remainder theorem implies that there exists \(\a \in \smc{O}\) with 
      \[
        \a \equiv \a_{i} \tmod{\mf{p}_{i}^{e_{i}+1}},
      \]
      for all \(i\). As \(\a_{i} \in \mf{p}_{i}^{e_{i}}\) for all \(i\), we have that \(\a \in \mf{a}\) and hence \(\a\smc{O} \subseteq \mf{a}\). But as \(\a \notin \mf{p}_{i}^{e_{i}+1}\) for all \(i\), we see that \(\a\smc{O}\mf{a}^{-1}\) is necessarily an integral ideal relatively prime to all primes of \(\smc{O}\). This means \(\a\smc{O}\mf{a}^{-1} = \smc{O}\) and hence \(\mf{a} = \a\smc{O}\) so that \(\mf{a}\) is principal. As \(\mf{a}\) was arbitrary, \(\smc{O}\) is a principal ideal domain.
    \end{proof}
    
    The second fact is that any fractional ideal is generated by at most two elements:

    \begin{proposition}\label{prop:fractional_ideal_generated_by_two_elements}
      Let \(\smc{O}\) be a Dedekind domain. Then every fractional ideal is generated by at most two elements.
    \end{proposition}
    \begin{proof}
      We first prove the claim for an integral ideal \(\mf{a}\). Let \(\a \in \mf{a}\) be nonzero and let \(\mf{p}_{1},\ldots,\mf{p}_{r}\) be the prime factors of \(\a\smc{O}\). As \(\a\smc{O} \subseteq \mf{a}\), the prime factorization of \(\mf{a}\) is
      \[
        \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
      \]
      with \(e_{i} \ge 0\) for \(1 \le i \le r\). By uniqueness of prime factorizations of fractional ideals, there exists \(\b_{i} \in \mf{p}_{i}^{e_{i}}-\mf{p}_{i}^{e_{i}+1}\) for all \(i\). Since \(\mf{p}_{1}^{e_{1}+1},\ldots,\mf{p}_{r}^{e_{r}+1}\) are pairwise relatively prime, the Chinese remainder theorem implies that there exists \(\b \in \smc{O}\) with 
      \[
        \b \equiv \b_{i} \tmod{\mf{p}_{i}^{e_{i}+1}},
      \]
      for all \(i\). As \(\b_{i} \in \mf{p}_{i}^{e_{i}}\) for all \(i\), we have that \(\b \in \mf{a}\) and hence \(\b\smc{O} \subseteq \mf{a}\). But as \(\b \notin \mf{p}_{i}^{e_{i}+1}\) for all \(i\), we see that \(\b\smc{O}\mf{a}^{-1}\) is necessarily an integral ideal relatively prime to \(\mf{p}_{1},\ldots,\mf{p}_{r}\) and hence to \(\a\smc{O}\). This means
      \[
        \b\smc{O}\mf{a}^{-1}+\a\smc{O} = \smc{O},
      \]
      and hence
      \[
        \b\smc{O}+\a\mf{a} = \mf{a}.
      \]
      But as \(\a,\b \in \mf{a}\), we have \(\b\smc{O}+\a\mf{a} \subseteq \b\smc{O}+\a\smc{O} \subseteq \mf{a}\) and so
      \[
        \b\smc{O}+\a\smc{O} = \mf{a}.
      \]
      This shows that \(\mf{a}\) is generated by at most two elements. Now suppose \(\mf{f}\) is a fractional ideal. Then there exists a nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\) such that \(\mf{f} = \frac{1}{\d}\mf{a}\). Since \(\mf{a}\) is generated by at most two elements, say \(\a\) and \(\b\), we have
      \[
        \mf{f} = \frac{\a}{\d}\smc{O}+\frac{\b}{\d}\smc{O},
      \]
      and so \(\mf{f}\) is also generated by at most two elements as well.
    \end{proof}

    \cref{prop:fractional_ideal_generated_by_two_elements} shows that while a Dedekind domain \(\smc{O}\) may not be a principal ideal domain, it is not far off from one since every integral ideal needs at most two generators. We can give a more refined interpretation of this using the ideal group \(I_{\smc{O}}\). Let \(P_{\smc{O}}\) denote the subgroup of principal fractional ideals of \(I_{\smc{O}}\). Since \(I_{\smc{O}}\) is abelian by \cref{thm:ideal_group_is_a_group}, \(P_{\smc{O}}\) is normal. The \textbf{ideal class group}\index{ideal class group} \(\Cl(\smc{O})\) of \(\smc{O}\) is defined to be the quotient group
    \[
      \Cl(\smc{O}) = I_{\smc{O}}/P_{\smc{O}},
    \]
    We call an element of \(\Cl(\smc{O})\) an \textbf{ideal class}\index{ideal class} of \(\smc{O}\). As every fractional ideal \(\mf{f}\) can be expressed as \(\mf{f} = \frac{1}{\d}\mf{a}\) for some nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\), we have \(\d\mf{f} = \mf{a}\) and hence every ideal class can be represented by an integral ideal \(\mf{a}\). The \textbf{class number}\index{class number} \(h_{\smc{O}}\) of \(\smc{O}\) is defined by
    \[
      h_{\smc{O}} = |\Cl(\smc{O})|.
    \]
    The ideal class group is an object which encodes how much \(\smc{O}\) fails to be a principal ideal domain (equivalently a unique factorization domain by \cref{prop:UDF_PID_equivalence_for_Dedekind}) while the class number \(h_{\smc{O}}\) is a measure of the degree of failure. For example, \(\smc{O}\) is a principal ideal domain if and only if \(h_{\smc{O}} = 1\). Indeed, if \(\smc{O}\) is a principal ideal domain then every integral ideal is principal and hence every fractional ideal is too (because every fractional ideal is of the form \(\frac{1}{\d}\mf{a}\) for some nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\)). But then \(\Cl(\smc{O})\) is the trivial group and hence \(h_{\smc{O}} = 1\). Conversely, if \(h_{\smc{O}} = 1\) then every integral ideal is principal so that \(\smc{O}\) is a principal ideal domain.

    \begin{remark}\label{rem:general_class_number_not_finite}
      The class number \(h_{\smc{O}}\) need not be finite for a general Dedekind domain \(\smc{O}\).
    \end{remark}
    
    The \textbf{unit group}\index{unit group} of \(\smc{O}\) is defined to be \(\smc{O}^{\ast}\). That is, the unit group is the group of units in \(\smc{O}\). The ideal class group and unit group of \(\smc{O}\) are related via the following exact sequence:

    \begin{proposition}\label{prop:ideal_class_group_exact_sequence}
      Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\). Then the sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & \smc{O}^{\ast} \arrow{r} & K^{\ast} \arrow{r}{\smc{O}} & I_{\smc{O}} \arrow{r} & \Cl(\smc{O}) \arrow{r} & 1,
        \end{tikzcd}
      \end{center}

      where the middle map takes any \(\k \in K^{\ast}\) to its associated principal fractional ideal \(\k\smc{O}\), is exact.
    \end{proposition}
    \begin{proof}
      The sequence is exact at \(\smc{O}^{\ast}\) because the second map is injective. For exactness at \(K^{\ast}\), the image of the second map is contained in the kernel of the third map since \(\smc{O}\) is the identity in \(I_{\smc{O}}\) by \cref{thm:ideal_group_is_a_group}. So suppose \(\k \in K^{\ast}\) is contained in the kernel of the third map. Then \(\k\smc{O} = \smc{O}\) which implies \(\k \in \smc{O}^{\ast}\) because \(1 \in \smc{O}\). This proves exactness at \(K^{\ast}\). Exactness at \(I_{\smc{O}}\) follows by the definition of \(\Cl(\smc{O})\). Lastly, the sequence is exact at \(\Cl(\smc{O})\) since the fourth map is surjective which completes the proof.
    \end{proof}

    Thinking of the third map in \cref{prop:ideal_class_group_exact_sequence} as passing from numbers in \(K^{\ast}\) to fractional ideals in \(I_{\smc{O}}\), exactness means that unit group is measuring the contraction (how many numbers are annihilated) taking place during this process while the class group is measuring the expansion (how many fractional ideal are created).
    
    \begin{remark}
      The class number \(h_{\smc{O}}\) and unit group \(\smc{O}^{\ast}\) of \(\smc{O}\) are generally two of the most difficult pieces of algebraic data of \(\smc{O}\) to compute.
    \end{remark}
    
    We now turn to the case of a number field \(K\) for which our developments so far can be refined. However, in order to apply our results on Dedekind domains, we need to show that \(\mc{O}_{K}\) is one:

    \begin{theorem}\label{thm:ring_of_integers_is_Dedekind}
      Let \(K\) be a number field. Then \(\mc{O}_{K}\) is a Dedekind domain.
    \end{theorem}
    \begin{proof}
      Since \(\mc{O}_{K}\) is the integral closure of \(\Z\) in \(K\), \(\mc{O}_{K}\) is automatically an integrally closed integral domain. As \(\mc{O}_{K}\) is a free abelian group of finite rank, any ideal is a finitely generated \(\Z\)-module and hence a finitely generated \(\mc{O}_{K}\)-module. This proves that \(\mc{O}_{K}\) is noetherian. It remains to prove that every prime of \(\mc{O}_{K}\) is maximal. Letting \(\mf{p}\) be a prime, it suffices to show \(\mc{O}_{K}/\mf{p}\) is a field. To this end, consider the homomorphism
      \[
        \phi:\Z \to \mc{O}_{K}/\mf{p} \qquad a \mapsto a+\mf{p}.
      \]
      Then \(\ker\phi = \mf{p} \cap \Z\) and we claim \(\mf{p} \cap \Z\) is a prime of \(\Z\). It is obviously an ideal of \(\Z\) and is prime because \(\mf{p}\) is. To see that it is nonzero, let \(\a \in \mf{p}\) be nonzero. As \(\a\) is an algebraic integer, we have
      \[
        \a^{n}+a_{n-1}\a^{n-1}+\cdots+a_{0} = 0,
      \]
      for some \(n \ge 1\) and \(a_{i} \in \Z\) for \(0 \le i \le n-1\). Taking \(n\) minimal, we have \(a_{0} \neq 0\). Isolating \(a_{0}\) shows that \(a_{0} \in \mf{p}\) and hence \(a_{0} \in \mf{p} \cap \Z\). Therefore \(\mf{p} \cap \Z = p\Z\) for some prime \(p\). Hence \(\ker\phi = p\Z\) and by the first isomorphism theorem, \(\phi\) induces an injection \(\phi:\F_{p} \to \mc{O}_{K}/\mf{p}\). As \(\mc{O}_{K}\) is the integral closure of \(\Z\) in \(K\), it is obtained from \(\Z\) by forming a polynomial ring with algebraic elements in \(K\). The latter injection then shows that \(\mc{O}_{K}/\mf{p}\) is obtained from \(\F_{p}\) by adjoining these algebraic elements reduced modulo \(\mf{p}\). Their reductions are seen to be algebraic over \(\F_{p}\) by reducing their minimal polynomials over \(\Q\), viewed as elements of \(\smc{O}[x]\), modulo \(\mf{p}\) upon recalling that the coefficients of which are in \(\Z\) by \cref{prop:field_of_fractions_AKBL}. Hence \(\mc{O}_{K}/\mf{p}\) is obtained from \(\F_{p}\) by adjoining algebraic elements to \(\F_{p}\) (since \(\F_{p}[\conj{\a}] = \F_{p}(\conj{\a})\) if \(\conj{\a}\) is algebraic over \(\F_{p}\)) and is therefore a field.
    \end{proof}

    In view of the fact that \(\mc{O}_{K}\) is a Dedekind domain by \cref{thm:ring_of_integers_is_Dedekind}, we simplify some terminology. An \textbf{integral ideal}\index{integral ideal} of \(K\) is simply an integral ideal of \(\mc{O}_{K}\), a \textbf{prime}\index{prime} of \(K\) is a prime of \(\mc{O}_{K}\), and a \textbf{fractional ideal}\index{fractional ideal} of \(K\) is a fractional ideal of \(\mc{O}_{K}\). The \textbf{ideal group}\index{ideal group} \(I_{K}\) of \(K\) is the ideal group of \(\mc{O}_{K}\), we write \(P_{K}\) for the subgroup of principal fractional ideals of \(K\), and the \textbf{ideal class group}\index{ideal class group} \(\Cl(K)\) of \(K\) is the ideal class group of \(\mc{O}_{K}\). In particular,
    \[
      \Cl(K) = I_{K}/P_{K}.
    \]
    The \textbf{class number}\index{class number} \(h_{K}\) of \(K\) is the class number of \(\mc{O}_{K}\) and so
    \[
      h_{K} = |\Cl(K)|.
    \]
    The \textbf{unit group}\index{unit group} of \(K\) is the unit group of \(\mc{O}_{K}\) and we call any element of \(\mc{O}_{K}^{\ast}\) a \textbf{unit}\index{unit} of \(K\) (with the understanding that every element of \(K\) is invertible in \(K\)). It follows from \cref{thm:ring_of_integers_is_Dedekind,thm:unique_product_prime_ideals} that integral ideals \(\mf{a}\) of \(K\) admit prime factorizations. One of our core investigations will be to understand how the principal integral ideal \(p\mc{O}_{K}\) factors into a product of primes of \(K\) for any prime \(p\). Moreover, we will be able to leverage geometric tools to show that the class number \(h_{K}\) is finite and completely describe the unit group \(\mc{O}_{K}^{\ast}\).
  \section{Localization}
    Let \(\smc{O}\) be a noetherian integral domain with field of fractions \(K\). If \(D \subseteq \smc{O}-\{0\}\) is a multiplicative subset (recall that necessarily \(1 \in D\)) then the \textbf{localization}\index{localization} \(\smc{O}D^{-1}\) of \(\smc{O}\) at \(D\) is defined by
    \[
      \smc{O}D^{-1} = \left\{\frac{\a}{\d} \in K:\a \in \smc{O} \text{ and } \d \in D\right\}.
    \]
    Moreover, for any subset \(N\) of \(\smc{O}\), we set
    \[
      ND^{-1} = \left\{\frac{\eta}{\d} \in K:\eta \in N \text{ and } \d \in D\right\}.
    \]
    Now \(\smc{O}D^{-1}\) is clearly a subring of \(K\) which is an integral domain and is it formed from \(\smc{O}\) by making every element of \(D\) invertible. It is also noetherian for if \(\mf{A}\) is an ideal of \(\smc{O}D^{-1}\), set \(\mf{a} = \mf{A} \cap \smc{O}\). Then
    \[
      \mf{A} = \mf{a}D^{-1}.
    \]
    Indeed, the reverse containment is trivial. For the forward containment, if \(\frac{\a}{\d} \in \mf{A}\) then \(\a \in \mf{a}\) because \(\d \in D\) and \(\mf{A}\) is an ideal of \(\smc{O}D^{-1}\). Hence \(\frac{\a}{\d} \in \mf{a}D^{-1}\) as desired. Since \(\smc{O}\) is Dedekind, \(\mf{a}\) is a finitely generated \(\smc{O}\)-module and hence \(\mf{A}\) is a finitely generated \(\smc{O}D^{-1}\)-module by the identity we have just proved. Thus \(\smc{O}D^{-1}\) is noetherian. It follows that if \(\mf{f}\) is a fractional ideal of \(\smc{O}\) then \(\mf{f}D^{-1}\) is a fractional ideal of \(\smc{O}D^{-1}\). We call \(\mf{f}D^{-1}\) the \textbf{localization}\index{localization} of \(\mf{f}\) at \(D\). In the case of primes, we have an exact correspondence:

    \begin{proposition}\label{prop:localization_prime_bijection}
      Let \(\smc{O}\) be a noetherian integral domain and \(D \subseteq \smc{O}-\{0\}\) be a multiplicative subset. Then the maps
      \[
        \mf{q} \mapsto \mf{q}D^{-1} \quad \text{and} \quad \mf{Q} \mapsto \mf{Q} \cap \smc{O}.
      \]
      are inverse inclusion-preserving bijections between the primes \(\mf{q}\) of \(\smc{O}\) disjoint from \(D\) and the primes \(\mf{Q}\) of \(\smc{O}D^{-1}\).
    \end{proposition}
    \begin{proof}
      First suppose \(\mf{q}\) is a prime of \(\smc{O}\) that is disjoint from \(D\). We claim that the integral ideal \(\mf{q}D^{-1}\) of \(\smc{O}D^{-1}\) is prime. Indeed, suppose \(\frac{\a}{\d},\frac{\b}{\g} \in \smc{O}D^{-1}\) are such that \(\frac{\a\b}{\d\g} \in \mf{q}D^{-1}\). Then \(\a\b \in \mf{q}\) and thus \(\a \in \mf{q}\) or \(\b \in \mf{q}\) because \(\mf{q}\) is prime. Hence \(\frac{\a}{\d} \in \mf{q}D^{-1}\) or \(\frac{\b}{\g} \in \mf{q}D^{-1}\) as desired. Also, the prime \(\mf{q}D^{-1}\) satisfies
      \[
        \mf{q} = \mf{q}D^{-1} \cap \smc{O}.
      \]
      The forward inclusion is obvious. For the reverse inclusion, if \(\frac{\a}{\d} \in \mf{q}D^{-1} \cap \smc{O}\) then \(\a \in \mf{q}\) and hence \(\frac{\a}{\d} \in \mf{q}\) because \(\mf{q}\) is prime and \(\d \notin \mf{q}\) (as \(\mf{q}\) is disjoint from \(D\)). Now suppose \(\mf{Q}\) is a prime of \(\smc{O}D^{-1}\). We claim that \(\mf{Q} \cap \smc{O}\) is a prime of \(\smc{O}\) that is disjoint from \(D\). It is clearly an integral ideal of \(\smc{O}\) and is prime because \(\mf{Q}\) is. If \(\mf{Q} \cap \smc{O}\) is not disjoint from \(D\) then \(\d \in \mf{Q} \cap \smc{O}\) with \(\d \in D\). Hence \(1 \in \mf{Q} \cap \smc{O}\) because \(\frac{1}{\d} \in \smc{O}D^{-1}\) and \(\mf{Q}\) is an integral ideal of \(\smc{O}D^{-1}\). This is impossible since \(\mf{Q} \cap \smc{O}\) is prime (hence proper) and therefore must be disjoint from \(D\). Moreover, the prime \(\mf{Q} \cap \smc{O}\) satisfies
      \[
        \mf{Q} = (\mf{Q} \cap \smc{O})D^{-1}.
      \]
      The reverse inclusion is obvious since \(1 \in D\). For the forward inclusion, if \(\frac{\a}{\d} \in \mf{Q}\) then \(\a \in \mf{Q} \cap \smc{O}\) and thus \(\frac{\a}{\d} \in (\mf{Q} \cap \smc{O})D^{-1}\). All of this together shows that the mappings
      \[
        \mf{q} \mapsto \mf{q}D^{-1} \quad \text{and} \quad \mf{Q} \mapsto \mf{Q} \cap \smc{O}.
      \]
      are inverse bijections between the primes \(\mf{q}\) of \(\smc{O}\) disjoint from \(D\) and the primes \(\mf{Q}\) of \(\smc{O}D^{-1}\). They are clearly inclusion-preserving.
    \end{proof}

    From \cref{prop:localization_prime_bijection}, the primes of \(\smc{O}D^{-1}\) are of the form \(\mf{p}D^{-1}\) for primes \(\mf{p}\) of \(\smc{O}\) disjoint from \(D\).

    \begin{remark}
      The bijections in \cref{prop:localization_prime_bijection} need not hold for all integral ideals.
    \end{remark}
    
    Localization is most useful when we localize at the compliment of a prime or collection of primes. If \(\mf{p}\) is a prime of \(\smc{O}\) then \(\smc{O}-\mf{p} \subset \smc{O}-\{0\}\) is a multiplicative subset. Indeed, the inclusion is obvious, \(1 \in \smc{O}-\mf{p}\) because \(\mf{p}\) is proper and thus does not contain units, and if \(\a,\b \in \smc{O}-\mf{p}\) we have \(\a\b \notin \mf{p}\) because \(\mf{p}\) is prime so that \(\a\b \in \smc{O}-\mf{p}\) and thus \(\smc{O}-\mf{p}\) is closed under multiplication. We define the \textbf{localization}\index{localization} \(\smc{O}_{\mf{p}}\) of \(\smc{O}\) at \(\mf{p}\) by
    \[
      \smc{O}_{\mf{p}} = \smc{O}(\smc{O}-\mf{p})^{-1}.
    \]
    In other words,
    \[
      \smc{O}_{\mf{p}} = \left\{\frac{\a}{\d} \in K:\a,\d \in \smc{O} \text{ with } \d \not\equiv 0 \tmod{\mf{p}}\right\}.
    \]
    Essentially, localizing at a prime \(\mf{p}\) removes all of the algebraic information about \(\smc{O}\) that has nothing to do with \(\mf{p}\). If \(\mf{f}\) is a fractional ideal of \(\smc{O}\) then the \textbf{localization}\index{localization} \(\mf{f}_{\mf{p}}\) of \(\mf{f}\) at \(\mf{p}\) is defined to be
    \[
      \mf{f}_{\mf{p}} = \mf{f}(\smc{O}-\mf{p})^{-1}.
    \]
    More generally, let \(X\) be a set of primes in \(\smc{O}\) and consider
    \[
      \smc{O}-\bigcup_{\mf{p} \in X}\mf{p}.
    \]
    Then \(\smc{O}-\bigcup_{\mf{p} \in X}\mf{p} \subseteq \smc{O}-\{0\}\) is a multiplicative subset because
    \[
      \smc{O}-\bigcup_{\mf{p} \in X}\mf{p} = \bigcap_{\mf{p} \in X}(\smc{O}-\mf{p}),
    \]
    and the \(\smc{O}-\mf{p}\) are. We define the \textbf{localization}\index{localization} \(\smc{O}(X)\) of \(\smc{O}\) at \(X\) by
    \[
      \smc{O}(X) = \smc{O}\left(\smc{O}-\bigcup_{\mf{p} \in X}\mf{p}\right)^{-1}.
    \]
    Equivalently,
    \[
      \smc{O}(X) = \left\{\frac{\a}{\d} \in K:\a,\d \in \smc{O} \text{ with } \d \not\equiv 0 \tmod{\mf{p}} \text{ for some } \mf{p} \in X\right\}.
    \]
    If \(\mf{f}\) is a fractional ideal of \(\smc{O}\) then the \textbf{localization}\index{localization} \(\mf{f}(X)\) of \(\mf{f}\) at \(X\) is defined to be
    \[
      \mf{f}(X) = \mf{f}\left(\smc{O}-\bigcup_{\mf{p} \in X}\mf{p}\right)^{-1}.
    \]
    Note that if \(X = \{\mf{p}\}\) then \(\smc{O}(X) = \smc{O}_{\mf{p}}\) and \(\mf{f}(X) = \mf{f}_{\mf{p}}\). In any case, localizing is a useful tool in algebraic investigations and we quickly collect some useful properties. First, localization respects integral closure:

    \begin{proposition}\label{prop:localization_of_integral_closure_is_integral_closure}
      Let \(\smc{O}\) be a noetherian integral domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(\mc{O}\) be the integral closure of \(\smc{O}\) in \(L\). Then for any multiplicative set \(D \subseteq \smc{O}-\{0\}\), \(\mc{O}D^{-1}\) is the integral closure of \(\smc{O}D^{-1}\) in \(L\).
    \end{proposition}
    \begin{proof}
      We need to show that \(\mc{O}D^{-1} = \conj{\smc{O}D^{-1}}\). For the forward inclusion, let \(\frac{\a}{\d} \in \mc{O}D^{-1}\). As \(\mc{O}\) is the integral closure of \(\smc{O}\) in \(L\), \(\a\) is integral over \(\smc{O}\) so that
      \[
        \a^{n}+a_{n-1}\a^{n-1}+\cdots+a_{0} = 0,
      \]
      for some \(n \ge 1\) and \(a_{i} \in \smc{O}\) for \(0 \le i \le n-1\). Diving by \(\d^{n}\), we obtain
      \[
        \left(\frac{\a}{\d}\right)^{n}+\frac{a_{n-1}}{\d}\left(\frac{\a}{\d}\right)^{n-1}+\cdots+\frac{a_{0}}{\d^{n}} = 0.
      \]
      Thus \(\frac{\a}{\d}\) is the root of a monic polynomial with coefficients in \(\smc{O}D^{-1}\). Therefore the forward inclusion holds. For the reverse inclusion, suppose \(\l \in \conj{\smc{O}D^{-1}}\). Then
      \[
        \l^{n}+\frac{a_{n-1}}{\d_{n-1}}\l^{n-1}+\cdots+\frac{a_{0}}{\d_{0}} = 0,
      \]
      for some \(n \ge 1\) and \(\frac{a_{i}}{\d_{i}} \in \smc{O}D^{-1}\) for \(0 \le i \le n-1\). Letting \(\d = \d_{0}\cdots\d_{n-1}\) and multiplying by \(\d^{n}\), we obtain
      \[
        (\l\d)^{n}+\frac{a_{n-1}\d}{\d_{n-1}}(\l\d)^{n-1}+\cdots+\frac{a_{0}\d^{n}}{\d_{0}} = 0.
      \]
      It follows that \(\l\d\) is the root of a monic polynomial with coefficients in \(\smc{O}\). As \(\mc{O}\) is the integral closure of \(\smc{O}\) in \(L\), we have \(\l\d \in \smc{O}\) and thus \(\l \in \smc{O}D^{-1}\). This proves the reverse inclusion which means \(\mc{O}D^{-1}\) is the integral closure of \(\smc{O}D^{-1}\) in \(L\).
    \end{proof}

    In the case of \cref{prop:localization_of_integral_closure_is_integral_closure}, we setup some additional notation. Again suppose \(\smc{O}\) is a noetherian integral domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(\mc{O}\) be the integral closure of \(\smc{O}\) in \(L\). If \(\mf{p}\) is a prime of \(\smc{O}\) and \(\mf{F}\) is a fractional ideal of \(\mc{O}\), the \textbf{localization}\index{localization} \(\mf{F}_{\mf{p}}\) of \(\mf{F}\) at \(\mf{p}\) is defined by
    \[
      \mf{F}_{\mf{p}} = \mf{F}(\smc{O}-\mf{p})^{-1}.
    \]
    More generally, let \(X\) be a set of primes of \(\smc{O}\). Then the \textbf{localization}\index{localization} \(\mf{F}(X)\) of \(\mf{F}\) at \(X\) is defined by
    \[
      \mf{F}(X) = \mf{F}\left(\smc{O}-\bigcup_{\mf{p} \in X}\mf{p}\right)^{-1}.
    \]
    In particular, \cref{prop:localization_of_integral_closure_is_integral_closure} shows that \(\mc{O}_{\mf{p}}\) and \(\mc{O}(X)\) are the integral closures of \(\smc{O}_{\mf{p}}\) and \(\smc{O}(X)\) respectively. Our second property says intersections of localizations behave with respect to fractional ideals and units:

    \begin{proposition}\label{prop:ring_is_intersection_of_all_localizations}
      Let \(\smc{O}\) be a noetherian integral domain. Then for every fractional ideal \(\mf{f}\) of \(\smc{O}\), we have
      \[
        \mf{f} = \bigcap_{\mf{p}}\mf{f}_{\mf{p}}.
      \]
      In particular,
      \[
        \smc{O} = \bigcap_{\mf{p}}\smc{O}_{\mf{p}} \quad \text{and} \quad \smc{O}^{\ast} = \bigcap_{\mf{p}}\smc{O}_{\mf{p}}^{\ast}.
      \]
    \end{proposition}
    \begin{proof}
      The first identity follows from the second by multiplying by a fractional ideal \(\mf{f}\) of \(\smc{O}\). As for the second identity, the forward containment is obvious. For the reverse containment, suppose \(\frac{\a}{\b} \in \bigcap_{\text{\(\mf{p}\) prime}}\smc{O}_{\mf{p}}\) and set
      \[
        \mf{a} = \{\g \in \smc{O}:\a\g \in \b\smc{O}\}.
      \]
      Then \(\mf{a}\) is clearly an integral ideal of \(\smc{O}\) as \(\b \in \mf{a}\). It also cannot be contained in any prime \(\mf{p}\). Indeed, since \(\frac{\a}{\b} \in \smc{O}_{\mf{p}}\) we have \(\b \notin \mf{p}\) and so \(\b \in \mf{a}-\mf{p}\). As \(\smc{O}\) is noetherian (which we recall is equivalent to every nonempty collection of ideals having a maximal element), there exists a maximal integral ideal \(\mf{m}\) which is necessarily prime. As \(\mf{a}\) is not contained in any prime, \(\mf{a}\) is not contained in \(\mf{m}\) and thus \(\mf{a} = \smc{O}\). But then \(1 \in \mf{a}\) and so \(\a \in \b\smc{O}\) implying \(\frac{\a}{\b} \in \smc{O}\) which proves the reverse containment and the second identity follows. For the third identity, the forward containment is clear. For the reverse containment, suppose \(\frac{\a}{\b} \in \bigcap_{\mf{p}}\smc{O}_{\mf{p}}^{\ast}\). We have already showed \(\frac{\a}{\b} \in \smc{O}\) so it suffices to show \(\frac{\a}{\b}\) is a unit. As \(\b \notin \mf{p}\) for any prime \(\mf{p}\), it is necessarily not in any maximal integral ideal. Therefore \(\b \in \smc{O}^{\ast}\) because the complement of the union of all maximal integral ideals is exactly the set of units. Interchanging the roles of \(\a\) and \(\b\) shows that \(\a \in \smc{O}^{\ast}\) as well. Hence \(\frac{\a}{\b} \in \smc{O}^{\ast}\) which proves the reverse containment and the third equality follows.
    \end{proof}

    A noetherian integral domain is said to be \textbf{local}\index{local} if it has a unique maximal integral ideal. As we might expect, localizing at a prime will produce a local noetherian integral domain and hence justifies the term localization. We claim that \(\smc{O}_{\mf{p}}\) is a local noetherian integral domain with maximal integral ideal \(\mf{p}_{\mf{p}}\). Indeed, \(\smc{O}_{\mf{p}}\) is already a noetherian integral domain and it is clear that \(\mf{p}_{\mf{p}}\) is an ideal of \(\smc{O}_{\mf{p}}\). By \cref{prop:localization_prime_bijection}, the map
    \[
      \mf{q} \to \mf{q}_{\mf{p}},
    \]
    is a bijection between the primes of \(\smc{O}\) contained in \(\mf{p}\) the primes of \(\smc{O}_{\mf{p}}\). As maximal integral ideals are necessarily prime, \(\mf{p}_{\mf{p}}\) is the unique maximal integral ideal of \(\smc{O}_{\mf{p}}\). This implies
    \[
      \smc{O}_{\mf{p}}^{\ast} = \smc{O}_{\mf{p}}-\mf{p}_{\mf{p}},
    \]
    because the complement of the union of all maximal integral ideals is exactly the set of units and \(\mf{p}_{\mf{p}}\) is the only one. It follows that \(\smc{O}_{\mf{p}}^{\ast}+\mf{p}_{\mf{p}} = \smc{O}_{\mf{p}}^{\ast}\). Indeed, the reverse containment is trivial and the forward containment follows since otherwise \(\smc{O}_{\mf{p}}^{\ast}+\mf{p}_{\mf{p}} \subseteq \mf{p}_{\mf{p}}\) which would imply \(\smc{O}_{\mf{p}}^{\ast} \subseteq \mf{p}_{\mf{p}}\) and this is impossible because \(\mf{p}_{\mf{p}}\) is maximal (hence proper). In other words, the sum of a unit of \(\smc{O}_{\mf{p}}\) and an element of \(\mf{p}_{\mf{p}}\) is a unit of \(\smc{O}_{\mf{p}}\). Also, if \(\mf{p}\) itself is maximal we can say more:

    \begin{proposition}\label{prop:localization_at_prime_is_local}
      Let \(\smc{O}\) be a noetherian integral domain and \(\mf{p}\) be a prime. Then there is an embedding
      \[
        \smc{O}/\mf{p} \to \smc{O}_{\mf{p}}/\mf{p}_{\mf{p}},
      \]
      identifying \(\smc{O}_{\mf{p}}/\mf{p}_{\mf{p}}\) with the field of fractions of \(\smc{O}/\mf{p}\). In particular, if \(\mf{p}\) is maximal we have
      \[
        \smc{O}/\mf{p}^{n} \cong \smc{O}_{\mf{p}}/\mf{p}_{\mf{p}}^{n},
      \]
      for all \(n \ge 1\).
    \end{proposition}
    \begin{proof}
      Let \(n \ge 1\) and consider the homomorphism
      \[
        \phi:\smc{O}/\mf{p}^{n} \to \smc{O}_{\mf{p}}/\mf{p}_{\mf{p}}^{n} \qquad \a+\mf{p}^{n} \mapsto \a+\mf{p}_{\mf{p}}^{n}.
      \]
      By \cref{prop:localization_prime_bijection}, \(\mf{p} = \mf{p}_{\mf{p}} \cap \smc{O}\) and therefore this map is an embedding when \(n = 1\). As \(\mf{p}_{\mf{p}}\) is maximal, \(\smc{O}_{\mf{p}}/\mf{p}_{\mf{p}}\) is a field and thus must be the field of fractions of \(\smc{O}/\mf{p}\) under this embedding. It remains to prove the last statement so suppose \(\mf{p}\) is maximal. We will show \(\phi\) is both injective and surjective which will finish the proof. For injectivity, it suffices to prove \(\ker\phi = 0\). So let \(\a\) be a representative of a coset in \(\smc{O}/\mf{p}\) such that \(\a \in \mf{p}_{\mf{p}}^{n}\). Then \(\a = \frac{\b}{\d}\) with \(\b \in \mf{p}^{n}\) and \(\d \notin \mf{p}\). Thus \(\b\) is a representative of the zero coset in \(\smc{O}/\mf{p}^{n}\) and so \(\a\) must be too which implies \(\ker\phi = 0\) and injectivity follows. For surjectivity, we first claim that the image of every \(\d \in \smc{O}-\mf{p}\) is a unit in \(\smc{O}/\mf{p}^{n}\) which equivalent to the fact that \(\mf{p}^{n}+\d\smc{O} = \smc{O}\) since there is then a \(\g \in \smc{O}\) such that \(\d-\g \in \mf{p}^{n}\). For \(n = 1\), maximality of \(\mf{p}\) implies \(\mf{p}+\d\smc{O} = \smc{O}\). We now argue by induction, so suppose the claim holds for \(\smc{O}/\mf{p}^{n-1}\). Then \(\mf{p}^{n-1}+\d\smc{O} = \smc{O}\) whence \(\mf{p}^{n}+\d\mf{p} = \mf{p}\) and therefore \(\mf{p}^{n}+\d\mc{O} = \mc{O}\) by the primality of \(\mf{p}\). Now let \(\frac{\a}{\d}\) be a representative of a coset in \(\smc{O}_{\mf{p}}/\mf{p}_{\mf{p}}^{n}\). As \(\d \notin \mf{p}\), what we have just proved shows that the coset represented by \(\d\) in \(\smc{O}/\mf{p}^{n}\) is invertible. Hence \(\frac{\a}{\d}\) represents a coset in \(\smc{O}/\mf{p^{n}}\) which proves surjectivity.
    \end{proof}
    
    A \textbf{discrete valuation ring}\index{discrete valuation ring} is a principal ideal domain with a unique maximal integral ideal (recall that principal ideal domains are necessarily noetherian integral domains). In other words, a discrete valuation ring is a local principal ideal domain and is a particularly simple example of a local noetherian integral domain. As principal ideal domains are integrally closed by \cref{lemma:unique_factorization_domains_are_integrally_closed}, discrete valuation rings are necessarily Dedekind domains. In fact, they are Dedekind domains with exactly one prime by \cref{prop:Dedekind_with_finite_primes_is_PID}. If \(\smc{O}\) is a discrete valuation ring and \(\mf{p}\) is its maximal integral ideal (necessarily prime) then \(\mf{p}\) is of the form \(\mf{p} = \pi\smc{O}\) for some prime \(\pi \in \smc{O}\). We call \(\pi\) a \textbf{uniformizer}\index{uniformizer} of \(\smc{O}\) and it is uniquely defined up to multiplication by units of \(\smc{O}\). As every element not in \(\mf{p}\) is a unit (since \(\smc{O}\) is local) and \(\smc{O}\) is a unique factorization domain (because it is a principal ideal domain), it follows that every \(\a \in \smc{O}\) is of the form \(\a = \e\pi^{n}\) for some \(\e \in \smc{O}^{\ast}\) and \(n \ge 0\). In particular, \(\pi\) is the only prime of \(\smc{O}\) up to multiplication by units and every integral ideal of \(\smc{O}\) is of the form \(\mf{p}^{n}\) for some \(n \ge 0\). As \(\smc{O}\) is a principal ideal domain, it follows that \(\mf{p}\) is also the only prime of \(\smc{O}\). Thus \(\mf{p}\) is both the unique maximal integral ideal and prime \(\smc{O}\). Moreover, if \(K\) is the field of fractions of \(\smc{O}\) then every nonzero \(\k \in K\) can be uniquely expressed as
    \[
      \k = \e\pi^{n},
    \]
    for some \(\e \in \smc{O}^{\ast}\) and \(n \in \Z\). The \textbf{valuation}\index{valuation} \(v\) associated to \(\smc{O}\) on \(K\) is the function defined by
    \[
      v:K \to \Z \cup \{\infty\} \qquad \k \mapsto v(\k) = \begin{cases} n & \text{if \(\k = \e\pi^{n}\)}, \\ \infty & \text{if \(\k = 0\)}. \end{cases}
    \]
    We call \(v(\k)\) the \textbf{valuation}\index{valuation} of \(\k\) with respect to \(\smc{O}\). Note that \(v(\k) = 0\) if and only if \(\k\) is a unit in \(\smc{O}\). If \(\k \neq 0\) then the \(v(\k)\) is characterized by the equation
    \begin{equation}\label{equ:valuation_characterization}
      \k\smc{O} = \mf{p}^{v(\k)},
    \end{equation}
    since \(\k = \e\pi^{v(\k)}\). Moreover, if \(\k = \e\pi^{n}\) and \(\eta = \d\pi^{m}\), we have
    \[
      \k\eta = \e\d\pi^{n+m} \quad \text{and} \quad \k+\eta = (\e\pi^{n-\min(n,m)}+\d\pi^{m-\min(n,m)})\pi^{\min(n,m)},
    \]
    where \(\e\pi^{n-\min(n,m)}+\d\pi^{m-\min(n,m)}\) is a unit of \(\smc{O}\) because one of the exponents of \(\pi\) is zero so that it is a sum of a unit of \(\smc{O}\) and an element of \(\mf{p}\). Therefore \(v\) satisfies the properties
    \begin{equation}\label{equ:valuation_properties}
      v(\k\eta) = v(\k)+v(\eta) \quad \text{and} \quad v(\k+\eta) \ge \min(v(\k),v(\eta)).
    \end{equation}
    In view of the first identity in \cref{equ:valuation_properties}, \(v\) restricted to \(K^{\ast}\) is a surjective homomorphism. Discrete valuation rings, and hence valuation themselves, arise as as localizations of Dedekind domains at primes. Before we deduce this, we will establish a few facts. The first is that localization respects inversion of fractional ideals:
    
    \begin{proposition}\label{prop:localization_of_inverse_is_inverse_of_localization}
      Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\) and \(D \subseteq \smc{O}-\{0\}\) be a multiplicative subset. Then for any fractional ideal \(\mf{f}\), we have
      \[
        \mf{f}^{-1}D^{-1} = (\mf{f}D^{-1})^{-1}.
      \]
    \end{proposition}
    \begin{proof}
      In light of the fact that every fractional ideal \(\mf{f}\) is of the form \(\mf{f} = \frac{1}{\d}\mf{a}\) for some nonzero \(\d \in \smc{O}\) and integral ideal \(\mf{a}\), we have \(\mf{f}^{-1} = \d\mf{a}^{-1}\) and so it suffices to prove the claim for integral ideals. We will show \(\mf{a}^{-1}D^{-1} = (\mf{a}D^{-1})^{-1}\). For the forward inclusion, let \(\frac{\a}{\d} \in \mf{a}^{-1}D^{-1}\). Since \(\a \in \mf{a}^{-1}\), \cref{prop:explicit_inverse_ideal} implies \(\a\mf{a} \subseteq \smc{O}\) and therefore \(\frac{\a}{\d}\mf{a}D^{-1} \subseteq \smc{O}D^{-1}\). Invoking \cref{prop:explicit_inverse_ideal} again shows \(\frac{\a}{\d} \in (\mf{a}D^{-1})^{-1}\) which proves the forward inclusion. For the reverse inclusion, suppose \(\k \in (\mf{a}D^{-1})^{-1}\). By \cref{prop:explicit_inverse_ideal}, \(\k\mf{a}D^{-1} \subseteq \smc{O}D^{-1}\) and multiplying by \(\mf{a}^{-1}\) shows \(\k \in \mf{a}^{-1}D^{-1}\) since \(\mf{a}\) is an ideal of \(\smc{O}\). This proves the reverse inclusion.
    \end{proof}

    Our second fact is that that the localization of a Dedekind domain is again a Dedekind domain:

    \begin{proposition}\label{prop:localization_of_Dedekind_is_Dedekind}
      Let \(\smc{O}\) be a Dedekind domain and \(D \subseteq \smc{O}-\{0\}\) be a multiplicative subset. Then \(\smc{O}D^{-1}\) is a Dedekind domain.
    \end{proposition}
    \begin{proof}
      We have seen that \(\smc{O}D^{-1}\) is a noetherian integral domain since \(\smc{O}\) is. \(\smc{O}D^{-1}\) is also integrally closed by \cref{prop:localization_of_integral_closure_is_integral_closure}. It remains to show that every prime of \(\smc{O}D^{-1}\) is maximal. Letting \(\mf{p}D^{-1}\) be such prime, we see that it must be maximal because \(\mf{p}\) is and the bijections in \cref{prop:localization_prime_bijection} are inclusion-preserving.
    \end{proof}

    As an immediate consequence of \cref{prop:localization_of_Dedekind_is_Dedekind}, the localization \(\smc{O}_{\mf{p}}\) at any prime \(\mf{p}\) is a Dedekind domain if \(\smc{O}\) is. We can now show that localizing a Dedekind domain at a prime produces a discrete valuation ring. Actually, we will prove the following stronger statement:

    \begin{theorem}\label{thm:Dedekind_if_and_only_if_all_localizations_are_discrete_valuation_rings}
      Let \(\smc{O}\) be a noetherian integral domain. Then \(\smc{O}\) is a Dedekind domain if and only if \(\smc{O}_{\mf{p}}\) is a discrete valuation ring for all primes \(\mf{p}\).
    \end{theorem}
    \begin{proof}
      Recall that \(\smc{O}_{\mf{p}}\) is local for any prime \(\mf{p}\) of \(\smc{O}\) and so \(\mf{p}_{\mf{p}}\) is the unique maximal integral ideal of \(\smc{O}_{\mf{p}}\). For the forward implication, suppose \(\smc{O}\) is a Dedekind domain. Then \(\smc{O}_{\mf{p}}\) is as well by \cref{prop:localization_of_Dedekind_is_Dedekind}. Since primes are maximal in Dedekind domains, \(\mf{p}_{\mf{p}}\) is also the only prime of \(\smc{O}_{\mf{p}}\). By uniqueness of prime factorizations of fractional ideals, there exists \(\pi \in \mf{p}_{\mf{p}}-\mf{p}_{\mf{p}}^{2}\) and hence \(\mf{p}_{\mf{p}} = \pi\smc{O}_{\mf{p}}\) which further implies \(\mf{p}_{\mf{p}}^{n} = \pi^{n}\smc{O}_{\mf{p}}\) for all \(n \ge 1\). As these are the only integral ideals of \(\smc{O}_{\mf{p}}\), we see that \(\smc{O}_{\mf{p}}\) is a principal ideal domain and hence a discrete valuation ring. This proves the forward implication. For the reverse implication, suppose all of the localizations \(\smc{O}_{\mf{p}}\) are discrete valuation rings. Then they are principal ideal domains and hence integrally closed by \cref{lemma:unique_factorization_domains_are_integrally_closed}. As the intersection of integrally closed rings is clearly integrally closed, it follows from \cref{prop:ring_is_intersection_of_all_localizations} that \(\smc{O}\) is integrally closed and therefore an integrally closed integral domain by our assumptions. As \(\smc{O}\) is noetherian by assumption, it remains to show that every prime \(\mf{q}\) of \(\smc{O}\) is maximal. Since \(\smc{O}\) is noetherian (which we recall is equivalent to every nonempty collection of ideals having a maximal element), \(\mf{q} \subseteq \mf{p}\) for some maximal integral ideal \(\mf{p}\) which is necessarily prime. Under the inclusion-preserving bijections in \cref{prop:localization_prime_bijection}, we have
      \[
        \mf{q} = \mf{q}_{\mf{p}} \cap \smc{O} = \mf{p}_{\mf{p}} \cap \smc{O} = \mf{p},
      \]
      where the middle equality holds because \(\mf{q}_{\mf{p}} = \mf{p}_{\mf{p}}\) as \(\smc{O}_{\mf{p}}\) has a unique prime which is also the unique maximal integral ideal as we have seen. Hence \(\mf{q}\) itself must be maximal.
    \end{proof}

    \cref{prop:ring_is_intersection_of_all_localizations,thm:Dedekind_if_and_only_if_all_localizations_are_discrete_valuation_rings} together form a powerful simplification tool for Dedekind domains \(\smc{O}\). For if we want to prove a property about a fractional ideal \(\mf{f}\) of \(\smc{O}\), \cref{prop:ring_is_intersection_of_all_localizations} implies that it suffices to show this property holds for the corresponding fractional ideals \(\mf{f}_{\mf{p}}\) in the localizations \(\smc{O}_{\mf{p}}\) at all primes \(\mf{p}\) and is preserved under intersections. Moreover, the localizations \(\smc{O}_{\mf{p}}\) are discrete valuation rings by \cref{thm:Dedekind_if_and_only_if_all_localizations_are_discrete_valuation_rings} in addition to being Dedekind domains by \cref{prop:localization_of_Dedekind_is_Dedekind}. In particular, the localizations \(\smc{O}_{\mf{p}}\) are also principal ideal domains. This latter fact is often immensely helpful. In any case, let \(v_{\mf{p}}\) denote the valuation of \(\smc{O}_{\mf{p}}\). We call \(v_{\mf{p}}\) the \textbf{valuation}\index{valulation} associated to the prime \(\mf{p}\) of \(\smc{O}\). These valuations are intimately connected to the prime factorization of principal fractional ideals. Indeed, the prime factorization of fractional ideals implies that for any \(\k \in K^{\ast}\), we have
    \[
      \k\smc{O} = \prod_{\text{\(\mf{q}\) prime}}\mf{q}^{e_{\mf{q}}},
    \]
    where the product is taken over all primes \(\mf{q}\) of \(\smc{O}\), \(e_{\mf{q}} \in \Z\) for all \(\mf{q}\), and all but finitely many of the \(e_{\mf{q}}\) are zero. We claim that \(v_{\mf{p}}(\k) = e_{\mf{p}}\) for all primes \(\mf{p}\). To see this, first observe that if \(\mf{p}\) and \(\mf{q}\) are distinct primes then we have \(\mf{q}_{\mf{p}} = \smc{O}_{\mf{p}}\). Indeed, by uniqueness of prime factorizations of fractional ideals choose \(\a \in \mf{q}-\mf{p}\). Then \(\a \in \mf{q}_{\mf{p}}-\mf{p}_{\mf{p}}\) and hence \(\a\) is invertible in \(\smc{O}_{\mf{p}}\) because \(\smc{O}_{\mf{p}}^{\ast} = \smc{O}_{\mf{p}}-\mf{p}_{\mf{p}}\). Therefore \(1 \in \mf{q}_{\mf{p}}\) and so the integral ideal \(\mf{q}_{\mf{p}}\) must be \(\smc{O}_{\mf{p}}\). This fact and the prime factorization of \(\k\smc{O}\) together imply
    \[
      \k\smc{O}_{\mf{p}} = \mf{p}_{\mf{p}}^{e_{\mf{p}}},
    \]
    and we readily see that \(v_{\mf{p}}(\k) = e_{\mf{p}}\) by \cref{equ:valuation_characterization}. In particular, \(v_{\mf{p}}(\k) = 0\) for all but finitely many primes \(\mf{p}\).

    \begin{remark}
      The valuation \(v_{\mf{p}}\) associated to the prime \(\mf{p}\) of \(\smc{O}\) is sometimes called an \textbf{exponential valuation}\index{exponential valuation}.
    \end{remark}

    Continue to let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\) and let \(X\) be a set of all but finitely many primes of \(\smc{O}\). Then \(\smc{O}(X)\) is a Dedekind domain by \cref{prop:localization_of_Dedekind_is_Dedekind} and by \cref{prop:localization_prime_bijection} the primes \(\mf{p}_{X}\) of \(\smc{O}(X)\) are of the form \(\mf{p}_{X} = \mf{p}(X)\) for \(\mf{p} \in X\). Moreover, \(\smc{O}\) and \(\smc{O}(X)\) have the same localizations at \(\mf{p}\) and \(\mf{p}_{X}\) respectively. That is,
    \begin{equation}\label{equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes}
      \smc{O}_{\mf{p}} = \smc{O}(X)_{\mf{p}_{X}}.
    \end{equation}
    Indeed, observe that
     \[
      \smc{O}(X)_{\mf{p}_{X}} = \left\{\frac{\a\g}{\b\d} \in K:\a,\b,\g,\d \in \smc{O} \text{ with } \d \not\equiv 0 \tmod{\mf{p}} \text{ and } \b,\g \not\equiv 0 \tmod{\mf{q}} \text{ for some } \mf{p},\mf{q} \in X\right\},
     \]
     which is exactly \(\smc{O}_{\mf{p}}\). From \cref{equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes} and the fact that the primes \(\mf{p}_{X}\) are the only primes of \(\smc{O}(X)\), the prime factorization of a fractional ideal \(\mf{f}(X)\) of \(\smc{O}(X)\), for a fractional ideal \(\mf{f}\) of \(\smc{O}\), is obtained from that of \(\mf{f}\) by removing those primes factors corresponding to primes not in \(X\). Also, from \cref{prop:ring_is_intersection_of_all_localizations,equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes} we conclude that the original fractional ideal can be recovered by taking the intersections of \(\mf{f}(X)_{\mf{p}}\) for all \(\mf{p} \notin X\). Moreover, the ideal class and unit groups of \(\smc{O}(X)\) are related to those of \(\smc{O}\) via the following exact sequence:

     \begin{proposition}\label{prop:ideal_class_group_localization_exact_sequence}
      Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\) and let \(X\) be set of all but finitely many primes of \(\smc{O}\). Then the sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & \smc{O}^{\ast} \arrow{r} & \smc{O}(X)^{\ast} \arrow{r} & \displaystyle{\bigop_{\mf{p} \notin X}K^{\ast}/\smc{O}_{\mf{p}}^{\ast}} \arrow{r}{\displaystyle{\prod_{\mf{p} \notin X}\mf{p}^{v_{\mf{p}}}}} & \Cl(\smc{O}) \arrow{r}{\smc{O}(X)} & \Cl(\smc{O}(X)) \arrow{r} & 1,
        \end{tikzcd}
      \end{center}

      where the fourth map takes the representative \((\k_{\mf{p}})_{\mf{p} \notin X}\) of a coset in \(\bigop_{\mf{p} \notin X}K^{\ast}/\smc{O}_{\mf{p}}^{\ast}\) to the coset represented by \(\prod_{\mf{p} \notin X}\mf{p}^{v_{\mf{p}}(\k_{\mf{p}})}\) in \(\Cl(\smc{O})\) and the fifth map takes the representative \(\mf{a}\) of an ideal class in \(\Cl(\smc{O})\) to the ideal class represented by \(\mf{a}(X)\) in \(\Cl(\smc{O}(X))\), is exact. Moreover, \(K^{\ast}/\smc{O}_{\mf{p}}^{\ast} \cong \Z\) for all primes \(\mf{p}\) of \(\smc{O}\).
    \end{proposition}
    \begin{proof}
      The sequence is exact at \(\smc{O}^{\ast}\) because the second map is injective. For exactness at \(\smc{O}(X)^{\ast}\), it is clear that the image of the second map belongs to the kernel of the third map. So suppose \(\a \in \smc{O}(X)^{\ast}\) belongs to the kernel of the third map. Then \(\a \in \smc{O}_{\mf{p}}^{\ast}\) for all \(\mf{p} \notin X\) and for all \(\mf{p} \in X\) as well by \cref{equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes}. It follows from \cref{prop:ring_is_intersection_of_all_localizations} that \(\a \in \smc{O}^{\ast}\) so it is in the image of the second map which proves exactness at \(\smc{O}(X)^{\ast}\). For exactness at \(\bigop_{\mf{p} \notin X}K^{\ast}/\smc{O}_{\mf{p}}^{\ast}\), from \cref{equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes} again we see that the image of the third map is contained in the kernel of the fourth. So suppose \((\k_{\mf{p}})_{\mf{p} \notin X}\) is a representative of a coset in \(\bigop_{\mf{p} \notin X}K^{\ast}/\smc{O}_{\mf{p}}^{\ast}\) that is contained in the kernel of the fourth map. Then there is a \(\k \in K^{\ast}\) such that
      \[
        \prod_{\mf{p} \notin X}\mf{p}^{v_{\mf{p}}(\k_{\mf{p}})} = \k\smc{O} = \prod_{\mf{p}}\mf{p}^{v_{\mf{p}}(\k)}.
      \]
      By the prime factorization of fractional ideals, \(v_{\mf{p}}(\k) = 0\) for all \(\mf{p} \in X\) and \(v_{\mf{p}}(\k) = v_{\mf{p}}(\k_{\mf{p}})\) for all \(\mf{p} \notin X\). As \(v_{\mf{p}}(\k) = 0\) for all \(\mf{p} \in X\), we have \(\k \in \smc{O}_{\mf{p}}^{\ast}\) for all \(\mf{p} \in X\). Because the primes of \(\smc{O}(X)\) are \(\mf{p}_{X}\) for \(\mf{p} \in X\), \cref{equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes,prop:ring_is_intersection_of_all_localizations} together imply that \(\bigcap_{\mf{p} \in X}\smc{O}_{\mf{p}}^{\ast} = \smc{O}(X)^{\ast}\) and therefore \(\k \in \smc{O}(X)^{\ast}\). As \(v_{\mf{p}}(\k) = v_{\mf{p}}(\k_{\mf{p}})\) for all \(\mf{p} \notin X\), we have \(\k \equiv \k_{\mf{p}} \tmod{\smc{O}_{\mf{p}}^{\ast}}\) for all \(\mf{p} \notin X\) because they have the same power of a uniformizer for \(\smc{O}_{\mf{p}}^{\ast}\). We have shown that \(\k \in \smc{O}(X)^{\ast}\) and \(\k \equiv \k_{\mf{p}} \tmod{\smc{O}_{\mf{p}}^{\ast}}\) for all \(\mf{p} \notin X\) which means \(\k\) maps to \((\k_{\mf{p}})_{\mf{p} \notin X}\) under the third map. In other words, \((\k_{\mf{p}})_{\mf{p} \notin X}\) is in the image of the third map proving exactness at \(\bigop_{\mf{p} \notin X}K^{\ast}/\smc{O}_{\mf{p}}^{\ast}\). For exactness at \(\Cl(\smc{O})\), we first show that \(\mf{p}(X) = \smc{O}(X)\) for any prime \(\mf{p} \notin X\). Indeed, by maximality we can choose \(\a \in \mf{p}-\bigcup_{\mf{q} \in X}\mf{q}\). This fores \(\a\) to be invertible in \(\smc{O}(X)\) so that \(1 \in \mf{p}(X)\) and hence the ideal \(\mf{p}(X)\) must be \(\smc{O}(X)\). It follows that the image of the fourth map is contained in the kernel of the fifth. Now suppose \(\mf{a}\) is an integral ideal representing a class in \(\Cl(\smc{O})\) that is contained in the kernel of the fifth map. Then there is a \(\k \in K^{\ast}\) such that
      \[
        \mf{a}(X) = \k\smc{O}(X),
      \]
      In view of \cref{equ:localizing_at_primes_for_X_is_the_same_as_localizing_at_primes,prop:ring_is_intersection_of_all_localizations} again, taking the intersection with the localizations \(\smc{O}_{\mf{p}}\) for all \(\mf{p} \notin X\) shows that
      \[
        \mf{a} = \k\smc{O}.
      \]
      Therefore \((v_{\mf{p}}(\k))_{\mf{p} \notin X}\) is a representative of a coset in \(\bigop_{\mf{p} \notin X}K^{\ast}/\smc{O}_{\mf{p}}^{\ast}\) whose image under the fourth map is \(\mf{a}\). In other words, \(\mf{a}\) is in the image of the third map proving exactness at \(\Cl(\smc{O})\). Lastly, to show exactness \(\Cl(\smc{O}(X))\) recall that every ideal class can be represented by an integral ideal and that the primes \(\mf{p}_{X}\) of \(\smc{O}(X)\) are of the form \(\mf{p}_{X} = \mf{p}(X)\) for \(\mf{p} \in X\). Then the fifth map is surjective since the primes of \(\smc{O}\) and \(\smc{O}(X)\) generate their corresponding ideal class groups by the prime factorization of fractional ideals. Therefore exactness holds at \(\Cl(\smc{O}(X))\) which completes exactness of the sequence. The last statement follows from the first isomorphism theorem since the valuation \(v_{\mf{p}}\) restricted to \(K^{\ast}\) is a surjective homomorphism and the kernel is precisely the set of units of \(\smc{O}_{\mf{p}}\). This completes the proof.
    \end{proof}

    We now turn to the setting of a number field \(K\). We let \(S\) denote a finite set of primes of \(\mc{O}_{K}\) and let \(X\) denote the set of all primes that do not belong to \(S\). The \textbf{ring of \(S\)-integers}\index{ring of \(S\)-integers} \(\mc{O}_{K}^{S}\) of \(K\) is defined by
    \[
      \mc{O}_{K}^{S} = \mc{O}_{K}(X).
    \]
    We call any \(\a \in \mc{O}_{K}^{S}\) an \textbf{algebraic \(S\)-integer}\index{algebraic \(S\)-integer}. The \textbf{\(S\)-class group}\index{\(S\)-class group} \(\Cl^{S}(K)\) of \(K\) is the ideal class group of \(\mc{O}_{K}^{S}\). The \textbf{\(S\)-class number}\index{\(S\)-class number} \(h_{K}^{S}\) of \(K\) is the class number of \(\Cl^{S}(K)\). The \textbf{\(S\)-unit group}\index{\(S\)-unit group} of \(K\) is the unit group \((\mc{O}_{K}^{S})^{\ast}\) of \(\mc{O}_{K}^{S}\) and we call any element of \((\mc{O}_{K}^{S})^{\ast}\) an \textbf{\(S\)-unit}\index{\(S\)-unit} of \(K\).
  \section{Dedekind Extensions}
    Having discussed the prime factorization of fractional ideals in Dedekind domains, we now turn to discussing how primes factor when considered in a larger Dedekind domain. Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(\mc{O}\) be the integral closure of \(\smc{O}\) in \(L\). We first show that \(\mc{O}\) is also a Dedekind domain:

    \begin{proposition}\label{prop:integral_closure_of_Dedekind_is_Dedekind}
      Let \(\smc{O}\) be a Dedekind domain with field of fractions \(K\), \(L/K\) be a finite separable extension, and \(\mc{O}\) be the integral closure of \(\smc{O}\) in \(L\). Then \(\mc{O}\) is a Dedekind domain.
    \end{proposition}
    \begin{proof}
      \(\mc{O}\) is an integral domain because it is a subring of \(L\) and is integrally closed since it is the integral closure of \(\smc{O}\). We now show \(\mc{O}\) is noetherian. Let the degree of \(L/K\) be \(n\) and let \(\l_{1},\ldots,\l_{n}\) be a basis for \(L/K\). By \cref{prop:field_of_fractions_AKBL} we may multiply by a nonzero element of \(\smc{O}\), if necessary, to ensure that this basis is contained in \(\mc{O}\). Then \(d_{L/K}(\l_{1},\ldots,\l_{n})\) is nonzero by \cref{prop:discriminant_not_zero} and \cref{lem:lemma_for_integral_basis_AKBL} implies that
      \[
        d_{L/K}(\l_{1},\ldots,\l_{n})\mc{O} \subseteq \smc{O}\l_{1}+\cdots+\smc{O}\l_{n}.
      \]
      Thus \(\mc{O}\) is a finitely generated \(\smc{O}\)-module of rank at most \(n\). In particular, every ideal of \(\mc{O}\) is also a finitely generated \(\smc{O}\)-module and therefore also a finitely generated \(\mc{O}\)-module. It remains to show that every nonzero prime ideal is maximal. Letting \(\mf{P}\) be a nonzero prime ideal, it suffices to show \(\mc{O}/\mf{P}\) is a field. To this end, consider the homomorphism
      \[
        \phi:\smc{O} \to \mc{O}/\mf{P} \qquad \a \mapsto \a+\mf{p}.
      \]
      Then \(\ker\phi = \mf{P} \cap \smc{O}\) and we claim \(\mf{P} \cap \smc{O}\) is a nonzero prime ideal of \(\smc{O}\). It is clearly an ideal of \(\smc{O}\) and is prime because \(\mf{P}\) is. To see that it is nonzero, let \(\a \in \mf{P}\) be nonzero. As \(\a\) is algebraic over \(\smc{O}\), we have
      \[
        \a^{n}+a_{n-1}\a^{n-1}+\cdots+a_{0} = 0,
      \]
      for some \(n \ge 1\) and \(a_{i} \in \smc{O}\) for \(0 \le i \le n-1\). Taking \(n\) minimal, we have \(a_{0} \neq 0\). Isolating \(a_{0}\) shows that \(a_{0} \in \mf{P}\) and hence \(a_{0} \in \mf{P} \cap \smc{O}\). Therefore \(\mf{P} \cap \smc{O} = \mf{p}\) for some prime \(\mf{p}\). Hence \(\ker\phi = \mf{p}\) and by the first isomorphism theorem, \(\phi\) induces an injection \(\phi:\F_{\mf{p}} \to \mc{O}/\mf{P}\). As \(\mc{O}\) is the integral closure of \(\smc{O}\) in \(L\), it is obtained from \(\smc{O}\) by forming a polynomial ring with algebraic elements in \(L\). The latter injection then shows that \(\mc{O}/\mf{P}\) is obtained from \(\F_{\mf{p}}\) by adjoining these algebraic elements reduced modulo \(\mf{P}\). Their reductions are seen to be algebraic over \(\F_{\mf{p}}\) by reducing their minimal polynomials over \(K\), viewed as elements of \(\mc{O}[x]\), modulo \(\mf{P}\) upon recalling that the coefficients of which are in \(\smc{O}\) by \cref{prop:field_of_fractions_AKBL}. Hence \(\mc{O}/\mf{P}\) is obtained from \(\F_{\mf{p}}\) by adjoining algebraic elements to \(\F_{\mf{p}}\) (since \(\F_{\mf{p}}[\conj{\a}] = \F_{\mf{p}}(\conj{\a})\) if \(\conj{\a}\) is algebraic over \(\F_{\mf{p}}\)) and is therefore a field.
    \end{proof}

    Under the assumptions of \cref{prop:integral_closure_of_Dedekind_is_Dedekind}, it follows from \cref{prop:field_of_fractions_AKBL} that \(L\) is the field of fractions of \(\mc{O}\). We say that a ring extension \(\mc{O}/\smc{O}\) is a \textbf{Dedekind extension}\index{Dedekind extension} of a finite separable extension \(L/K\) if \(\mc{O}\) and \(\smc{O}\) are Dedekind domains whose field of fractions are \(L\) and \(K\) respectively and \(\mc{O}\) is the integral closure of \(\smc{O}\) in \(L\). This immediately implies
    \[
      \mc{O} \cap K = \smc{O}.
    \]
    Moreover, if \(\mc{O}\) is also a free \(\smc{O}\)-module then \(\mc{O}/\smc{O}\) admits an integral basis. In light of \cref{prop:localization_of_Dedekind_is_Dedekind}, \(\mc{O}D^{-1}/\smc{O}D^{-1}\) is also a Dedekind extension of \(L/K\) for any multiplicative subset \(D \subseteq \smc{O}-\{0\}\). We call \(\mc{O}D^{-1}/\smc{O}D^{-1}\) the \textbf{localization}\index{localization} of \(\mc{O}/\smc{O}\) at \(D\). In the case \(D = \smc{O}-\mf{p}\) for a prime \(\mf{p}\) of \(\smc{O}\), we call \(\mc{O}_{\mf{p}}/\smc{O}_{\mf{p}}\) the \textbf{localization}\index{localization} of \(\mc{O}/\smc{O}\) at \(\mf{p}\). We say that a Dedekind extension \(\mc{O}/\smc{O}\) is \textbf{local}\index{local} if \(\smc{O}\) is a discrete valuation ring. As \(\smc{O}\) is a principal ideal domain, \cref{thm:integral_basis_AKBL} implies that \(\mc{O}/\smc{O}\) admits an integral basis if it is local. In addition, as \(\smc{O}\) has a unique prime we see that \(\mc{O}\) has finitely many primes since they all must be above the prime of \(\smc{O}\). By \cref{prop:Dedekind_with_finite_primes_is_PID} this forces \(\mc{O}\) to be a principal ideal domain as well. In particular, localizing the Dedekind extension \(\mc{O}/\smc{O}\) at \(\mf{p}\) produces the local Dedekind extension \(\mc{O}_{\mf{p}}/\smc{O}_{\mf{p}}\). With this phrasing, the proof of \cref{prop:integral_closure_of_Dedekind_is_Dedekind} gives the following corollary:

    \begin{corollary}\label{cor:integral_closure_of_Dedekind_is_Dedekind}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\). Then \(\mc{O}\) is a finitely generated \(\smc{O}\)-module of rank at most \(n\) and every prime \(\mf{P}\) of \(\mc{O}\) satisfies
      \[
        \mf{P} \cap \smc{O} = \mf{p},
      \]
      for some prime \(\mf{p}\) of \(\smc{O}\). Moreover, \(\F_{\mf{P}}/\F_{\mf{p}}\) is a finite extension of degree at most \(n\).
    \end{corollary}
    \begin{proof}
      The first statement was deduced in the proof of \cref{prop:integral_closure_of_Dedekind_is_Dedekind} along with the fact that there is an injection \(\F_{\mf{p}} \to \F_{\mf{P}}\). From this injection it follows that \(\F_{\mf{P}}/\F_{\mf{p}}\) is an extension and since \(\mc{O}\) is a finitely generated \(\smc{O}\)-module of rank at most \(n\), \(\F_{\mf{P}}/\F_{\mf{p}}\) has degree at most \(n\).
    \end{proof}

    Continue to let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\). Note that if \(\mf{f}\) is a fractional ideal of \(\smc{O}\) then \(\mf{f}\mc{O}\) is a fractional ideal of \(\mc{O}\) because \(\mf{f}\) is a finitely generated \(\smc{O}\)-module and hence a finitely generated \(\mc{O}\)-module. In particular, \(\mf{a}\mc{O}\) is an integral ideal of \(\mc{O}\) for any integral ideal \(\mf{a}\) of \(\smc{O}\). Now let \(\mf{P}\) and \(\mf{p}\) be primes of \(\mc{O}\) and \(\smc{O}\) respectively. We say that \(\mf{P}\) is \textbf{above}\index{above} \(\mf{p}\), or equivalently, \(\mf{p}\) is \textbf{below}\index{below} \(\mf{P}\) if
    \[
      \mf{P} \cap \smc{O} = \mf{p}.
    \]
    Then \cref{cor:integral_closure_of_Dedekind_is_Dedekind} implies that every prime of \(\mc{O}\) is above exactly one prime of \(\smc{O}\). If \(\mf{P}\) is above \(\mf{p}\) then \(\mf{P} \mid \mf{p}\mc{O}\). Indeed, since \(\mf{p} \subseteq \mf{P}\) we have \(\mf{p}\mc{O} \subseteq \mf{P}\) which is to say that \(\mf{P}\) divides \(\mf{p}\mc{O}\). This implies that only finitely many primes \(\mf{P}\) can lie above a prime \(\mf{p}\) and they are exactly the prime factors of \(\mf{p}\mc{O}\). Moreover, every prime of \(\smc{O}\) is below at least one prime of \(\mc{O}\). To see this, it suffices to show that the integral ideal \(\mf{p}\mc{O}\) satisfies
    \[
      \mf{p}\mc{O} \neq \mc{O}.
    \]
    By the prime factorization of fractional ideals, choosing \(\a \in \mf{p}-\mf{p}^{2}\) we can write \(\a\smc{O} = \mf{p}\mf{a}\) for some integral ideal \(\mf{a}\) relatively prime to \(\mf{p}\). Then \(\mf{a}+\mf{p} = \smc{O}\) and so there exist \(\b \in \mf{a}\) and \(\g \in \mf{p}\) such that \(\b+\g = 1\). Then \(\b\mf{p} \subseteq \a\smc{O}\) and \(\b \notin \mf{p}\) because otherwise \(1 \in \mf{p}\) which is absurd since \(\mf{p}\) is proper. Now if \(\mf{p}\mc{O} = \mc{O}\), it would follow that \(\b\mc{O} \subseteq \a\mc{O}\) which would imply \(\b = \a\d\) for some \(\d \in \mc{O}\). Hence \(\d = \frac{\b}{\a} \in K\) because \(K\) is the field of fractions of \(\smc{O}\). As \(\mc{O} \cap K = \smc{O}\), we also find that \(\d \in \smc{O}\). But since \(\a \in \mf{p}\), it follows that \(\b \in \mf{p}\) which is a contraction. Therefore \(\mf{p}\mc{O} \neq \mc{O}\). In addition, we have
    \[
      \mf{p}\mc{O} \cap \smc{O} = \mf{p}.
    \]
    The reverse inclusion is obvious. For the forward inclusion, as \(\mf{p}\mc{O} \neq \mc{O}\) there exists a prime factor \(\mf{P}\) of \(\mf{p}\mc{O}\) so that \(\mf{p}\mc{O} \subseteq \mf{P}\). But then \(\mf{P}\) is above \(\mf{p}\) so that \(\mf{P} \cap \smc{O} = \mf{p}\) and the forward inclusion follows since \(\mf{p}\mc{O} \subseteq \mf{P}\). We illustrate the relationship between \(\mf{P}\) and \(\mf{p}\) via the following extension:

    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mf{P} \subset \mc{O} \subseteq L \arrow[dash]{d} \\
        \mf{p} \subset \smc{O} \subseteq K.
      \end{tikzcd}
    \end{center}

    We have the residue class fields \(\F_{\mf{P}}\) and \(\F_{\mf{p}}\). The former is a finite extension of the latter of degree at most \(n\) by \cref{cor:integral_closure_of_Dedekind_is_Dedekind}. Accordingly, we call \(\F_{\mf{P}}/\F_{\mf{p}}\) the \textbf{residue class extension}\index{residue class extension} of \(\mc{O}/\smc{O}\) for \(\mf{P}\). Actually since \cref{cor:integral_closure_of_Dedekind_is_Dedekind} implies \(\mc{O}\) is at finitely generated \(\smc{O}\)-module of rank at most \(n\), the quotient ring \(\mf{B}/\mf{A}\) is a \(\F_{\mf{p}}\)-vector space of dimension at most \(n\) for any integral ideals \(\mf{A}\) and \(\mf{B}\) with \(\mf{p} \subseteq \mf{A} \subseteq \mf{B}\). In any case, we define the \textbf{inertia degree}\index{inertia degree} \(f_{\mf{p}}(\mf{P})\) of \(\mf{P}\) relative to \(\mf{p}\) by
    \[
      f_{\mf{p}}(\mf{P}) = [\F_{\mf{P}}:\F_{\mf{p}}].
    \]
    That is, \(f_{\mf{p}}(\mf{P})\) is the dimension of the residue field \(\F_{\mf{P}}\) as a \(\F_{\mf{p}}\)-vector space. The \textbf{ramification index}\index{ramification index} \(e_{\mf{p}}(\mf{P})\) is the power of \(\mf{P}\) appearing in the prime factorization of \(\mf{p}\mc{O}\). If \(\mf{p}\mc{O}\) has prime factors \(\mf{P}_{1},\ldots,\mf{P}_{r}\) then the prime factorization of \(\mf{p}\mc{O}\) is
    \[
      \mf{p}\mc{O} = \mf{P}_{1}^{e_{\mf{p}}(\mf{P}_{1})} \cdots \mf{P}_{r}^{e_{\mf{p}}(\mf{P}_{r})}.
    \]
    All of this is preserved under localization as the following proposition shows:

    \begin{proposition}\label{prop:ramification_setup_respects_localization}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a finite separable extension \(L/K\) and let \(D \subseteq \smc{O}-\{0\}\) be a multiplicative subset. Then for the Dedekind extension \(\mc{O}D^{-1}/\smc{O}D^{-1}\), \(\mf{P}D^{-1}\) is above \(\mf{p}D^{-1}\) if and only if \(\mf{P}\) is above \(\mf{p}\). Moreover, there are isomorphisms
      \[
        \F_{\mf{P}D^{-1}} \cong \F_{\mf{P}} \quad \text{and} \quad \F_{\mf{p}D^{-1}} \cong \F_{\mf{p}}.
      \]
      Lastly, we have equalities
      \[
        f_{\mf{p}D^{-1}}(\mf{P}D^{-1}) = f_{\mf{p}}(\mf{P}) \quad \text{and} \quad e_{\mf{p}D^{-1}}(\mf{P}D^{-1}) = e_{\mf{p}}(\mf{P}).
      \]
    \end{proposition}
    \begin{proof}
      Note that \(\mf{P}\) and \(\mf{p}\) are necessarily primes disjoint from \(D\). On the one hand, suppose \(\mf{P}\) is above \(\mf{p}\). Then \(\mf{P} \cap \smc{O} = \mf{p}\) and applying the first bijection in \cref{prop:localization_prime_bijection} gives
      \[
        \mf{P}D^{-1} \cap \smc{O}D^{-1} = \mf{p}D^{-1}.
      \]
      Hence \(\mf{P}D^{-1}\) is above \(\mf{p}D^{-1}\). On the other hand, suppose \(\mf{P}D^{-1}\) is above \(\mf{p}D^{-1}\). Then \(\mf{P}D^{-1} \cap \smc{O}D^{-1} = \mf{p}D^{-1}\) and applying the second bijection in \cref{prop:localization_prime_bijection} gives
      \[
        \mf{P} \cap \smc{O} = \mf{p}.
      \]
      (recall \(\smc{O} \subseteq \mc{O}\)) so that \(\mf{P}\) is above \(\mf{p}\). This proves the first statement. For the second statement, consider the homomorphisms
      \[
        \Phi:\F_{\mf{P}} \to \F_{\mf{P}D^{-1}} \qquad \a+\mf{P} \mapsto \a+\mf{P}D^{-1},
      \]
      and
      \[
        \phi:\F_{\mf{p}} \to \F_{\mf{p}D^{-1}} \qquad \a+\mf{p} \mapsto \a+\mf{p}D^{-1}.
      \]
      Let \(\frac{\a}{\d}\) be a representative of a coset in \(\F_{\mf{P}D^{-1}}\) or \(\F_{\mf{p}D^{-1}}\) so that \(\a \in \mf{P}\) or \(\a \in \mf{p}\) respectively and \(\d \in D\). By \cref{prop:localization_prime_bijection}, \(D\) is disjoint from \(\mf{P}\) and \(\mf{p}\) and thus elements of \(D\) are invertible in \(\F_{\mf{P}}\) and \(\F_{\mf{p}}\). Then \(\frac{\a}{\d}\) represents a coset in \(\mf{P}\) or \(\mf{p}\) proving surjectivity. For injectivity, suppose \(\a\) is a representative of a coset in \(\F_{\mf{P}}\) or \(\F_{\mf{p}}\) that belongs to \(\ker\Phi\) or \(\ker\phi\) respectively. Then \(\a \in \mc{O} \cap \mf{P}D^{-1}\) or \(\a \in \smc{O} \cap \mf{p}D^{-1}\) which is to say that \(\a \in \mf{P}\) or \(\a \in \mf{p}\) by \cref{prop:localization_prime_bijection}. This means \(\a\) represents the zero class in \(\F_{\mf{P}}\) or \(\F_{\mf{p}}\) respectively and injectivity follows. Therefore \(\Phi\) and \(\phi\) are isomorphisms proving the second statement. In fact, these two isomorphisms together give
      \[
        f_{\mf{p}D^{-1}}(\mf{P}D^{-1}) = f_{\mf{p}}(\mf{P}),
      \]
      by the definition of the inertia degrees. Finally, we have
      \[
        e_{\mf{p}D^{-1}}(\mf{P}D^{-1}) = e_{\mf{p}}(\mf{P}),
      \]
      because the first statement implies that the prime factors of \(\mf{p}D^{-1}\mc{O}\) correspond to those of \(\mf{p}\mc{O}\) and hence their powers must be the same.
    \end{proof}

    Let us now introduce towers of Dedekind extensions. We say that \(\mc{O}'/\mc{O}/\smc{O}\) is a \textbf{tower}\index{tower} of Dedekind extensions for a finite separable tower of extensions \(M/L/K\) if \(\mc{O}'/\mc{O}\) and \(\mc{O}/\smc{O}\) are Dedekind extensions for \(M/L\) and \(L/K\) respectively. Now let \(\mf{P}'\), \(\mf{P}\), and \(\mf{p}\) be primes of \(\mc{O}'\), \(\mc{O}\), and \(\smc{O}\) respectively with \(\mf{P}'\) above \(\mf{P}\) and \(\mf{P}\) above \(\mf{p}\). Then we have the residue class field extensions \(\F_{\mf{P}'}/\F_{\mf{P}}\) and \(\F_{\mf{P}}/\F_{\mf{p}}\). Moreover, \(\mf{P}^{e_{\mf{p}}(\mf{P})} \mid\mid \mf{p}\mc{O}\) and \(\mf{P}^{e_{\mf{P}}(\mf{P}')} \mid\mid \mf{P}\mc{O}'\). Then
    \begin{equation}\label{equ:ramification_and_interia_towers}
      e_{\mf{p}}(\mf{P}') = e_{\mf{p}}(\mf{P})e_{\mf{P}}(\mf{P}') \quad \text{and} \quad f_{\mf{p}}(\mf{P}') = f_{\mf{p}}(\mf{P})f_{\mf{P}}(\mf{P}').
    \end{equation}
    In other words, the ramification indices and inertia degrees are multiplicative with respect to towers of field extensions. We illustrate this relationship via the following tower of extensions:

    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mf{P}' \subset \mc{O}' \subseteq M \arrow[dash]{d} \\
        \mf{P} \subset \mc{O} \subseteq L \arrow[dash]{d} \\
        \mf{p} \subset \smc{O} \subseteq K.
      \end{tikzcd}
    \end{center}
    
    The inertia degrees and ramification indices satisfy a simple relationship to the degree of \(L/K\). First, we will prove a useful lemma:

    \begin{lemma}\label{lem:quotient_by_prime_power_isomorphism}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\). Suppose \(\mf{P}\) is a prime above \(\mf{p}\). Then for any \(e \ge 1\), we have
      \[
        \mc{O}/\mf{P}^{e} \cong \bigop_{0 \le i \le e-1}\F_{\mf{P}}.
      \]
      In particular, the dimension of \(\mc{O}/\mf{P}^{e}\) as a \(\F_{\mf{p}}\)-vector space is \(ef_{\mf{p}}(\mf{P})\).
    \end{lemma}
    \begin{proof}
      Consider the descending chain
      \[
        \mc{O}/\mf{P}^{e} \supseteq \mf{P}/\mf{P}^{e} \supseteq \cdots \supseteq \mf{P}^{e-1}/\mf{P}^{e} \supseteq \mf{P}^{e}/\mf{P}^{e},
      \]
      of \(\F_{\mf{p}}\)-vector spaces. By the third isomorphism theorem, these quotients are of the form \(\mf{P}^{i}/\mf{P}^{i+1}\) for \(0 \le i \le e-1\) and are all isomorphic to \(\F_{\mf{P}}\) by \cref{lem:isomorphism_of_quotient_by_prime_integral_ideals}. Therefore we have a decomposition
      \[
        \mf{P}^{i}/\mf{P}^{e} \cong \F_{\mf{P}} \op (\mf{P}^{i+1}/\mf{P}^{e}),
      \]
      for all \(i\). Iteratively applying this isomorphism \(e-1\) times gives
      \[
        \mc{O}/\mf{P}^{e} \cong \bigop_{0 \le i \le e-1}\F_{\mf{P}}.
      \]
      This proves the first statement. Since the dimension of \(\F_{\mf{P}}\) as a \(\F_{\mf{p}}\)-vector space is \(f_{\mf{p}}(\mf{P})\) by definition, it follows that \(\mc{O}/\mf{P}^{e}\) is a \(\F_{\mf{p}}\)-vector space of dimension \(ef_{\mf{p}}(\mf{P})\). This proves the second statement.
    \end{proof}
    
    We now describe the relationship between inertia degrees and ramification indices which is known as the \textbf{fundamental equality}\index{fundamental equality}:

    \begin{theorem*}[Fundamental equality]
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\). Suppose \(\mf{p}\) is a prime of \(\smc{O}\) and \(\mf{p}\mc{O}\) has prime factorization
      \[
        \mf{p}\mc{O} = \mf{P}_{1}^{e_{\mf{p}}(\mf{P}_{1})} \cdots \mf{P}_{r}^{e_{\mf{p}}(\mf{P}_{r})}.
      \]
      Then
      \[
        n = \sum_{1 \le i \le r}e_{\mf{p}}(\mf{P}_{i})f_{\mf{p}}(\mf{P}_{i}).
      \]
    \end{theorem*}
    \begin{proof}
      Since distinct primes are relatively prime, the Chinese remainder theorem implies that
      \[
        \mc{O}/\mf{p}\mc{O} \cong \bigop_{1 \le i \le r} \mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}.
      \]
      As \(\mc{O}/\mf{p}\mc{O}\) and \(\mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}\) are \(\F_{\mf{p}}\)-vector spaces for all \(i\), it suffices to show \(\F_{\mf{P}}\) is of dimension \(n\) and \(\mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}\) is of dimension \(e_{\mf{p}}(\mf{P}_{i})f_{\mf{p}}(\mf{P}_{i})\) for all \(i\). For \(\mc{O}/\mf{p}\mc{O}\), we already know it is a \(\F_{\mf{p}}\)-vector space of dimension at most \(n\) (since \(\mc{O}\) is a finitely generated \(\smc{O}\)-module of rank at most \(n\) by \cref{cor:integral_closure_of_Dedekind_is_Dedekind} and \(\mf{p} \subseteq \mf{p}\mc{O}\)). Therefore we must show that the dimension is exactly \(n\). Let \(\conj{\l_{1}},\ldots,\conj{\l_{m}}\) be a basis for \(\mc{O}/\mf{p}\mc{O}\) as a \(\F_{\mf{p}}\)-vector space and let \(\l_{1},\ldots,\l_{m}\) be any lift of this basis to \(\mc{O}\). As \(m \le n\), it suffices to show \(\l_{1},\ldots,\l_{m}\) spans \(L/K\) and hence \(m = n\). Let \(M = \l_{1}\smc{O}+\cdots+\l_{m}\smc{O}\) and set \(N = \mc{O}/M\). Then \(\mc{O} = M+\mf{p}\mc{O}\) since \(\l_{1},\ldots,\l_{m}\) is a lift a basis for \((\mc{O}/\mf{p}\mc{O})/\F_{\mf{p}}\), and hence \(N = \mf{p}N\). As \(\mc{O}\) is a finitely generated \(\smc{O}\)-module of rank at most \(n\) by \cref{cor:integral_closure_of_Dedekind_is_Dedekind}, so is \(N\). So let \(\w_{1},\ldots,\w_{r}\) be generators. As \(N = \mf{p}N\), we have
      \[
        \w_{i} = \sum_{1 \le j \le r}\a_{i,j}\w_{j},
      \]
      for some \(\a_{i,j} \in \mf{p}\) for \(1 \le i,j \le r\). These \(r\) equations are equivalent to the identity
      \[
        ((\a_{i,j})_{i,j}-I)\begin{pmatrix} \w_{1} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
      \]
      Let \(d = \det((\a_{i,j})_{i,j}-I)\). Then \(d \neq 0\) because expanding the determinant shows \(d \equiv (-1)^{r} \tmod{\mf{p}}\) as \(\a_{i,j} \in \mf{p}\) for all \(i\) and \(j\). Multiplying on the left by the adjugate \(\adj(\a_{i,j})_{i,j}-I)\) of \((\a_{i,j})_{i,j}-I\) and recalling that a matrix times its adjugate is its determinant times the identity, we obtain
      \[
        d\begin{pmatrix} \w_{1} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
      \]
      Hence multiplication by \(d\) annihilates \(N\) which is to say that \(d\mc{O} \subseteq M\). Equivalently,
      \[
        d\mc{O} \subseteq \l_{1}\smc{O}+\cdots+\l_{m}\smc{O}.
      \]
      By \cref{prop:field_of_fractions_AKBL} and that \(d \neq 0\), multiplication by \(K\) shows \(L = \l_{1}K+\cdots+\l_{m}K\) (as the reverse containment is trivial). Hence \(\l_{1},\ldots,\l_{m}\) spans \(L/K\) so that \(m = n\) and \(\mc{O}/\mf{p}\mc{O}\) is a \(\F_{\mf{p}}\)-vector space of dimension \(n\). For \(\mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}\), the dimensionality claim follows from \cref{lem:quotient_by_prime_power_isomorphism}. So our dimension computations combine to give
      \[
        n = \sum_{1 \le i \le r}e_{\mf{p}}(\mf{P}_{i})f_{\mf{p}}(\mf{P}_{i}).
      \]
    \end{proof}

    We also classify primes according to extremal cases of the fundamental equality. We say \(\mf{p}\) is \textbf{inert}\index{inert} in \(\mc{O}/\smc{O}\) if \(r = 1\) so that there is a single prime \(\mf{P}\) above \(\mf{p}\) so that \(e_{\mf{p}}(\mf{P}) = 1\) and \(f_{\mf{p}}(\mf{P}) = n\) by the fundamental equality. Then
    \[
      \mf{p}\mc{O} = \mf{P},
    \]
    which means \(\mf{p}\mc{O}\) is prime. We say \(\mf{p}\) is \textbf{totally split}\index{totally split} in \(\mc{O}/\smc{O}\) if \(r = n\) so that there are primes \(\mf{P}_{i}\) above \(\mf{p}\) with \(e_{\mf{p}}(\mf{P}_{i}) = f_{\mf{p}}(\mf{P}_{i}) = 1\) for \(1 \le i \le n\) by the fundamental equality. Hence
    \[
      \mf{p}\mc{O} = \mf{P}_{1} \cdots \mf{P}_{n}.
    \]
    In terms of the inertia degrees, being inert or totally split in \(\mc{O}/\smc{O}\) are antithetical properties. In particular, the smaller the inertia degrees are the greater the tendency for \(\mf{p}\mc{O}\) to factor into distinct primes. Now let us introduce ramification. If \(\mf{P}\) is a prime of \(\mc{O}\) above \(\mf{p}\), we say that \(\mf{P}\) is \textbf{unramified}\index{unramified} in \(\mc{O}/\smc{O}\) if \(e_{\mf{p}}(\mf{P}) = 1\) and the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is separable. Otherwise, we say \(\mf{P}\) is \textbf{ramified}\index{ramified} in \(\mc{O}/\smc{O}\). Moreover, we say \(\mf{P}\) is \textbf{totally ramified}\index{totally ramified} in \(\mc{O}/\smc{O}\) if in addition to being ramified we have \(f_{\mf{p}}(\mf{P}) = 1\). Similarly, we say that a prime \(\mf{p}\) of \(\smc{O}\) is \textbf{unramified}\index{unramified} in \(\mc{O}/\smc{O}\) if every prime \(\mf{P}\) above it is unramified and is \textbf{ramified}\index{ramified} in \(\mc{O}/\smc{O}\) otherwise. The Dedekind extension \(\mc{O}/\smc{O}\) itself is said to be \textbf{unramified}\index{unramified} if every prime of \(\smc{O}\) is unramified in \(\mc{O}/\smc{O}\) and is said to be \textbf{ramified}\index{ramified} otherwise.

    \begin{remark}
      We will see that it is an exceptional phenomena for a prime \(\mf{p}\) of \(\smc{O}\) to ramify in \(\mc{O}/\smc{O}\). Therefore it is typical that \(\mf{p}\) is either inert or totally split in \(\mc{O}/\smc{O}\).
    \end{remark}

    Unfortunately, there is no general way to see how \(\mf{p}\mc{O}\) factors for an arbitrary Dedekind extension \(\mc{O}/\smc{O}\) of a finite separable extension \(L/K\). However, we can make some progress in this respect. Let \(\t\) be a primitive element for \(L/K\) so that \(L = K(\t)\). By \cref{prop:field_of_fractions_AKBL} we can multiply by a nonzero element of \(\smc{O}\), if necessary, to ensure that \(\t \in \mc{O}\) and hence its minimal polynomial \(m_{\t}(x)\) over \(K\) has coefficients in \(\smc{O}\). We then define the \textbf{conductor}\index{conductor} \(\mf{Q}_{\mc{O}/\smc{O}}\) of \(\mc{O}/\smc{O}\) relative to \(\t\) by
    \[
      \mf{Q}_{\mc{O}/\smc{O}} = \{\a \in \mc{O}:\a\mc{O} \subseteq \smc{O}[\t]\}.
    \]
    This is an integral ideal of \(\mc{O}\) provided it is nonzero. Since \(\mc{O}\) is a finitely generated \(\smc{O}\) module by \cref{cor:integral_closure_of_Dedekind_is_Dedekind}, let \(\w_{1},\ldots,\w_{r}\) be generators. As \(L/K\) is algebraic, \(\t\) is algebraic over \(K\) and hence \(L = K[\t]\). Then
    \[
      \w_{i} = \sum_{1 \le j \le r}\k_{i,j}\t^{j},
    \]
    with \(\k_{i,j} \in K\) for \(1 \le i,j \le r\). As \(K\) is the field of fractions of \(\smc{O}\), \(\k_{i,j} = \frac{\a_{i,j}}{\d_{i,j}}\) with \(\a_{i,j},\d_{i,j} \in \smc{O}\) for all \(i\) and \(j\). Setting \(\d = \prod_{1 \le i,j \le r}\d_{i,j}\), we have that \(\d\) is a nonzero element of \(\smc{O}\) (hence \(\mc{O}\) as well) with \(\d\w_{i} \in \smc{O}[\t]\) for all \(i\). As \(\w_{1},\ldots,\w_{r}\) generate \(\mc{O}\) as a \(\smc{O}\)-module, it follows that \(\d \in \mf{Q}_{\mc{O}/\smc{O}}\). Then \(\mf{Q}_{\mc{O}/\smc{O}}\) is an integral ideal of \(\mc{O}\) as claimed. The \textbf{Dedekind-Kummer theorem}\index{Dedekind-Kummer theorem} describes the factorization of \(\mf{p}\mc{O}\) provided it is relatively prime to the conductor \(\mf{Q}_{\mc{O}/\smc{O}}\):

    \begin{theorem*}[Dedekind-Kummer theorem]
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\), \(\t\) be a primitive element of \(L/K\) contained in \(\mc{O}\) with minimal polynomial \(m_{\t}(x)\) over \(K\), and \(\mf{p}\) be a prime of \(\smc{O}\) such that \(\mf{p}\mc{O}\) is relatively prime to \(\mf{Q}_{\mc{O}/\smc{O}}\). Suppose
      \[
        \conj{m_{\t}}(x) = \conj{m_{1}}(x)^{e_{1}} \cdots \conj{m_{r}}(x)^{e_{r}},
      \]
      is the prime factorization of \(\conj{m_{\t}}(x)\) in \(\F_{\mf{p}}[x]\). Let \(m_{i}(x)\) be any lift of \(\conj{m_{i}}(x)\) to \(\smc{O}[x]\) and set
      \[
        \mf{P}_{i} = \mf{p}\mc{O}+m_{i}(\t)\mc{O},
      \]
      for \(1 \le i \le r\). Then \(\mf{P}_{i}\) is a prime of \(\mc{O}\) for all \(i\),
      \[
        \mf{p}\mc{O} = \mf{P}_{1}^{e_{1}} \cdots \mf{P}_{r}^{e_{r}},
      \]
      is the prime factorization of \(\mf{p}\mc{O}\), and \(f_{\mf{p}}(\mf{P}_{i}) = \deg(\conj{m_{i}}(x))\) for all \(i\).
    \end{theorem*}
    \begin{proof}
      First consider the homomorphism
      \[
        \phi:\smc{O}[\t] \to \mc{O}/\mf{p}\mc{O} \qquad \a \mapsto \a+\mf{p}\mc{O}.
      \]
      We have \(\mf{p}\mc{O}+\mf{Q}_{\mc{O}/\smc{O}} = \mc{O}\) because \(\mf{p}\mc{O}\) is relatively prime to \(\mf{Q}_{\mc{O}/\smc{O}}\). As \(\mf{Q}_{\mc{O}/\smc{O}} \subseteq \smc{O}[\t]\), it follows that \(\mf{p}\mc{O}+\smc{O}[\t] = \mc{O}\) which shows \(\phi\) is surjective. Now \(\ker\phi = \smc{O}[\t] \cap \mf{p}\mc{O}\) and we claim \(\smc{O}[\t] \cap \mf{p}\mc{O} = \mf{p}\smc{O}[\t]\). The reverse inclusion is clear since \(\mf{p}\) is an integral ideal of \(\smc{O}\). For the forward inclusion, intersecting both sides of \(\mf{p}\mc{O}+\mf{Q}_{\mc{O}/\smc{O}} = \mc{O}\) with \(\smc{O}\) gives \(\mf{p} \cap \mf{Q}_{\mc{O}/\smc{O}} = \smc{O}\) because \(\mf{p}\mc{O} \cap \smc{O} = \mf{p}\). Hence
      \[
        \smc{O}[\t] \cap \mf{p}\mc{O} = (\mf{p} \cap \mf{Q}_{\mc{O}/\smc{O}})(\smc{O}[\t] \cap \mf{p}\mc{O}) = (\mf{p}\smc{O}[\t] \cap \mf{p}\mc{O})+(\mf{Q}_{\mc{O}/\smc{O}}\smc{O}[\t] \cap \mf{Q}_{\mc{O}/\smc{O}}\mf{p}\mc{O}) \subseteq \mf{p}\smc{O}[\t],
      \]
      where the inclusion follows by the definition of the conductor \(\mf{Q}_{\mc{O}/\smc{O}}\). This proves the reverse inclusion so that \(\ker\phi = \mf{p}\smc{O}[\t]\). By first isomorphism theorem, we obtain
      \[
        \smc{O}[\t]/\mf{p}\smc{O}[\t] \cong \mc{O}/\mf{p}\mc{O}.
      \]
      Since \(m_{\t}(x)\) is the minimal polynomial for \(\t\) over \(K\), we have an isomorphism \(\smc{O}[x]/m_{\t}(x)\smc{O}[x] \cong \smc{O}[\t]\) given by evaluation at \(\t\). Then we have the chain of isomorphism
      \[
        \smc{O}[\t]/\mf{p}\smc{O}[\t] \cong (\smc{O}[x]/m_{\t}(x)\smc{O}[x])/(\mf{p}(\smc{O}[x]/m_{\t}(x)\smc{O}[x])) \cong \smc{O}[x]/(\mf{p}\smc{O}[x]+m_{\t}(x)\smc{O}[x]) \cong \F_{\mf{p}}[x]/\conj{m_{\t}}(x)\F_{\mf{p}}[x],
      \]
      where the second and third isomorphisms follow by taking \(\smc{O}[x]/(\mf{p}\smc{O}[x]+m_{\t}(x)\smc{O}[x])\) and reducing elements of \(\smc{O}[x]\) modulo \(m_{\t}(x)\smc{O}[x]\) or their coefficients modulo \(\mf{p}\) respectively. Therefore the inverse isomorphism is given by sending any representative \(\conj{f}(x)\) of a coset in \(\F_{\mf{p}}[x]/\conj{m_{\t}}(x)\F_{\mf{p}}[x]\) to a lift \(f(x)\) in \(\smc{O}[x]\) and then to \(\conj{f(\t)}\) by reducing \(f(\t)\) modulo \(\mf{p}\mc{O}\). Now set \(A = \F_{\mf{p}}[x]/\conj{m_{\t}}(x)\F_{\mf{p}}[x]\). The Chinese remainder theorem gives an isomorphism
      \[
        A \cong \bigop_{1 \le i \le r}\F_{\mf{p}}[x]/\conj{m_{i}}(x)^{e_{i}}\F_{\mf{p}}[x].
      \]
      As \(\conj{m_{i}}(x)\) is irreducible, \(\conj{m_{i}}(x)\F_{\mf{p}}[x]\) is maximal and hence \(\F_{\mf{p}}[x]/\conj{m_{i}}(x)\F_{\mf{p}}[x]\) is a field. By the third isomorphism theorem, \(\conj{m_{i}}(x)\F_{\mf{p}}[x]/\conj{m_{i}}(x)^{e_{i}}\F_{\mf{p}}[x]\) is a maximal ideal of \(\F_{\mf{p}}[x]/\conj{m_{i}}(x)^{e_{i}}\F_{\mf{p}}[x]\). It follows that the maximal ideals of \(A\) are precisely the \(\conj{m_{i}}(x)A\) and we have an isomorphism
      \[
        A/\conj{m_{i}}(x)A \cong \F_{\mf{p}}[x]/\conj{m_{i}}(x)\F_{\mf{p}}[x],
      \]
      for all \(i\). Via the isomorphism \(\mc{O}/\mf{p}\mc{O} \cong A\) described above, the maximal ideals of \(\mc{O}/\mf{p}\mc{O}\) are exactly \(\conj{m_{i}(\t)}(\mc{O}/\mf{p}\mc{O})\). We now show that the \(\mf{P}_{i}\) are prime. To see this, consider the surjective homomorphism
      \[
        \pi:\mc{O} \to \mc{O}/\mf{p}\mc{O} \qquad \a \mapsto \a+\mf{p}\mc{O}.
      \]
      Then the image of \(\mf{P}_{i}\) under \(\pi\) is \(\conj{m_{i}(\t)}(\mc{O}/\mf{p}\mc{O})\). As this ideal is maximal and hence prime, the preimage \(\mf{P}_{i}\) is prime too. Moreover, the \(\mf{P}_{i}\) are all distinct since the \(\conj{m_{i}(\t)}\mc{O}/\mf{p}\mc{O}\) are which are all distinct because the \(\conj{m_{i}}(x)A\) are (using the isomorphism \(\mc{O}/\mf{p}\mc{O} \cong A\)). In particular, they are also relatively prime. By construction, \(\mf{P}_{i} \subseteq \mf{p}\mc{O}\) so that the \(\mf{P}_{i}\) are prime factors of \(\mf{p}\mc{O}\). These are the only prime factors of \(\mf{p}\mc{O}\) because the image of any prime under \(\pi\) contained in \(\mf{p}\mc{O}\) must be a maximal ideal of \(\mc{O}/\mf{p}\mc{O}\) (since primes are maximal and by the fourth isomorphism theorem) and every maximal ideal is one of the \(\conj{m_{i}(\t)}(\mc{O}/\mf{p}\mc{O})\). Together, all of this means that \(\mf{p}\mc{O}\) admits the prime factorization
      \[
        \mf{p}\mc{O} = \mf{P}_{1}^{e_{\mf{p}}(\mf{P}_{1})} \cdots \mf{P}_{r}^{e_{\mf{p}}(\mf{P}_{r})},
      \]
      for some ramification indices \(e_{\mf{p}}(\mf{P}_{i})\). We will be done if we can show \(e_{\mf{p}}(\mf{P}_{i}) = e_{i}\) and \(f_{\mf{p}}(\mf{P}_{i}) = \deg(\conj{m_{i}}(x))\) for all \(i\). To accomplish this, observe that we have an isomorphism
      \[
        \F_{\mf{P}_{i}} \cong (\mc{O}/\mf{p}\mc{O})/(\conj{m_{i}(\t)}(\mc{O}/\mf{p}\mc{O})) \cong \F_{\mf{p}}[x]/\conj{m_{i}}(x)\F_{\mf{p}}[x],
      \]
      where the first isomorphism follow by taking \(\F_{\mf{P}_{i}}\) and reducing \(\mc{O}\) modulo \(\mf{p}\) and the second isomorphism follows from \(\mc{O}/\mf{p}\mc{O} \cong A\) and that the image of the maximal ideal \(\conj{m_{i}(\t)}(\mc{O}/\mf{p}\mc{O})\) under this isomorphism is \(\conj{m_{i}}(x)A\). Now \(\F_{\mf{p}}[x]/\conj{m_{i}}(x)\F_{\mf{p}}[x]\) is a \(\F_{\mf{p}}\)-vector space of degree \(\deg(\conj{m_{i}}(x))\). Hence \(f_{p}(\mf{P}_{i}) = \deg(\conj{m_{i}}(x))\) for all \(i\) as desired. The ideal \(\conj{m_{i}}(x)^{e_{i}}A\) under the isomorphism \(A \cong \mc{O}/\mf{p}\mc{O}\) is the ideal \(\conj{m_{i}(\t)}^{e_{i}}(\mc{O}/\mf{p}\mc{O})\). As the image of \(\mf{P}_{i}\) under \(\pi\) is \(\conj{m_{i}(\t)}(\mc{O}/\mf{p}\mc{O})\), we have that \(\mf{P}_{i}^{e_{i}}\) is contained in the preimage of \(\conj{m_{i}(\t)}^{e_{i}}(\mc{O}/\mf{p}\mc{O})\) under \(\pi\). As \(\conj{m_{\t}(\t)}(\mc{O}/\mf{p}\mc{O}) = 0\), it follows that
      \[
        \mf{p}\mc{O} = \pi^{-1}(0) \supseteq \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}}.
      \]
      Since the \(\mf{P}_{i}\) are prime, we have \(e_{\mf{p}}(\mf{P}_{i}) \le e_{i}\) for all \(i\). But the fundamental equality then gives
      \[
        n = \sum_{1 \le i \le r}e_{\mf{p}}(\mf{P}_{i})f_{p}(\mf{P}_{i}) \le \sum_{1 \le i \le r}e_{i}f_{p}(\mf{P}_{i}) \le \sum_{1 \le i \le r}e_{i}\deg(\conj{m_{i}}(x)) \le n,
      \]
      where the last equality follows by the prime factorization of \(\conj{m_{\t}}(x)\) and that \(\deg(\conj{m_{\t}}(x)) = \deg(m_{\t}(x))\) because \(m_{\t}(x)\) is monic. This shows \(e_{\mf{p}}(\mf{P}_{i}) = e_{i}\) for all \(i\) which completes the proof.
    \end{proof}

    Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\). The Dedekind-Kummer theorem allows us to compute the prime factorization of \(\mf{p}\mc{O}\) provided this integral ideal is relatively prime to the conductor \(\mf{Q}_{\mc{O}/\smc{O}}\). By the prime factorization of fractional ideals, \(\mf{Q}_{\mc{O}/\smc{O}}\) has finitely many prime factors so we only have to avoid finitely many primes of \(\mc{O}\). In fact, if the conductor is \(\mc{O}\) then we do not have to avoid any primes at all. This occurs when \(\mc{O}/\smc{O}\) is monogenic. Indeed, Suppose \(\mc{O} = \smc{O}[\a]\) for some \(\a \in \mc{O}\). Then \(1,\a,\ldots,\a^{n-1}\) is an integral basis for \(\mc{O}/\smc{O}\) and is necessarily a basis for \(L/K\). But then \(\a\) is also a primitive element for \(L/K\) which implies
    \[
      \mf{Q}_{\mc{O}/\smc{O}} = \mc{O}.
    \]
    We now turn to the setting of a number field \(K\). Every prime \(\mf{p}\) of \(K\) is above some prime \(p\) (recall \(\Z\) is a principal ideal domain so we are referring to primes by their generator). Then the residue class extension of \(\mc{O}_{K}/\Z\) for \(\mf{p}\) is \(\F_{\mf{p}}/\F_{p}\). Also, we write \(f_{p}(\mf{p})\) and \(e_{p}(\mf{p})\) for the inertia degree and ramification index of \(\mf{p}\) relative to \(p\) respectively. Moreover, all of the residue class extensions are separable since \(\F_{p}\) is a perfect field. This implies \(\mf{p}\) is ramified in \(\mc{O}_{K}/\Z\) if and only if \(e_{p}(\mf{p}) = 1\). If \(\t\) is a primitive element for \(K/\Q\) contained in \(\mc{O}_{K}\), then the \textbf{conductor}\index{conductor} \(\mf{q}_{K}\) of \(K\) relative to \(\t\) is the conductor of \(\mc{O}_{K}/\Z\) relative to \(\t\). Even though \(K\) admits an integral basis, \(\mc{O}_{K}\) is not necessarily monogenic so that \(\mf{q}_{K}\) may not be \(\mc{O}_{K}\).
  \section{Galois Extensions}
    Much more can be said about the ramification of primes in a Dedekind extension \(\mc{O}/\smc{O}\) when the associated extension \(L/K\) is Galois. Since \(L/K\) is assumed to be finite and separable, this amounts to further assuming \(L/K\) is normal. In this case, the elements of the Galois group \(\Gal(L/K) = \Hom_{K}(L,\conj{K})\). Then by \cref{prop:formulas_for_trace_and_norm}, we have
    \[
      \Norm_{L/K}(\l) = \prod_{\s \in \Gal(L/K)}\s(\l) \quad \text{and} \quad \Trace_{L/K}(\l) = \sum_{\s \in \Gal(L/K)}\s(\l),
    \]
    for all \(\l \in L\). As \(\smc{O} \subseteq K\), we see that \(\Gal(L/K)\) fixes \(\smc{O}\) pointwise and hence every fractional ideal of \(\smc{O}\) as well. Now let \(\s \in \Gal(L/K)\) and \(\a \in \mc{O}\). Then
    \[
      \a^{n}+a_{n-1}\a^{n-1}+\cdots+a_{0} = 0,
    \]
    for some \(n \ge 1\) and \(a_{i} \in \smc{O}\) for \(0 \le i \le n-1\). Applying \(\s\) gives
     \[
      \s(\a)^{n}+a_{n-1}\s(\a)^{n-1}+\cdots+a_{0} = 0,
    \]
    because \(\s\) is a \(K\)-embedding. This shows \(\s(\a) \in \mc{O}\) and therefore the Galois group \(\Gal(L/K)\) acts on \(\mc{O}\). In particular, each automorphism \(\s\) of \(\Gal(L/K)\) restricts to an automorphism of \(\mc{O}\) and therefore \(\s(\mf{P})\) is a prime of \(\mc{O}\) if \(\mf{P}\). Moreover, if \(\mf{P}\) is above \(\mf{p}\) then so is \(\s(\mf{P})\). Indeed, just observe that
    \[
      \s(\mf{P}) \cap \smc{O} = \s(\mf{P} \cap \smc{O}) = \s(\mf{p}) = \mf{p}.
    \]
    Accordingly, we say that \(\s(\mf{P})\) is \textbf{conjugate}\index{conjugate} to \(\mf{P}\). It turns out that the Galois group acts transitively on the set of primes above a given prime:

    \begin{proposition}\label{prop:Galois_action_on_primes_is_transitive}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a finite Galois extension \(L/K\) and let \(\mf{p}\) be a prime of \(\smc{O}\). Then \(\Gal(L/K)\) acts transitively on the set of primes above \(\mf{p}\). Moreover, if \(\mf{p}\mc{O}\) has prime factorization
      \[
        \mf{p}\mc{O} = \mf{P}_{1}^{e_{\mf{p}}(\mf{P}_{1})} \cdots \mf{P}_{r}^{e_{\mf{p}}(\mf{P}_{r})},
      \]
      then
      \[
        f_{\mf{p}}(\mf{P}_{1}) = \cdots = f_{\mf{p}}(\mf{P}_{r}) \quad \text{and} \quad e_{\mf{p}}(\mf{P}_{1}) = \cdots = e_{\mf{p}}(\mf{P}_{r}).
      \]
    \end{proposition}
    \begin{proof}
      Let \(\mf{P}_{i}\) and \(\mf{P}_{j}\) for \(1 \le i < j \le r\) be two distinct primes above \(\mf{p}\). Assume by contraction that \(\s(\mf{P}_{i}) \neq \mf{P}_{j}\) for any \(\s \in \Gal(L/K)\). Since distinct primes are relatively prime, the Chinese remainder theorem implies the existence of an \(\a \in \mc{O}\) such that
      \[
        \a \equiv 1 \tmod{\s(\mf{P}_{i})} \quad \text{and} \quad \a \equiv 0 \tmod{\mf{P}_{j}},
      \]
      for all \(\s \in \Gal(L/K)\). Now recall that \(\Norm_{L/K}(\a) = \prod_{\s \in \Gal(L/K)}\s(\a)\) by \cref{prop:formulas_for_trace_and_norm} and \(\Norm_{L/K}(\a) \in \smc{O}\) by \cref{prop:trace_and_norm_AKBL}. Moreover,
      \[
        \mf{P}_{i} \cap \smc{O} = \mf{p} = \mf{P}_{j} \cap \smc{O}.
      \]
      On the one hand, \(\a \notin \s(\mf{P}_{i})\) and hence \(\s(\a) \notin \mf{P}_{i}\) for all \(\s \in \Gal(L/K)\) (recall \(\Gal(L/K)\) is a group so \(\s\) has an inverse \(\s^{-1}\)). But then \(\Norm_{L/K}(\a) \notin \mf{P}_{i}\) for otherwise \(\s(\a) \in \mf{P}_{i}\) for some \(\s \in \Gal(L/K)\) by primality of \(\mf{P}_{i}\). It must be the case that \(\Norm_{L/K}(\a) \notin \mf{p}\) because \(\mf{P}_{i}\) is above \(\mf{p}\). On the other hand, \(\a \in \mf{P}_{j}\) and so \(\Norm_{L/K}(\a) \in \mf{P}_{j}\) since \(\s(\a) \in \mf{P}_{j}\) when \(\s\) is the identity and \(\mf{P}_{j}\) is an integral ideal. But then \(\Norm_{L/K}(\a) \in \mf{p}\) because \(\mf{P}_{j}\) is above \(\mf{p}\). This gives a contradiction and therefore the action is transitive. We now show that the inertia degrees and ramification indices of \(\mf{P}_{i}\) and \(\mf{P}_{j}\) are equal which will complete the proof. By what we have just proved, there exists a \(\s \in \Gal(L/K)\) such that \(\s(\mf{P}_{i}) = \mf{P}_{j}\). Since \(\s\) is an automorphism of \(\mc{O}\), it induces an isomorphism
      \[
        \F_{\mf{P}_{i}} \cong \F_{\mf{P}_{j}}.
      \]
      Therefore the inertia degrees of \(\mf{P}_{i}\) and \(\mf{P}_{j}\) are equal. For the ramification indices, recall that \(\s\) is an automorphism of \(\mc{O}\) fixing \(\smc{O}\), and hence \(\mf{p}\) too, pointwise. Thus \(\s(\mf{p}\mc{O}) = \mf{p}\mc{O}\) which implies that \(\mf{P}_{i}^{e} \mid\mid \mf{p}\mc{O}\) if and only if \(\mf{P}_{j}^{e} \mid\mid \mf{p}\mc{O}\). Therefore the ramification indices of \(\mf{P}_{i}\) and \(\mf{P}_{j}\) are equal as well. This completes the proof 
    \end{proof}

    Another way to phrase \cref{prop:Galois_action_on_primes_is_transitive} is that the primes above \(\mf{p}\) are all conjugate to each other and their inertia degrees and ramification indices are all equal. We call the common inertia degree \(f\) the \textbf{inertia degree}\index{inertia degree} of \(\mf{p}\) and the common ramification index \(e\) the \textbf{ramification index}\index{ramification index} of \(\mf{p}\). If there are \(r\) primes above \(\mf{p}\), the fundamental equality takes the particularly simple form
    \[
      n = ref.
    \]
    Continue to let \(\mf{P}\) be a prime above \(\mf{p}\). We define the \textbf{decomposition group}\index{decomposition group} \(D_{\mf{p}}(\mf{P})\) of \(\mf{P}\) by
    \[
      D_{\mf{p}}(\mf{P}) = \{\tau \in \Gal(L/K):\tau(\mf{P}) = \mf{P}\}.
    \]
    Equivalently, \(D_{\mf{p}}(\mf{P})\) is the stabilizer subgroup of \(\mf{P}\) in \(\Gal(L/K)\). The associated \textbf{decomposition field}\index{decomposition field} \(L^{D_{\mf{p}}(\mf{P})}\) of \(\mf{P}\) is defined to be
    \[
      L^{D_{\mf{p}}(\mf{P})} = \{\l \in L:\tau(\l) = \l \text{ for all } \tau \in D_{\mf{p}}(\mf{P})\}.
    \]
    In other words, the decomposition field of \(\mf{P}\) is the fixed field of \(L\) by \(D_{\mf{p}}(\mf{P})\). In particular, the fundamental theorem of Galois theory gives
    \[
      \Gal(L/L^{D_{\mf{p}}(\mf{P})}) = D_{\mf{p}}(\mf{P}).
    \]
    We let \(\mc{O}^{D}\) denote the integral closure of \(\smc{O}\) in \(L^{D_{\mf{p}}(\mf{P})}\) so that \(\mc{O}/\mc{O}^{D}/\smc{O}\) is a tower of Dedekind extensions. Also, we will write \(\mf{P}^{D}\) for the prime of \(L^{D_{\mf{p}}(\mf{P})}\) below \(\mf{P}\). Then we can illustrate this relationship via the following tower of extensions:
    
    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mf{P} \subset \mc{O} \subseteq L \arrow[dash]{d} \\
        \mf{P}^{D} \subset \mc{O}^{D} \subseteq L^{D_{\mf{p}}(\mf{P})} \arrow[dash]{d} \\
        \mf{p} \subset \smc{O} \subseteq K.
      \end{tikzcd}
    \end{center}

    Any of the decomposition groups \(D_{\mf{p}}(\mf{P})\) encode how \(\mf{p}\mc{O}\) splits into distinct prime factors in \(\mc{O}\). Indeed, by the orbit-stabilizer theorem the number of cosets in \(\Gal(L/K)/D_{\mf{p}}(\mf{P})\) is equal to the size of the orbit of \(\mf{P}\) under the action of \(\Gal(L/K)\). As the action is transitive by \cref{prop:Galois_action_on_primes_is_transitive}, \(\s(\mf{P})\) runs over the primes above \(\mf{p}\) as \(\s\) runs over a complete set of representatives for this coset space. It follows that the number of prime factors of \(\mf{p}\mc{O}\) is equal to the index \(|\Gal(L/K)/D_{\mf{p}}(\mf{P})|\). In particular, \(\mf{p}\) is inert in \(\mc{O}/\smc{O}\) if and only if \(D_{\mf{p}}(\mf{P}) = \Gal(L/K)\) which is equivalent to \(L^{D_{\mf{p}}(\mf{P})} = K\). Antithetically, \(\mf{p}\) is totally split in \(\mc{O}/\smc{O}\) if and only if \(D_{\mf{p}}(\mf{P}) = \{\id\}\) which is equivalent to \(L^{D_{\mf{p}}(\mf{P})} = L\). More generally, the fundamental equality implies \(n = ef|\Gal(L/K)/D_{\mf{p}}(\mf{P})|\) which is to say that
    \begin{equation}\label{equ:decomposition_group_e_f_relation}
      |D_{\mf{p}}(\mf{P})| = ef.
    \end{equation}
    Then \(L/L^{D_{\mf{p}}(\mf{P})}\) has degree \(ef\) and \(L^{D_{\mf{p}}(\mf{P})}/K\) has degree equal to the number of distinct prime factors of \(\mf{p}\mc{O}\) which is \(|\Gal(L/K)/D_{\mf{p}}(\mf{P})|\). If \(\mf{p}\) inert in \(\mc{O}/\smc{O}\) then \(n = ef\) implying \(e = 1\) and \(n = f\) as we have seen. If \(\mf{p}\) is totally split in \(\mc{O}/\smc{O}\) then \(1 = ef\) so that \(e = f = 1\) as we have also seen. Moreover, the decomposition group of a conjugate prime \(\s(\mf{P})\) to \(\mf{P}\) is the conjugate of decomposition group of \(\mf{P}\) by \(\s\). In other words,
    \[
      D_{\mf{p}}(\s(\mf{P})) = \s D_{\mf{p}}(\mf{P})\s^{-1}.
    \]
    This is simply because \(\tau(\mf{P}) = \mf{P}\) if and only if \(\s\tau\s^{-1}(\s(\mf{P})) = \s(\mf{P})\). Also, the fundamental theorem of Galois theory implies that \(D_{\mf{p}}(\s(\mf{P}))\) is normal if and only if \(L^{D_{\mf{p}}(\s(\mf{P}))}/K\) is Galois in which case
    \[
      \Gal(L^{D_{\mf{p}}(\s(\mf{P}))}/K) \cong \Gal(L/K)/D_{\mf{p}}(\s(\mf{P})).
    \]
    Regardless, \cref{prop:Galois_action_on_primes_is_transitive} shows that the prime factorization of \(\mf{p}\mc{O}\) takes the form
    \[
      \mf{p}\mc{O} = \left(\prod_{\s \in \Gal(L/K)/D_{\mf{p}}(\mf{P})}\s(\mf{P})\right)^{e}.
    \]
    The decomposition field is aptly named because it contains all of the information about the different prime factors that \(\mf{p}\mc{O}\) splits into in \(\mc{O}\). In particular, the primes \(\mf{P}^{D}\) are inert in \(\mc{O}/\mc{O}^{D}\) as the following proposition shows:

    \begin{proposition}\label{prop:decomposition_field_e_and_f}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) Galois extension \(L/K\), let \(\mf{p}\) be a prime of \(\smc{O}\) with inertia degree \(f\) and ramification index \(e\), and let \(\mf{P}\) be a prime of \(\mc{O}\) above \(\mf{p}\). Then the following hold:
      \begin{enumerate}[label*=(\roman*)]
        \item \(\mf{P}^{D}\) is inert in \(\mc{O}/\mc{O}^{D}\).
        \item \(e_{\mf{p}}(\mf{P}^{D}) = f_{\mf{p}}(\mf{P}^{D}) = 1\), \(e_{\mf{P}^{D}}(\mf{P}) = e\), and \(f_{\mf{P}^{D}}(\mf{P}) = f\).
      \end{enumerate}
    \end{proposition}
    \begin{proof}
      We will prove the statements separately:
      \begin{enumerate}[label*=(\roman*)]
        \item By the fundamental theorem of Galois theory, \(\Gal(L/L^{D_{\mf{p}}(\mf{P})}) = D_{\mf{p}}(\mf{P})\). It follows from \cref{prop:Galois_action_on_primes_is_transitive} that the primes of \(\mc{O}\) above \(\mf{P}^{D}\) are of the form \(\s(\mf{P})\) for \(\s \in D_{\mf{p}}(\mf{P})\). But for these \(\s\) we have \(\s(\mf{P}) = \mf{P}\). Therefore \(\mf{P}^{D}\) is inert \(\mc{O}/\mc{O}^{D}\). This proves (i).
        \item Recall \(\Gal(L/L^{D_{\mf{p}}(\mf{P})}) = D_{\mf{p}}(\mf{P})\) by the fundamental theorem of Galois theory. On the one hand, since \(|\Gal(L/L^{D_{\mf{p}}(\mf{P})})|\) is the degree of \(L/L^{D_{\mf{p}}(\mf{P})}\) and \(\mf{P}^{D}\) is inert in \(\mc{O}/\mc{O}^{D}\), the fundamental equality gives \(|D_{\mf{p}}(\mf{P})| = e_{\mf{P}^{D}}(\mf{P})f_{\mf{P}^{D}}(\mf{P})\). Then \cref{equ:decomposition_group_e_f_relation} gives
        \[
          ef = e_{\mf{P}^{D}}(\mf{P})f_{\mf{P}^{D}}(\mf{P}).
        \]
        On the other hand, as \(\mc{O}/\mc{O}^{D}/\smc{O}\) is a tower of Dedekind extensions, \cref{equ:ramification_and_interia_towers} implies \(e = e_{\mf{P}^{D}}(\mf{P})e_{\mf{p}}(\mf{P}^{D})\) and \(f = f_{\mf{P}^{D}}(\mf{P})f_{\mf{p}}(\mf{P}^{D})\). Thus
        \[
          ef = e_{\mf{P}^{D}}(\mf{P})e_{\mf{p}}(\mf{P}^{D})f_{\mf{P}^{D}}(\mf{P})f_{\mf{p}}(\mf{P}^{D}).
        \]
        These two identities together imply \(e_{\mf{p}}(\mf{P}^{D}) = f_{\mf{p}}(\mf{P}^{D}) = 1\). It follows that \(e_{\mf{P}^{D}}(\mf{P}) = e\) and \(f_{\mf{P}^{D}}(\mf{P}) = f\). This proves (ii).
      \end{enumerate}
    \end{proof}
    
    We can view \cref{prop:decomposition_field_e_and_f} (i) as a statement that \(\mf{p}\mc{O}^{D}\) encodes all of the information about the distinct prime factors \(\mf{p}\mc{O}\) splits into in \(\mc{O}\). Moreover, \cref{prop:decomposition_field_e_and_f} (ii) can be interpreted as the fact that \(\mc{O}^{D}/\smc{O}\) contains no information about the ramification index or inertia degree of \(\mf{p}\) in \(\mc{O}/\smc{O}\). All of that information is contained in \(\mc{O}/\mc{O}^{D}\) and we need to do more to unpack it. Since any \(\tau \in D_{\mf{p}}(\mf{P})\) leaves \(\mc{O}\) and \(\mf{P}\) invariant, it induces an automorphism \(\conj{\tau}\) of the residue class field \(\F_{\mf{P}}\) defined by
    \[
      \conj{\tau}:\F_{\mf{P}}\to \F_{\mf{P}}\qquad \a \mapsto \tau(\a)+\mf{P}.
    \]
    We then obtain a homomorphism
    \[
      T_{\mf{p}}^{\mf{P}}:D_{\mf{p}}(\mf{P}) \to \Aut(\F_{\mf{P}}/\F_{\mf{p}}) \qquad \tau \mapsto \conj{\tau}.
    \]
    The following proposition shows that the residue class extensions \(\F_{\mf{P}}/\F_{\mf{p}}\) are normal and that \(T_{\mf{p}}^{\mf{P}}\) is surjective:
    
    \begin{proposition}\label{prop:T_map_is_surjective}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a finite Galois extension \(L/K\), let \(\mf{p}\) be a prime of \(\smc{O}\), and let \(\mf{P}\) be a prime of \(\mc{O}\) above \(\mf{p}\). Then the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is normal. Moreover, the homomorphism \(T_{\mf{p}}^{\mf{P}}\) is surjective.
    \end{proposition}
    \begin{proof}
      By \cref{prop:decomposition_field_e_and_f} (ii), \(f_{\mf{p}}(\mf{P}^{D}) = 1\) so that we have an isomorphism \(\F_{\mf{P}^{D}} \cong \F_{\mf{p}}\). Under this isomorphism we may assume \(L^{D_{\mf{p}}(\mf{P})} = K\) which is to say \(D_{\mf{p}}(\mf{P}) = \Gal(L/K)\). We will now prove that \(\F_{\mf{P}}/\F_{\mf{p}}\) is normal. So let \(\a \in \mc{O}\) and suppose \(m_{\a}(x)\) and \(m_{\conj{\a}}(x)\) are the minimal polynomials of \(\a\) and \(\conj{\a}\) over \(K\) and \(\F_{\mf{p}}\) respectively. Consider the reduction \(\conj{m_{\a}}(x)\) of \(m_{\a}(x)\), viewed as an element of \(\mc{O}[x]\), modulo \(\mf{P}\) upon recalling that the coefficients of which are in \(\smc{O}\) by \cref{prop:field_of_fractions_AKBL}. As \(\a\) is a representative of \(\conj{\a}\), we find that \(\conj{\a}\) is a root of \(\conj{m_{\a}}(x)\) and thus \(m_{\conj{\a}}(x)\) divides \(\conj{m_{\a}}(x)\) in \(\F_{\mf{P}}[x]\). Since \(L/K\) is normal (as it is Galois), \(m_{\a}(x)\) splits into linear factors over \(L\). These linear factors must also belong to \(\mc{O}[x]\) since their roots are elements of \(\mc{O}\) which itself is integrally closed. It follows that \(\conj{m_{\a}}(x)\) splits into linear factors over \(\F_{\mf{P}}\). As \(m_{\conj{\a}}(x)\) divides \(\conj{m_{\a}}(x)\) in \(\F_{\mf{P}}[x]\), the same is true for \(m_{\conj{\a}}(x)\). Thus \(\F_{\mf{P}}/\F_{\mf{p}}\) is normal. We now prove the surjectivity of \(T_{\mf{p}}^{\mf{P}}\). Consider the maximal separable subextension of \(\F_{\mf{P}}/\F_{\mf{p}}\). Since this extension is finite (because the residue class extension is), it is simple by the primitive element theorem. Letting \(\t \in \mc{O}\) be such that \(\conj{\t}\) is a primitive element, the maximal separable subextension is of the form \(\F_{\mf{p}}(\conj{\t})/\F_{\mf{p}}\). Now let \(\conj{\tau} \in \Aut(\F_{\mf{P}}/\F_{\mf{p}})\). Since \(\conj{\tau}\) fixes \(\F_{\mf{p}}\) pointwise, \(\conj{\tau}(\conj{\t})\) is a root of \(m_{\conj{\t}}(x)\). As \(m_{\conj{\t}}(x)\) divides \(\conj{m_{\t}}(x)\) in \(\F_{\mf{P}}[x]\), we find that \(\conj{\tau}(\conj{\t})\) is also a root of \(\conj{m_{\t}}(x)\). Therefore there is a root \(\t'\) of \(m_{\t}(x)\) that is also a representative of \(\conj{\tau}(\conj{\t})\). Because \(L/K\) is Galois, we can find \(\tau \in \Gal(L/K)\) such that \(\tau(\t) = \t'\). Moreover, \(\tau \in D_{\mf{p}}(\mf{P})\) since \(D_{\mf{p}}(\mf{P}) = \Gal(L/K)\). Then \(T_{\mf{p}}^{\mf{P}}(\tau) = \conj{\tau}\) because they both take \(\conj{\t}\) to the same element, hence act the same on \(\F_{\mf{p}}(\conj{\t})/\F_{\mf{p}}\), and \(\F_{\mf{P}}/\F_{\mf{p}}(\conj{\t})\) is purely inseparable so that it has trivial automorphism group. This proves \(T_{\mf{p}}^{\mf{P}}\) is surjective completing the proof.
    \end{proof}

    Accordingly, we define the \textbf{inertia group}\index{inertia group} \(I_{\mf{p}}(\mf{P})\) of \(\mf{P}\) by
    \[
      I_{\mf{p}}(\mf{P}) = \ker{T_{\mf{p}}^{\mf{P}}}.
    \]
    Then \(I_{\mf{p}}(\mf{P})\) is a normal subgroup of \(D_{\mf{p}}(\mf{P})\). The associated \textbf{inertia field}\index{inertia field} \(L^{I_{\mf{p}}(\mf{P})}\) of \(\mf{P}\) is defined to be
    \[
      L^{I_{\mf{p}}(\mf{P})} = \{\l \in L:\tau(\l) = \l \text{ for all } \tau \in I_{\mf{p}}(\mf{P})\}.
    \]
    In other words, the inertia field of \(\mf{P}\) is the fixed field of \(L\) by \(I_{\mf{p}}(\mf{P})\). In particular, the fundamental theorem of Galois theory gives
    \[
      \Gal(L/L^{I_{\mf{p}}(\mf{P})}) = I_{\mf{p}}(\mf{P}).
    \]
    Since \(I_{\mf{p}}(\mf{P})\) is a subgroup of \(D_{\mf{p}}(\mf{P})\), the fundamental theorem of Galois theory implies that \(L^{I_{\mf{p}}(\mf{P})}\) is an intermediate field of \(L/L^{D_{\mf{p}}(\mf{P})}\). We let \(\mc{O}^{I}\) denote the integral closure of \(\smc{O}\) in \(L^{I_{\mf{p}}(\mf{P})}\) so that \(\mc{O}/\mc{O}^{I}/\mc{O}^{D}\) is a tower of Dedekind extensions. Also, we will write \(\mf{P}^{I}\) for the prime of \(L^{I_{\mf{p}}(\mf{P})}\) below \(\mf{P}\). Then we can illustrate this relationship via the following tower of extensions:
    
    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mf{P} \subset \mc{O} \subseteq L \arrow[dash]{d} \\
        \mf{P}^{I} \subset \mc{O}^{I} \subseteq L^{I_{\mf{p}}(\mf{P})} \arrow[dash]{d} \\
        \mf{P}^{D} \subset \mc{O}^{D} \subseteq L^{D_{\mf{p}}(\mf{P})}.
      \end{tikzcd}
    \end{center}

    The inertia group \(I_{\mf{p}}(\mf{P})\) is closely related to the automorphism group of the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\). To see this, first recall that \(\Gal(L/L^{D_{\mf{p}}(\mf{P})}) = D_{\mf{p}}(\mf{P})\) by the fundamental theorem of Galois theory. Then \(I_{\mf{p}}(\mf{P})\) is a normal subgroup of \(\Gal(L/L^{D_{\mf{p}}(\mf{P})})\) and the fundamental theorem of Galois theory again implies \(L^{I_{\mf{p}}(\mf{P})}/L^{D_{\mf{p}}(\mf{P})}\) is Galois with
    \[
      \Gal(L^{I_{\mf{p}}(\mf{P})}/L^{D_{\mf{p}}(\mf{P})}) \cong D_{\mf{p}}(\mf{P})/I_{\mf{p}}(\mf{P}).
    \]
    Since \(T_{\mf{p}}^{\mf{P}}\) is surjective by \cref{prop:T_map_is_surjective}, the first isomorphism theorem induces an isomorphism
    \[
      \Gal(L^{I_{\mf{p}}(\mf{P})}/L^{D_{\mf{p}}(\mf{P})}) \cong \Aut(\F_{\mf{P}}/\F_{\mf{p}}).
    \]
    Now let \(e\) and \(f\) be the ramification index and inertia degree of \(\mf{p}\) respectively. The inertia group \(I_{\mf{p}}(\mf{P})\) encodes \(e\) and \(f\) provided the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is separable. Indeed, \cref{prop:T_map_is_surjective} implies \(\F_{\mf{P}}/\F_{\mf{p}}\) is Galois. Then \(\Gal(\F_{\mf{P}}/\F_{\mf{p}}) = \Aut(\F_{\mf{P}}/\F_{\mf{p}})\) and it follows that \(|\Gal(\F_{\mf{P}}/\F_{\mf{p}})| = f\). Then \cref{equ:decomposition_group_e_f_relation} and our two isomorphisms together give
    \begin{equation}\label{equ:inertia_group_e_f_relation}
      |\Gal(L^{I_{\mf{p}}(\mf{P})}/L^{D_{\mf{p}}(\mf{P})})| = f \quad \text{and} \quad |I_{\mf{p}}(\mf{P})| = e.
    \end{equation}
    Then \(L^{I_{\mf{p}}(\mf{P})}/L^{D_{\mf{p}}(\mf{P})}\) has degree \(f\) and \(L/L^{I_{\mf{p}}(\mf{P})}\) has degree \(e\). The decomposition and inertia groups fit into the follow exact sequence

    \begin{proposition}\label{prop:inertia_group_exact_sequence}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a finite Galois extension \(L/K\), let \(\mf{p}\) be a prime of \(\smc{O}\), and let \(\mf{P}\) be a prime of \(\mc{O}\) above \(\mf{p}\). Then the sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & I_{\mf{p}}(\mf{P}) \arrow{r} & D_{\mf{p}}(\mf{P}) \arrow{r}{T_{\mf{p}}^{\mf{P}}} & \Aut(\F_{\mf{P}}/\F_{\mf{p}}) \arrow{r} & 1,
        \end{tikzcd}
      \end{center}

      is exact.
    \end{proposition}
    \begin{proof}
      The sequence is exact at \(I_{\mf{p}}(\mf{P})\) because the second map is injective. Exactness at \(D_{\mf{p}}(\mf{P})\) follows by the definition of \(I_{\mf{p}}(\mf{P})\). Lastly, we have exactness at \(\Aut(\F_{\mf{P}}/\F_{\mf{p}})\) since \(T_{\mf{p}}^{\mf{P}}\) is surjective by \cref{prop:T_map_is_surjective}.
    \end{proof}

    We can say more when the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is separable as the following proposition shows:

    \begin{proposition}\label{prop:inertia_field_e_and_f}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a finite Galois extension \(L/K\), let \(\mf{p}\) be a prime of \(\smc{O}\) with inertia degree \(f\) and ramification index \(e\), and let \(\mf{P}\) be a prime of \(\mc{O}\) above \(\mf{p}\). Moreover, suppose the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is separable. Then the following hold:
      \begin{enumerate}[label*=(\roman*)]
        \item \(e_{\mf{P}^{I}}(\mf{P}) = e\) and \(f_{\mf{P}^{I}}(\mf{P}) = 1\).
        \item \(e_{\mf{P}^{D}}(\mf{P}^{I}) = 1\) and \(f_{\mf{P}^{D}}(\mf{P}^{I}) = f\).
      \end{enumerate}
    \end{proposition}
    \begin{proof}
      First observe that \(I_{\mf{P}^{I}}(\mf{P}) = I_{\mf{p}}(\mf{P})\). Indeed, recall that \(\Gal(L/L^{I_{\mf{p}}(\mf{P})}) = I_{\mf{p}}(\mf{P})\). Then \cref{prop:Galois_action_on_primes_is_transitive} implies that the primes of \(\mc{O}\) above \(\mf{P}^{I}\) are of the form \(\s(\mf{P})\) for \(\s \in I_{\mf{p}}(\mf{P})\). But for these \(\s\) we have \(\s(\mf{P}) = \mf{P}\). This shows that \(\mf{P}^{I}\) is inert in \(\mc{O}/\mc{O}^{I}\). Therefore \(D_{\mf{P}^{I}}(\mf{P}) = I_{\mf{p}}(\mf{P})\). Since \(\ker T_{\mf{p}}^{\mf{P}} \subseteq \ker T_{\mf{P}^{I}}^{\mf{P}}\) (because any automorphism that is the identity on \(\F_{\mf{P}}\) is also the identity on the subfield \(\F_{\mf{P}^{I}}\)), we conclude that \(I_{\mf{P}^{I}}(\mf{P}) = I_{\mf{p}}(\mf{P})\). We now prove the statements:
      \begin{enumerate}[label*=(\roman*)]
        \item Since \(\Gal(L/L^{I_{\mf{p}}(\mf{P})}) = I_{\mf{p}}(\mf{P})\) and \(\mf{P}^{I}\) is inert in \(\mc{O}/\mc{O}^{I}\), we have
        \[
          e = e_{\mf{P}^{I}}(\mf{P})f_{\mf{P}^{I}}(\mf{P}),
        \]
        by the fundamental equality and \cref{equ:inertia_group_e_f_relation}. As \(I_{\mf{P}^{I}}(\mf{P}) = I_{\mf{p}}(\mf{P})\), it follows from \cref{prop:T_map_is_surjective} that \(\Aut(\F_{\mf{P}}/\F_{\mf{P}^{I}}) = \{\id\}\). Therefore \(e_{\mf{P}^{I}}(\mf{P}) = e\) and \(f_{\mf{P}^{I}}(\mf{P}) = 1\) proving (i).
        \item Combining \cref{equ:ramification_and_interia_towers} and \cref{{prop:decomposition_field_e_and_f}} (ii) together gives
        \[
          e = e_{\mf{P}^{D}}(\mf{P}^{I})e_{\mf{P}^{I}}(\mf{P}) \quad \text{and} \quad f = f_{\mf{P}^{D}}(\mf{P}^{I})f_{\mf{P}^{I}}(\mf{P}).
        \]
        Then (i) implies (ii).
      \end{enumerate}
    \end{proof}

    In the case the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is separable, we fit the decomposition and inertia fields into the following tower of extensions:

    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mf{P} \subset \mc{O} \subseteq L \arrow[dash]{d}{1}[swap]{e} \\
        \mf{P}^{I} \subset \mc{O}^{I} \subseteq L^{I_{\mf{p}}(\mf{P})} \arrow[dash]{d}{f}[swap]{1} \\
        \mf{P}^{D} \subset \mc{O}^{D} \subseteq L^{D_{\mf{p}}(\mf{P})} \arrow[dash]{d}{1}[swap]{1} \\
        \mf{p} \subset \smc{O} \subseteq K.
      \end{tikzcd}
    \end{center}

    The labels on left and right of the extensions represent the corresponding ramification indices and inertia degrees respectively which come from \cref{prop:decomposition_field_e_and_f,prop:inertia_field_e_and_f}. Then we see that the extension \(L^{D_{\mf{p}}(\mf{P})}/K\) contains all of the information about the distinct prime factors \(\mf{p}\mc{O}\) splits into in \(\mc{O}\), the extension \(L^{I_{\mf{p}}(\mf{P})}/L^{D_{\mf{p}}(\mf{P})}\) contains all of the information about the corresponding inertia degrees, and the extension \(L/L^{I_{\mf{p}}(\mf{P})}\) contains all of the information about the corresponding ramification indices. In particular, \(\mf{p}\) is unramified in \(\mc{O}/\smc{O}\) if and only if \(L^{I_{\mf{p}}(\mf{P})} = L\) which is equivalent to \(I_{\mf{p}}(\mf{P}) = \{\id\}\).
  \section{The Different and Discriminant}
    Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\). It is exceptionally rare for a prime \(\mf{p}\) of \(K\) to ramify. We will construct two integral ideals, one of \(\mc{O}\) and the other of \(\smc{O}\) which will tell us which primes ramify in \(L\) or \(K\). These integral ideals are the different and discriminant respectively. To describe them, we will need the concept of lattices in Dedekind domains. We say that \(\mf{L}\) is a \textbf{\(\smc{O}\)-lattice}\index{\(\smc{O}\)-lattice} if it is a finitely generated \(\smc{O}\)-submodule of \(L\). Moreover, we say that \(\mf{L}\) is \textbf{complete}\index{complete} if it spans \(L/K\). That is, \(\mf{L}\) contains a basis of \(L/K\).

    \begin{remark}
      A \(\Z\)-lattice is an integral lattice and a complete \(\Z\)-lattice is a complete integral lattice.
    \end{remark}

    A \(\smc{O}\)-lattice \(\mf{L}\) need not be a fractional ideal of \(\smc{O}\) since it does not need to be a \(\mc{O}\)-submodule of \(L\). However, every fractional ideal \(\mf{F}\) of \(\mc{O}\) is a complete \(\smc{O}\)-lattice. Indeed, by \cref{cor:integral_closure_of_Dedekind_is_Dedekind} \(\mc{O}\) is a finitely generated \(\smc{O}\)-module and so \(\mf{F}\) is a finitely generated \(\smc{O}\)-module as well. Moreover, \(\mf{F}\) contains a basis of \(L/K\). For if \(\l_{1},\ldots,\l_{n}\) is a basis for \(L/K\) we may use \cref{prop:field_of_fractions_AKBL} to multiply by a nonzero element of \(\smc{O}\), if necessary, to ensure that this basis is contained in \(\mc{O}\). Choosing any nonzero \(\a \in \mf{F}\), \(\a\l_{1},\ldots,\a\l_{n}\) is a basis for \(L/K\) inside \(\mf{F}\).

    \begin{remark}
      A \(\smc{O}\)-lattice \(\mc{L}\) need not be a free \(\smc{O}\)-submodule of \(L\). Indeed, we are only guaranteed that \(\mc{L}\) is a finitely generated \(\smc{O}\)-submodule of \(L\) not that it is a free finitely generated \(\smc{O}\)-submodule of \(L\).
    \end{remark}
    
    Recall by \cref{lem:trace_is_nondegenerate} that there is a nondegenerate symmetric bilinear form on \(K\) given by
    \[
      \Trace_{L/K}:L \x L \to K \qquad (\l,\eta) \mapsto \Trace_{L/K}(\l\eta).
    \]
    We call this bilinear form the \textbf{trace form}\index{trace form} of \(L/K\). The trace form makes \(L\) into a nondegenerate inner product space over \(K\) and so every basis \(\l_{1},\ldots,\l_{n}\) admits a dual basis \(\l_{1}^{\vee},\ldots,\l_{n}^{\vee}\) with respect to \(\Trace_{L/K}\) defined by
    \[
      \Trace_{L/K}(\l_{i}\l_{j}^{\vee}) = \d_{i,j},
    \]
    for \(1 \le i,j \le n\). The trace form will allow us to introduce duals. Indeed, if \(\mf{F}\) is a fractional ideal \(\mc{O}\), the \textbf{dual}\index{dual} \(\mf{F}^{\vee}\) of \(\mf{F}\) is defined by
    \[
      \mf{F}^{\vee} = \{\l \in L:\Trace_{L/K}(\l\mf{F}) \subseteq \smc{O}\}.
    \]
    We say that \(\mf{F}\) is \textbf{self-dual}\index{self-dual} if \(\mf{F}^{\vee} = \mf{F}\). The following proposition shows that the dual \(\mf{F}^{\vee}\) is indeed a fractional ideal:

    \begin{proposition}\label{prop:dual_lattice_is_fractional}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and let \(\mf{F}\) be a fractional ideal of \(\mc{O}\). Then \(\mf{F}^{\vee}\) is also a fractional ideal of \(\mc{O}\) and
      \[
        \mf{F}^{\vee} = \mf{F}^{-1}\mc{O}^{\vee}.
      \]
    \end{proposition}
    \begin{proof}
      We will first show that \(\mf{F}^{\vee}\) is a finitely generated \(\smc{O}\)-submodule of \(L\). Let \(\l_{1},\ldots,\l_{n}\) be a basis for \(L/K\). Using \cref{prop:field_of_fractions_AKBL} to multiply by a nonzero element of \(\smc{O}\), if necessary, we can ensure that this basis is contained in \(\mc{O}\). Now choose some nonzero \(\a \in \mf{F} \cap \smc{O}\) (such an element exists since every prime \(\mf{P}\) of \(\mc{O}\) is above a prime \(\mf{p}\) of \(\smc{O}\) and \(\mf{F}\) is of the form \(\mf{F} = \frac{1}{\d}\mf{A}\) for some nonzero \(\d \in \mc{O}\) and integral ideal \(\mf{A}\) so that \(\mf{A} \subseteq \mf{F}\)). Now suppose \(\l \in \mf{F}^{\vee}\) and write \(\l = \k_{1}\l_{1}+\cdots+\k_{n}\l_{n}\) with \(\k_{i} \in K\) for \(1 \le i \le n\). Then linearity of the trace implies
      \[
        \sum_{1 \le j \le n}\a\k_{j}\Trace_{L/K}(\l_{i}\l_{j}) = \Trace_{L/K}(\a\l_{i}\l),
      \]
      for \(1 \le i \le n\). These \(n\) equations are equivalent to the identity
      \[
        \Trace_{L/K}(\l_{1},\ldots,\l_{n})\begin{pmatrix} \a\k_{1} \\ \vdots \\ \a\k_{n} \end{pmatrix} = \begin{pmatrix} \Trace_{L/K}(\a\l_{1}\l) \\ \vdots \\ \Trace_{L/K}(\a\l_{n}\l) \end{pmatrix}.
      \]
      Multiplying on the left by the adjugate \(\adj(\Trace_{L/K}(\l_{1},\ldots,\l_{n}))\) of \(\Trace_{L/K}(\l_{1},\ldots,\l_{n})\) and recalling that a matrix times its adjugate is its determinant times the identity, we see that
      \[
        d_{L/K}(\l_{1},\ldots,\l_{n})\begin{pmatrix} \a\k_{1} \\ \vdots \\ \a\k_{n} \end{pmatrix} = \adj(\Trace_{L/K}(\l_{1},\ldots,\l_{n}))\begin{pmatrix} \Trace_{L/K}(\a\l_{1}\l) \\ \vdots \\ \Trace_{L/K}(\a\l_{n}\l) \end{pmatrix}.
      \]
      Since \(\l_{1},\ldots,\l_{n}\) is a basis for \(L/K\) that is contained in \(\mc{O}\), the matrix \(\Trace_{L/K}(\l_{1},\ldots,\l_{n})\) has entries in \(\smc{O}\) by \cref{prop:trace_and_norm_AKBL} and therefore \(\adj(\Trace_{L/K}(\l_{1},\ldots,\l_{n}))\) does too. As \(\a\l_{i} \in \mf{F}\) (because \(\l_{j} \in \mc{O}\) for all \(j\)) and \(\l \in \mf{F}^{\vee}\), \cref{prop:trace_and_norm_AKBL} again implies \(\Trace_{L/K}(\a\l_{i}\l) \in \smc{O}\) for all \(i\). So the right-hand side has entires in \(\smc{O}\) and hence the left-hand side must as well. This means \(d_{L/K}(\l_{1},\ldots,\l_{n})\a\k_{i} \in A\) for all \(i\). Since \(\l \in \mf{F}^{\vee}\) was arbitrary, we have
      \[
        \a d_{L/K}(\l_{1},\ldots,\l_{n})\mf{F}^{\vee} \subseteq \mc{O}.
      \]
      As \(\mc{O}\) is a finitely generated \(\smc{O}\)-module by \cref{cor:integral_closure_of_Dedekind_is_Dedekind}, it follows that \(\mf{F}^{\vee}\) is a finitely generated \(\smc{O}\)-submodule of \(L\). Therefore \(\mf{F}^{\vee}\) is also a finitely generated \(\mc{O}\)-submodule of \(L\) if it is preserved under multiplication by \(\mc{O}\). Let \(\a \in \mc{O}\) and \(\b \in \mf{F}^{\vee}\). Then we must show \(\a\b \in \mf{F}^{\vee}\). To see this, observe that \(\Trace_{L/K}(\a\b\mf{F}) \subseteq \Trace_{L/K}(\b\mf{F}) \subseteq \smc{O}\) by \cref{prop:trace_and_norm_AKBL} since \(\a\mf{F} \subseteq \mf{F}\) and \(\b \in \mf{F}^{\vee}\). Therefore \(\a\b \in \mf{F}^{\vee}\) and hence \(\mf{F}^{\vee}\) is a fractional ideal proving the first statement. To prove the second statement we will show containment in both directions. For the forward containment, first suppose \(\a \in \mf{F}^{\vee}\) and \(\b \in \mf{F}\). Then \(\Trace_{L/K}(\a\b\mc{O}) \subseteq \Trace_{L/K}(\a\mf{F}) \subseteq \smc{O}\) by \cref{prop:trace_and_norm_AKBL} since \(\b\mc{O} \subseteq \mf{F}\) and \(\a \in \mf{F}^{\vee}\). Hence \(\a\b \in \mc{O}^{\vee}\) so that \(\mf{F}^{\vee}\mf{F} \subseteq \mc{O}^{\vee}\) and therefore \(\mf{F}^{\vee} \subseteq \mf{F}^{-1}\mc{O}^{\vee}\). This proves the forward containment. For the reverse containment, suppose \(\a \in \mf{F}^{-1}\) and \(\b \in \mc{O}^{\vee}\). Then \(\Trace_{L/K}(\a\b\mf{F}) \subseteq \Trace_{L/K}(\b\mc{O}) \subseteq \smc{O}\) by \cref{prop:trace_and_norm_AKBL} since \(\a\mf{F} \subseteq \mc{O}\) and \(\b \in \mc{O}^{\vee}\). Thus \(\a\b \in \mf{F}^{\vee}\) implying \(\mf{F}^{-1}\mc{O}^{\vee} \subseteq \mf{F}^{\vee}\) and proving the reverse containment. This completes the proof.
    \end{proof}

    As the dual \(\mf{F}^{\vee}\) is a fractional ideal by \cref{prop:dual_lattice_is_fractional}, it is also a complete \(\smc{O}\)-lattice. As we might hope, localization respects duals:

    \begin{proposition}\label{prop:localization_of_dual_is_dual_of_localization}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and let \(D \subseteq \smc{O}-\{0\}\) be a multiplicative subset. Then for any fractional ideal \(\mf{F}\) of \(\mc{O}\), we have
      \[
        (\mf{F}D^{-1})^{\vee} = (\mf{F}^{\vee})D^{-1}.
      \]
    \end{proposition}
    \begin{proof}
      For the forward containment, suppose \(\l \in (\mf{F}D^{-1})^{\vee}\). Then \(\Trace_{L/K}(\l\mf{F}D^{-1}) \subseteq \smc{O}D^{-1}\). As \(D \subset K\), linearity of the trace implies \(\l = \frac{\a}{\d}\) with \(\Trace_{L/K}(\a\mf{F})\d \subseteq \smc{O}D^{-1}\) so that \(\a \in \mf{F}^{\vee}\) and \(\d \in D\). Hence \(\l \in (\mf{F}^{\vee})D^{-1}\) and the forward containment follows. For the reverse containment, suppose \(\frac{\a}{\d} \in (\mf{F}^{\vee})D^{-1}\). Then \(\a \in \mf{F}^{\vee}\) so that \(\Trace_{L/K}(\a\mf{F}) \subseteq \smc{O}\) and \(\d \in D\). As \(D \subset K\), linearity of the trace implies \(\Trace_{L/K}(\l\mf{F}) \subseteq \smc{O}D^{-1}\) with \(\l = \frac{\a}{\d}\). Hence \(\frac{\a}{\d} \in (\mf{F}D^{-1})^{\vee}\) and the reverse containment holds.
    \end{proof}
    
    We will now introduce the different and the discriminant. We define the \textbf{complement}\index{complement} \(\mf{C}_{\mc{O}/\smc{O}}\) of \(\mc{O}/\smc{O}\) by
    \[
      \mf{C}_{\mc{O}/\smc{O}} = \mc{O}^{\vee}.  
    \]
    This is a fractional ideal by \cref{prop:dual_lattice_is_fractional}. The \textbf{different}\index{different} \(\mf{D}_{\mc{O}/\smc{O}}\) of \(\mc{O}/\smc{O}\) is defined to be the inverse of the complement \(\mf{C}_{\mc{O}/\smc{O}}\):
    \[
      \mf{D}_{\mc{O}/\smc{O}} = (\mc{O}^{\vee})^{-1}.  
    \]
    As \(\mc{O} \subseteq \mc{O}^{\vee}\) by \cref{prop:trace_and_norm_AKBL}, it follows from \cref{prop:explicit_inverse_ideal} that \(\mf{D}_{\mc{O}/\smc{O}}\) is an integral ideal and
    \[
      \mf{D}_{\mc{O}/\smc{O}} = \{\l \in L: \l\mc{O}^{\vee} \subseteq \mc{O}\}.  
    \]
    Also, \cref{lem:cancellation_isomorphism} gives the first isomorphism in the following chain:
    \begin{equation}\label{equ:different_isomorphism_chain}
      \mc{O}/\mf{D}_{\mc{O}/\smc{O}} \cong \mf{D}_{\mc{O}/\smc{O}}^{-1}/\mc{O} \cong \mc{O}^{\vee}/\mc{O}.
    \end{equation}
    From this chain of isomorphisms we find that
    \[
      \mf{D}_{\mc{O}/\smc{O}} \subseteq \mc{O} \subseteq \mc{O}^{\vee}.
    \]
    Therefore the different \(\mf{D}_{\mc{O}/\smc{O}}\) is a measure of how much \(\mc{O}\) fails to be self-dual for if \(\mf{D}_{\mc{O}/\smc{O}} = \mc{O}^{\vee}\) then \(\mc{O}\) must be self-dual. Moreover, by \cref{prop:dual_lattice_is_fractional} we can express the dual fractional ideal \(\mf{F}^{\vee}\) of a fractional ideal \(\mf{F}\) of \(\smc{O}\) in terms of the different as
    \[
      \mf{F}^{\vee} = \mf{F}^{-1}\mf{D}_{\mc{O}/\smc{O}}^{-1}.
    \]
    Now for the discriminant. We define the \textbf{discriminant}\index{discriminant} \(\mf{d}_{\mc{O}/\smc{O}}\) of \(\mc{O}/\smc{O}\) to be the ideal of \(\smc{O}\) generated by all discriminants \(d_{L/K}(\a_{1},\ldots,\a_{n})\) as \(\a_{1},\ldots,\a_{n}\) run over all bases of \(L/K\) contained in \(\mc{O}\). Note that \(\mf{d}_{\mc{O}/\smc{O}}\) is necessarily an integral ideal. Recall that if \(\mc{O}/\smc{O}\) admits an integral then \(\mc{O}\) is a free \(\smc{O}\)-module of rank \(n\). In this case, bases of \(L/K\) contained in \(\mc{O}\) are precisely the integral bases of \(\mc{O}/\smc{O}\). Then
    \[
      \mf{d}_{\mc{O}/\smc{O}} = d_{\smc{O}}(\mc{O})\smc{O},
    \]
    so that the discriminant \(\mf{d}_{\mc{O}/\smc{O}}\) is generated by the discriminant \(d_{\smc{O}}(\mc{O})\). In particular, \(\mf{d}_{\mc{O}/\smc{O}}\) is a principal integral ideal if \(\mc{O}/\smc{O}\) admits an integral basis. By \cref{thm:integral_basis_AKBL} this will hold if \(\smc{O}\) is a principal ideal domain but not necessarily in general. The different and discriminant also respect localization:

    \begin{proposition}\label{prop:different_and_discriminant_respect_localization}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and let \(D \subseteq \smc{O}-\{0\}\) be a multiplicative subset. Then
      \[
        \mf{D}_{\mc{O}D^{-1}/\smc{O}D^{-1}} = \mf{D}_{\mc{O}/\smc{O}}D^{-1} \quad \text{and} \quad \mf{d}_{\mc{O}D^{-1}/\smc{O}D^{-1}} = \mf{d}_{\mc{O}/\smc{O}}D^{-1}
      \]
    \end{proposition}
    \begin{proof}
      For the first identity, it is equivalent to show
      \[
        ((\mc{O}D^{-1})^{\vee})^{-1} = (\mc{O}^{\vee})^{-1}D^{-1},
      \]
      by definition of the different. Applying \cref{prop:localization_of_inverse_is_inverse_of_localization,prop:localization_of_dual_is_dual_of_localization}, we see that the right-had side is equal to the left-hand side as desired. For the second identity, we will show containment in both directions. For the forward inclusion, suppose \(\frac{\a_{1}}{\d_{1}},\ldots,\frac{\a_{n}}{\d_{n}}\) is a basis of \(L/K\) contained in \(\mc{O}D^{-1}\). Setting \(\d = \d_{1} \cdots \d_{n}\), we see that \(\frac{\a_{1}\d}{\d_{1}},\ldots,\frac{\a_{n}\d}{\d_{n}}\) is a basis of \(L/K\) contained in \(\mc{O}\). As \(D \subset K\) and \(d_{L/K}\left(\frac{\a_{1}\d}{\d_{1}},\ldots,\frac{\a_{n}\d}{\d_{n}}\right) \in \mf{d}_{\mc{O}/\smc{O}}\), linearity of the trace implies \(d_{L/K}\left(\frac{\a_{1}}{\d_{1}},\ldots,\frac{\a_{n}}{\d_{n}}\right) \in \mf{d}_{\mc{O}/\smc{O}}D^{-1}\). This shows the forward containment. For the reverse containment, suppose \(\a_{1},\ldots,\a_{n}\) is a basis of \(L/K\) contained in \(\mc{O}\) and let \(\d \in D^{-1}\). Then \(\frac{\a_{1}}{\d},\ldots,\frac{\a_{n}}{\d}\) is a basis for \(L/K\) contained in \(\mc{O}D^{-1}\). As \(D \subseteq K\) and \(d_{L/K}\left(\frac{\a_{1}}{\d},\ldots,\frac{\a_{n}}{\d}\right) \in \mf{d}_{\mc{O}D^{-1}/\smc{O}D^{-1}}\), linearity of the trace again implies \(d_{L/K}(\a_{1}\ldots,\a_{n}) \in \mf{d}_{\mc{O}D^{-1}/\smc{O}D^{-1}}\) proving the reverse containment.
    \end{proof}

    We want to show that a prime \(\mf{P}\) of \(\mc{O}\) ramifies in \(\mc{O}/\smc{O}\) if and only if it divides the different \(\mf{D}_{\mc{O}/\smc{O}}\) provided the residue class extensions are separable. We first require a lemma:

    \begin{lemma}\label{lem:different_containment_lemma}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and let \(\mf{A}\) be an integral ideal of \(\mc{O}\). Then \(\mf{A} \mid \mf{D}_{\mc{O}/\smc{O}}\) if and only if \(\Trace_{L/K}(\mf{A}^{-1}) \subseteq \smc{O}\).
    \end{lemma}
    \begin{proof}
      \(\mf{A}\) divides \(\mf{D}_{\mc{O}/\smc{O}}\) if and only if \(\mf{D}_{\mc{O}/\smc{O}} \subseteq \mf{A}\). This equivalent to \((\mc{O}^{\vee})^{-1} \subseteq \mf{A}\) and inverting shows the further equivalence \(\mf{A}^{-1} \subseteq \mc{O}^{\vee}\). This last containment is equivalent to \(\Trace_{L/K}(\mf{A}^{-1}) \subseteq \smc{O}\) which completes the proof.
    \end{proof}

    With \cref{lem:different_containment_lemma} in hand, we can now prove our claim:

    \begin{theorem}\label{thm:ramifies_if_and_only_if_divides_the_different}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and assume that all residue class extensions are separable. Then a prime \(\mf{P}\) of \(\mc{O}\) ramifies in \(\mc{O}/\smc{O}\) if and only if \(\mf{P}\) divides \(\mf{D}_{\mc{O}/\smc{O}}\). In particular, if \(\mf{P}\) is above \(\mf{p}\) then the following hold:
      \begin{enumerate}[label*=(\roman*)]
        \item \(\mf{P}^{e_{\mf{p}}(\mf{P})} \mid \mf{D}_{\mc{O}/\smc{O}}\) if and only if \(e_{\mf{p}}(\mf{P}) \equiv 0 \tmod{\mf{p}}\).
        \item \(\mf{P}^{e_{\mf{p}}(\mf{P})-1} \mid\mid \mf{D}_{\mc{O}/\smc{O}}\) if and only if \(e_{\mf{p}}(\mf{P}) \not\equiv 0 \tmod{\mf{p}}\).
      \end{enumerate}
    \end{theorem}
    \begin{proof}
      We first show that (i) and (ii) together imply that \(\mf{P}\) ramifies in \(\mc{O}/\smc{O}\) if and only if \(\mf{P} \mid \mf{D}_{\mc{O}/\smc{O}}\). Since the residue class extensions are separable by assumption, \(\mf{P}\) ramifies in \(\mc{O}/\smc{O}\) if and only if \(e_{\mf{p}}(\mf{P}) \ge 2\). Therefore (i) and (ii) together show that \(\mf{P}\) ramifies in \(\mc{O}/\smc{O}\) if and only if \(\mf{P} \mid \mf{D}_{\mc{O}/\smc{O}}\) (note that \(1 \not\equiv 0 \tmod{\mf{p}}\) for any prime \(\mf{p}\)). Therefore it remains to prove (i) and (ii). In view of \cref{prop:ramification_setup_respects_localization,prop:different_and_discriminant_respect_localization}, it suffices to assume \(\mc{O}/\smc{O}\) is a local Dedekind extension. Therefore \(\smc{O}\) is a discrete valuation ring, \(\mc{O}\) is a principal ideal domain, and \(\mc{O}/\smc{O}\) admits an integral basis \(\a_{1},\ldots,\a_{n}\) making \(\mc{O}\) a free \(\smc{O}\)-module of rank \(n\). We will first show \(\mf{P}^{e_{\mf{p}}(\mf{P})-1} \mid \mf{D}_{\mc{O}/\smc{O}}\) independent of \(e_{\mf{p}}(\mf{P})\) modulo \(\mf{p}\) (note that this is satisfied by both (i) and (ii)). To this end, write \(\mf{p}\mc{O} = \mf{P}^{e_{\mf{p}}(\mf{P})-1}\mf{A}\) for some integral ideal \(\mf{A}\) of \(\mc{O}\) so that \(\mf{P} \mid\mid \mf{A}\). By \cref{lem:different_containment_lemma}, \(\mf{P}^{e_{\mf{p}}(\mf{P})-1} \mid \mf{D}_{\mc{O}/\smc{O}}\) if and only if \(\Trace_{L/K}(\mf{P}^{1-e_{\mf{p}}(\mf{P})}) \subseteq \smc{O}\). Since \(\mf{P}^{1-e_{\mf{p}}(\mf{P})} = \mf{p}^{-1}\mf{A}\), linearity of the trace implies that this is equivalent to \(\Trace_{L/K}(\mf{A}) \subseteq \mf{p}\). By \cref{prop:trace_and_norm_reduce_for_integral_basis}, \(\Trace_{K/L}(\mf{A}) = \Trace_{\mc{O}/\smc{O}}(\mf{A})\) and so it is further equivalent to show
      \[
        \Trace_{\mc{O}/\smc{O}}(\mf{A}) \subseteq \mf{p},
      \]
      Let \(\a \in \mf{A}\) and \(T_{\a}\) be the multiplication by \(\a\) map. Then \(\mf{p}\mc{O}\) is \(T_{\a}\)-invariant because it is an ideal of \(\mc{O}\). This induces a multiplication by \(\conj{\a}\) map \(T_{\conj{\a}}\) on \(\mc{O}/\mf{p}\mc{O}\) as a \(\F_{\mf{p}}\)-vector space. As the classes \(\conj{\a_{1}},\ldots,\conj{\a_{n}}\) are a basis for \(\mc{O}/\mf{p}\mc{O}\) as a \(\F_{\mf{p}}\)-vector space, it follows that
      \[
        \Trace_{\mc{O}/\smc{O}}(\a) \equiv \Trace_{(\mc{O}/\mf{p}\mc{O})/\F_{\mf{p}}}(\conj{\a}) \tmod{\mf{p}}.
      \]
      Therefore it is yet further equivalent to show
      \[
        \Trace_{(\mc{O}/\mf{p}\mc{O})/\F_{\mf{p}}}(\conj{\a}) \equiv 0 \tmod{\mf{p}},
      \]
      for all \(\a \in \mf{A}\). To prove this, observe that \(\conj{\a}\) runs over to the subring \(\mf{A}/\mf{p}\mc{O}\) of \(\mc{O}/\mf{p}\mc{O}\) as \(\a\) runs over \(\mf{A}\). By construction, \(\mf{A}\) is divisible by every prime factor of \(\mf{p}\mc{O}\) and so a power, say \(k\), of \(\mf{A}\) is divisible by \(\mf{p}\mc{O}\). But this means \(T_{\conj{\a}}^{k}\) is the zero operator so that it is nilpotent. As nilpotent maps have trace zero, \(\Trace_{(\mc{O}/\mf{p}\mc{O})/\F_{\mf{p}}}(\conj{\a}) = 0\). But then \(\Trace_{\mc{O}/\smc{O}}(\a) \equiv 0 \tmod{p}\) and, as \(\a\) was arbitrary, the claim is justified. We now prove (i) and (ii):
      \begin{enumerate}[label*=(\roman*)]
        \item Begin by writing \(\mf{p}\mc{O} = \mf{P}^{e_{\mf{p}}(\mf{P})}\mf{A}\) for some integral ideal \(\mf{A}\) of \(\mc{O}\) so that \(\mf{A}\) is relatively prime to \(\mf{P}\). Arguing as before, we find that \(\mf{P}^{e_{\mf{p}}(\mf{P})} \mid \mf{D}_{\mc{O}/\smc{O}}\) if and only if
        \[
          \Trace_{(\mc{O}/\mf{p}\mc{O})/\F_{\mf{p}}}(\conj{\a}) = 0,
        \]
        for all \(\a \in \mf{A}\). Since \(\mf{P}^{e_{\mf{p}}(\mf{P})}\) and \(\mf{A}\) are relatively prime, the Chinese remainder theorem implies
        \[
          \mc{O}/\mf{p}\mc{O} \cong (\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})}) \op (\mc{O}/\mf{A}).
        \]
        So there exists \(\b,\g \in \mc{O}\) such that \(\b \equiv \a \tmod{\mf{P}^{e_{\mf{p}}(\mf{P})}}\) and \(\g \equiv \a \tmod{\mf{A}}\). Then \cref{equ:trace_and_norm_direct_sums} implies
        \[
          \Trace_{(\mc{O}/\mf{p}\mc{O})/\F_{\mf{p}}}(\conj{\a}) = \Trace_{(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})})/\F_{\mf{p}}}(\conj{\b})+\Trace_{(\mc{O}/\mf{A})/\F_{\mf{p}}}(\conj{\g}).
        \]
        As \(\a \in \mf{A}\), \(\conj{\g} = 0\) and so \(\Trace_{(\mc{O}/\mf{A})/\F_{\mf{p}}}(\conj{\g}) = 0\). Therefore it is further equivalent to show
        \[
          \Trace_{(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})})/\F_{\mf{p}}}(\conj{\b}) = 0,
        \]
        for all \(\b \in \mc{O}\). We will show that this occurs if and only if \(e_{\mf{p}}(\mf{P}) \equiv 0 \tmod{\mf{p}}\). So let \(\b \in \mc{O}\). By \cref{lem:quotient_by_prime_power_isomorphism}, we have an isomorphism
        \[
          \mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})} \cong \bigop_{0 \le e \le e_{\mf{p}}(\mf{P})-1}\mc{O}/\mf{P}.
        \]
        Therefore there exists \(\b_{e} \in \mc{O}\) such that \(\b \equiv \b_{e} \tmod{\mf{P}}\) for all \(e\). But then \(\Trace_{\F_{\mf{P}}/\F_{\mf{p}}}(\conj{\b}_{e}) = \Trace_{\F_{\mf{P}}/\F_{\mf{p}}}(\conj{\b})\) for all \(e\), and combining with \cref{equ:trace_and_norm_direct_sums} gives
        \[
          \Trace_{(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})})/\F_{\mf{p}}}(\conj{\b}) = e_{\mf{p}}(\mf{P})\Trace_{\F_{\mf{P}}/\F_{\mf{p}}}(\conj{\b}),
        \]
        which we recall is an element of \(\F_{\mf{p}}\). As the residue class extensions are assumed to be separable, \cref{lem:trace_is_nondegenerate} implies that \(\Trace_{\F_{\mf{P}}/\F_{\mf{p}}}(\conj{\b})\) cannot be zero for all \(\b \in \mc{O}\). So it must be the case that \(\Trace_{(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})})/\F_{\mf{p}}}(\conj{\b}) = 0\) for all \(\b \in \mc{O}\) if and only if \(e_{\mf{p}}(\mf{P}) \equiv 0 \tmod{\mf{p}}\). This proves (i).
        \item As we have already shown \(\mf{P}^{e_{\mf{p}}(\mf{P})-1} \mid \mf{D}_{\mc{O}/\smc{O}}\), (ii) follows from (i).
      \end{enumerate}
    \end{proof}

    Note that \cref{thm:ramifies_if_and_only_if_divides_the_different} does not tell us the degree to which \(\mf{P}\) divides \(\mf{D}_{\mc{O}/\smc{O}}\) in the case \(e_{\mf{p}}(\mf{P}) \equiv 0 \tmod{p}\). It only tells us that the degree is at least \(e_{\mf{p}}(\mf{P})\). Also, only finitely many primes can ramify in \(L\) as a corollary of \cref{thm:ramifies_if_and_only_if_divides_the_different}:

    \begin{corollary}\label{cor:finitely_many_primes_ramify_L}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a finite separable extension \(L/K\) and assume that all residue class extensions are separable. Then only finitely many primes ramify in \(L\).
    \end{corollary}
    \begin{proof}
      There are only finitely many prime factors of \(\mf{D}_{\mc{O}/\smc{O}}\) by the prime factorization of fractional ideals. Therefore only finitely many primes can ramify in \(L\) by \cref{thm:ramifies_if_and_only_if_divides_the_different}.
    \end{proof}

    Similarly, a prime \(\mf{p}\) of \(\smc{O}\) ramifies in \(\mc{O}/\smc{O}\) if and only if it divides the discriminant \(\mf{d}_{\mc{O}/\smc{O}}\) provided the residue class extensions are separable:

    \begin{theorem}\label{thm:ramifies_if_and_only_if_divides_the_discriminant}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and assume that all residue class extensions are separable. Then a prime \(\mf{p}\) of \(\smc{O}\) ramifies in \(\mc{O}/\smc{O}\) if and only if \(\mf{p}\) divides \(\mf{d}_{\mc{O}/\smc{O}}\).
    \end{theorem}
    \begin{proof}
      As the residue class extensions are assumed to be separable, \(\mf{p}\) ramifies in \(\mc{O}/\smc{O}\) if and only if \(e_{\mf{p}}(\mf{P}) \ge 2\) for some prime \(\mf{P}\) above \(\mf{p}\). In view of \cref{prop:ramification_setup_respects_localization,prop:different_and_discriminant_respect_localization}, it suffices to assume \(\mc{O}/\smc{O}\) is a local Dedekind extension. Therefore \(\smc{O}\) is a discrete valuation ring, \(\mc{O}\) is a principal ideal domain, and \(\mc{O}/\smc{O}\) admits an integral basis \(\a_{1},\ldots,\a_{n}\) making \(\mc{O}\) a free \(\smc{O}\)-module of rank \(n\). Then, as we have see, \(\mf{d}_{\mc{O}/\smc{O}}\) is principal and
      \[
        \mf{d}_{\mc{O}/\smc{O}} = d_{\smc{O}}(\mc{O})\smc{O}.
      \]
      Therefore \(\mf{p}\) divides \(\mf{d}_{\mc{O}/\smc{O}}\) if and only if \(d_{\smc{O}}(\mc{O}) \equiv 0 \tmod{\mf{p}}\). Since \(\conj{\a_{1}},\ldots,\conj{\a_{n}}\) is a basis for \(\mc{O}/\mf{p}\mc{O}\) as a \(\F_{\mf{p}}\)-vector space, it follows that
      \[
        d_{\smc{O}}(\mc{O}) \equiv d_{\F_{\mf{p}}}(\mc{O}/\mf{p}\mc{O}) \pmod{\mf{p}}.
      \]
      So \(\mf{p}\) divides \(\mf{d}_{\mc{O}/\smc{O}}\) if and only if \(d_{\F_{\mf{p}}}(\mc{O}/\mf{p}\mc{O}) = 0\). Now suppose \(\mf{p}\mc{O}\) has prime factorization
      \[
        \mf{p}\mc{O} = \mf{P}_{1}^{e_{\mf{p}}(\mf{P}_{1})} \cdots \mf{P}_{r}^{e_{\mf{p}}(\mf{P}_{r})}.
      \]
      As the \(\mf{P}_{1}^{e_{\mf{p}}(\mf{P}_{1})},\ldots,\mf{P}_{r}^{e_{\mf{p}}(\mf{P}_{r})}\) are pairwise relatively prime, the Chinese remainder theorem gives
      \[
        \mc{O}/\mf{p}\mc{O} \cong \bigop_{1 \le i \le r} \mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}.
      \]
      Then \cref{prop:discriminant_and_direct_sums} further implies
      \[
        d_{\F_{\mf{p}}}(\mc{O}/\mf{p}\mc{O}) = \prod_{1 \le i \le r}d_{\F_{\mf{p}}}(\mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}),
      \]
      Therefore \(d_{\F_{\mf{p}}}(\mc{O}/\mf{p}\mc{O}) = 0\) if and only if \(d_{\F_{\mf{p}}}(\mc{O}/\mf{P}_{i}^{e_{\mf{p}}(\mf{P}_{i})}) = 0\) for some \(i\). We will prove that this occurs if and only if \(e_{\mf{p}}(\mf{P}_{i}) \ge 2\) which will complete the proof because this is exactly when \(\mf{p}\) ramifies. So let \(\mf{P}\) be above \(\mf{p}\) and first suppose \(e_{\mf{p}}(\mf{P}) \ge 2\). Then we need to show \(d_{\F_{\mf{p}}}(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})}) = 0\). By uniqueness of prime factorizations of fractional ideals, there exists \(\b_{1} \in \mf{P}^{e_{\mf{p}}(\mf{P})-1}-\mf{P}^{e_{\mf{p}}(\mf{P})}\). Then \(\b_{1}^{2} \in \mf{P}^{2(e_{\mf{p}}(\mf{P})-1)} \subseteq \mf{P}^{e_{\mf{p}}(\mf{P})}\) because \(e_{\mf{p}}(\mf{P}) \ge 2\). By construction, \(\conj{\b_{1}}\) in \(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})}\) is nonzero and such that \(\conj{\b_{1}}^{2} = 0\). Since \(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})}\) is a \(\F_{\mf{p}}\)-vector space of dimension \(f_{\mf{p}}(\mf{P})\), there exists a basis of the form \(\conj{\b_{1}},\ldots,\conj{\b_{f_{\mf{p}}(\mf{P})}}\). Now
      \[
        \Trace_{(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})})/\F_{\mf{p}}}(\conj{\b_{1}\b_{j}}) = 0,
      \]
      for \(1 \le j \le f_{\mf{p}}(\mf{P})\) since \(T_{\conj{\b_{1}}\conj{\b_{j}}}\) is nilpotent because \(T_{\conj{\b_{1}}\conj{\b_{j}}}^{2}\) is the zero operator as \(\conj{\b_{1}}^{2} = 0\). But then the first row of \(\Trace_{(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})})/\F_{\mf{p}}}(\conj{\b_{1}},\ldots,\conj{\b_{f_{\mf{p}}(\mf{P})}})\) is zero and hence \(d_{\F_{\mf{p}}}(\mc{O}/\mf{P}^{e_{\mf{p}}(\mf{P})}) = 0\). Now suppose \(e_{\mf{p}}(\mf{P}) = 1\). Then it remains to show \(d_{\F_{\mf{p}}}(\F_{\mf{P}}) \neq 0\). Since the residue class extension \(\F_{\mf{P}}/\F_{\mf{p}}\) is separable by assumption, \cref{prop:discriminant_not_zero} implies \(d_{\F_{\mf{p}}}(\F_{\mf{P}}) \neq 0\). This completes the proof.
    \end{proof}

    As a corollary of \cref{thm:ramifies_if_and_only_if_divides_the_discriminant} we see that only finitely many primes can ramify in \(K\):

    \begin{corollary}\label{cor:finitely_many_primes_ramify_K}
      Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) separable extension \(L/K\) and assume that all residue class extensions are separable. Then only finitely many primes ramify in \(K\).
    \end{corollary}
    \begin{proof}
      There are only finitely many prime factors of \(\mf{d}_{\mc{O}/\smc{O}}\) by the prime factorization of fractional ideals. Therefore only finitely many primes can ramify in \(K\) by \cref{thm:ramifies_if_and_only_if_divides_the_discriminant}.
    \end{proof}

    Now consider the case of a number field \(K\) of degree \(n\). The \textbf{complement}\index{complement} \(\mf{C}_{K}\) of \(K\) is the complement of \(\mc{O}_{K}/\Z\), the \textbf{different}\index{different} \(\mf{D}_{K}\) of \(K\) is the different of \(\mc{O}_{K}/\Z\), and the \textbf{discriminant}\index{discriminant} \(\mf{d}_{K}\) of \(K\) is the discriminant of \(\mc{O}_{K}/\Z\). Since \(\Z\) is a principal ideal domain, the \(\mf{d}_{K}\) is related to the discriminant \(\D_{K}\) by
    \[
      \mf{d}_{K} = \D_{K}\mc{O}_{K}.
    \]
    As all of the residue class extensions are separable, it follows from \cref{thm:ramifies_if_and_only_if_divides_the_different,thm:ramifies_if_and_only_if_divides_the_discriminant} that a prime of \(K\) ramifies in \(\mc{O}_{K}/\Z\) if and only if it divides \(\mf{D}_{K}\) and a prime of \(\Q\) ramifies in \(\mc{O}_{K}/\Z\) if and only if it divides \(|\D_{K}|\). Moreover, finitely many primes of \(K\) and \(\Q\) ramify by \cref{cor:finitely_many_primes_ramify_L,cor:finitely_many_primes_ramify_K}.
  \section{The Ideal Norm}
    Let \(\mc{O}/\smc{O}\) be a Dedekind extension of a degree \(n\) extension \(L/K\). If \(\mf{P}\) a prime of \(L\) is above the prime \(\mf{p}\) of \(K\), we define the \textbf{norm}\index{norm} \(\Norm_{\mc{O}/\smc{O}}(\mf{P})\) of \(\mf{P}\) by
    \[
      \Norm_{\mc{O}/\smc{O}}(\mf{P}) = \mf{p}^{f_{\mf{p}}(\mf{P})}.
    \]
    Setting \(\Norm_{\mc{O}/\smc{O}}(\mc{O}) = \smc{O}\), we extend this multiplicatively to all fractional ideals of \(\mc{O}\). This induces a homomorphism
    \[
      \Norm_{\mc{O}/\smc{O}}:I_{\mc{O}} \to I_{\smc{O}} \qquad \mf{P}_{1}^{e_{1}} \cdots \mf{P}_{r}^{e_{r}} \mapsto \mf{p}_{1}^{e_{1}f_{\mf{p}_{1}}(\mf{P}_{1})} \cdots \mf{p}_{r}^{e_{r}f_{\mf{p}_{r}}(\mf{P}_{r})},
    \]
    called the \textbf{ideal norm}\index{ideal norm} of \(\mc{O}/\smc{O}\). It follows from the fundamental equality and multiplicatively of the ideal norm that
    \[
      \Norm_{\mc{O}/\smc{O}}(\mf{f}\mc{O}) = \mf{f}^{n},
    \]
    for any fractional ideal \(\mf{f}\) of \(\smc{O}\). 

    \begin{remark}
      The ideal norm can be though of as an almost inverse to the mapping that sends a fractional ideal \(\mf{f}\) of \(\smc{O}\) to the fractional ideal \(\mf{f}\mc{O}\) of \(\mc{O}\).
    \end{remark}

    In the case of a degree \(n\) number field \(K\), the \textbf{ideal norm}\index{ideal norm} \(\Norm_{K}\) of \(K\) is the ideal norm of \(\mc{O}_{K}/\Z\). As \(\Z\) is a principal ideal domain, every fractional ideal is principal. Therefore, \(\Norm_{K}(\mf{f})\) is generated by an \(r_{\mf{f}} \in \Q^{\ast}\) for every fractional ideal \(\mf{f}\) of \(\mc{O}_{K}\). We define the \textbf{norm}\index{norm} \(\Norm_{K}(\mf{f})\) of \(\mf{f}\) by
    \[
      \Norm_{K}(\mf{f}) = |r_{\mf{f}}|.
    \]
    Since the ideal norm is multiplicative, we obtain a homomorphism
    \[
      \Norm_{K}:I_{K} \to \Q^{\ast} \qquad \mf{f} \mapsto |r_{\mf{f}}|,
    \]
    called the \textbf{norm}\index{norm} of \(K\). For an integral ideal \(\mf{a}\), there is a simple relationship between the norm \(\mf{a}\) and the quotient \(\mc{O}_{K}/\mf{a}\):

    \begin{proposition}\label{prop:norm_and_field_norms_are_identical}
      Let \(K\) be a number field of degree \(n\). Then for any integral ideal \(\mf{a}\), we have
      \[
        \Norm_{K}(\mf{a}) = |\mc{O}_{K}/\mf{a}|.
      \]
      Moreover, any \(\a \in \mc{O}_{K}\) satisfies
      \[
        \Norm_{K}(\a\mc{O}_{K}) = |\Norm_{K}(\a)|.
      \]
    \end{proposition}
    \begin{proof}
      Since \(K\) admits an integral basis, \(\mc{O}_{K}\) is a free abelian group of rank \(n\) as is any fractional ideal. In particular, \(|\mc{O}_{K}/\mf{a}|\) is finite. As the Chinese remainder theorem implies
      \[
        |\mc{O}_{K}/\mf{a}\mf{b}| = |\mc{O}_{K}/\mf{a}||\mc{O}_{K}/\mf{b}|,
      \]
      whenever \(\mf{a}\) and \(\mf{b}\) are relatively prime, it suffices to prove the claim in the case of a prime power. So let \(\mf{p}\) be a prime of \(\mc{O}_{K}\) above \(p\) and \(e \ge 1\). On the one hand, \(\Norm_{K}(\mf{p}^{e}) = p^{ef_{p}(\mf{p})}\) by definition of the norm. On the other hand, \cref{lem:quotient_by_prime_power_isomorphism} implies \(\mc{O}_{K}/\mf{p}^{e}\) is an \(\F_{p}\)-vector space of dimension \(ef_{p}(\mf{p})\) so that \(|\mc{O}_{K}/\mf{p}^{e}| = p^{ef_{p}(\mf{p})}\). Together, we have
      \[
        \Norm_{K}(\mf{p}^{e}) = |\mc{O}_{K}/\mf{p}^{e}|,
      \]
      and the first statement follows. For the second statement, we just have to show that \(|\Norm_{K}(\a)| = |\mc{O}_{K}/\a\mc{O}_{K}|\). To this end, let \(\a_{1},\ldots,\a_{n}\) be an integral basis for \(K\). Writing
      \[
        \a = \sum_{1 \le i \le n}a_{i}\a_{i},
      \]
      with \(a_{i} \in \Z\), we see that \(a_{1}\a_{1},\ldots,a_{n}\a_{n}\) is a basis for \(\a\mc{O}_{K}\). In particular, the base change matrix from \(\a_{1},\ldots,\a_{n}\)  to this basis is a diagonal matrix with the \(a_{i}\) on the diagonal. Then on the one hand, we have \(|\mc{O}_{K}/\a\mc{O}_{K}| = |a_{1} \cdots a_{n}|\) by \cref{prop:base_change_quotient_determinant} again. On the other hand, the multiplication by \(\a\) map in terms of the basis \(a_{1}\a_{1},\ldots,a_{n}\a_{n}\) has matrix representation
      \[
        \begin{pmatrix} a_{1} & & \\ & \ddots & \\ & & a_{n} \end{pmatrix},
      \]
      and so \(\Norm_{K}(\a) = a_{1} \cdots a_{n}\). Hence
      \[
        |\mc{O}_{K}/\a\mc{O}_{K}| = |\Norm_{K}(\a)|,
      \]
      as desired.
    \end{proof}

    As a consequence of \cref{prop:norm_and_field_norms_are_identical} and Lagrange's theorem, \(\Norm_{K}(\mf{a}) \in \mf{a}\) for any integral ideal \(\mf{a}\) and therefore for every fractional ideal as well (recall every such fractional ideal is of the form \(\frac{1}{\d}\mf{a}\) for some nonzero \(\d \in \Z\) and integral ideal \(\mf{a}\)). Computing the norm of the discriminant \(\D_{K}\) is also an easy matter:

    \begin{proposition}\label{prop:norm_of_different_is_discriminant}
      Let \(K\) be a number field of degree \(n\). Then
      \[
        \Norm_{K}(\mf{D}_{K}) = |\D_{K}|.
      \]
    \end{proposition}
    \begin{proof}
      From \cref{equ:different_isomorphism_chain} we have an isomorphism
      \[
        \mc{O}_{K}/\mf{D}_{K} \cong \mc{O}_{K}^{\vee}/\mc{O}_{K}.
      \]
      Therefore \(\Norm_{K}(\mf{D}_{K}) = |\mc{O}_{K}^{\vee}/\mc{O}_{K}|\) by \cref{prop:norm_and_field_norms_are_identical}. Now let \(\a_{1},\ldots,\a_{n}\) be an integral basis for \(\mc{O}_{K}\). Then the dual basis \(\a_{1}^{\vee},\ldots,\a_{n}^{\vee}\) is a basis for \(\mc{O}_{K}^{\vee}\) and we have
      \[
        \a_{i}^{\vee} = \sum_{1 \le j \le n}\Trace_{K}(\a_{i}\a_{j})\a_{j}.
      \]
      But then the base change matrix from \(\a_{1},\ldots,\a_{n}\) to \(\a_{1}^{\vee},\ldots,\a_{n}^{\vee}\) is \(\Trace_{K}(\a_{1},\ldots,\a_{n})\). The claim follows by \cref{prop:base_change_quotient_determinant} and the definition of \(\D_{K}\).
    \end{proof}

    We can now compute the norm of a dual ideal:

    \begin{corollary}\label{cor:norm_of_different}
      Let \(K\) be a number field and \(\mf{f}\) be a fractional ideal. Then
      \[
        \Norm_{K}(\mf{f}^{\vee}) = \frac{\Norm_{K}(\mf{f}^{-1})}{|\D_{K}|}.
      \]
    \end{corollary}
    \begin{proof}
      This follows immediately from \(\mf{f}^{\vee} = \mf{f}^{-1}\mf{D}_{K}^{-1}\), multiplicativity of the norm, and \cref{prop:norm_of_different_is_discriminant}.
    \end{proof}

    Lastly, let \(a_{K}(m)\) denote the number of integral ideals of norm \(m\). Because the ideal norm is multiplicative so is \(a_{K}(m)\). Moreover, we have the following result:

    \begin{proposition}\label{equ:ideals_of_fixed_norm_bound}
      Let \(K\) be a number field of degree \(n\). Then \(a_{K}(m) \le \s_{0}(m)^{n}\).
    \end{proposition}
    \begin{proof}
      Let \(\mf{a}\) be an integral ideal of norm \(m\). First suppose \(m = p^{k}\) for some prime \(p\) and \(k \ge 0\). As there are at most \(n\) primes \(\mf{p}_{1},\ldots,\mf{p}_{n}\) above \(p\) with inertia degrees \(f_{p}(\mf{p}_{1}),\ldots,f_{p}(\mf{p}_{n})\) respectively, we have
      \[
        \Norm_{K}(\mf{a}) = p^{e_{1}f_{p}(\mf{p}_{1})} \cdots p^{e_{n}f_{p}(\mf{p}_{n})},
      \]
      for some integers \(0 \le e_{i} \le k\) for \(1 \le i \le n\). Therefore the number of possibilities is equivalent to the number of solutions
      \[
        e_{1}f_{p}(\mf{p}_{1})+\cdots+e_{n}f_{p}(\mf{p}_{n}) = k,
      \]
      which is at most \(\s_{0}(p^{k})^{n} = (k+1)^{n}\). This proves the claim in the case \(m\) is a prime power. By multiplicativity of \(a_{K}(m)\) and the divisor function, it follows that the number of integral ideals of norm \(m\) is at most \(\s_{0}(m)^{n}\) as desired.
    \end{proof}

    As a consequence of \cref{prop:sum_of_divisors_growth_rate}, we have the slightly weaker estimate \(a_{K}(n) \ll_{\e} n^{\e}\).
  \section{Minkowski Space}
    Let \(K\) be number field of degree \(n\) and let \(\s \in \Hom_{\Q}(K,\conj{\Q})\). Then either \(\s\) is real or complex and if it is complex it has a paired \(\Q\)-embedding \(\conj{\s} \in \Hom_{\Q}(K,\conj{\Q})\) given by the conjugate of \(\s\). Accordingly, let \(r_{1}\) and \(2r_{2}\) be the number of real and complex \(\Q\)-embeddings of \(K\) into \(\conj{\Q}\) respectively. We call the pair \((r_{1},r_{2})\) the \textbf{signature}\index{signature} of \(K\) and it satisfies the relation
    \[
      n = r_{1}+2r_{2}.
    \]
    Setting
    \[
      K_{\C} = \C^{n},
    \]
    we see that \(K_{\C}\) is a \(\C\)-algebra and also a complex Hilbert space with respect to \(\<\cdot,\cdot\>_{K_{\C}}\) which we take to be the standard complex inner product. We denote the associated Lebesgue measure by \(d\l_{K_{\C}}\). We define the \textbf{canonical embedding}\index{canonical embedding} \(j\) of \(K\) to be the \(\Q\)-embedding
    \[
      j:K \to K_{\C} \qquad \k \mapsto (\s(\k))_{\s},
    \]
    where \(\s\) runs over \(\Hom_{\Q}(K,\conj{\Q})\). Consider the conjugation map
    \[
      F:\C \to \C \qquad z \mapsto \conj{z}.
    \]
    This induces an automorphism
    \[
      F:K_{\C} \to K_{\C} \qquad (z_{\s})_{\s} \mapsto (\conj{z_{\conj{\s}}})_{\s},
    \]
    that is clearly an involution. The inner product \(\<\cdot,\cdot\>_{K_{\C}}\) is also \(F\)-equivariant since any \(\mathbf{z},\mathbf{w} \in K_{\C}\) satisfy
    \[
      \<F(\mathbf{z}),F(\mathbf{z})\>_{K_{\C}} = \<(\conj{z_{\conj{\s}}})_{\s},(\conj{w_{\conj{\s}}})_{\s}\>_{K_{\C}} = \sum_{\s}\conj{z_{\conj{\s}}w_{\conj{\s}}} = \conj{\sum_{\s}z_{\s}w_{\s}} = F(\<\mathbf{z},\mathbf{w}\>_{K_{\C}}),
    \]
    where in the third equality we have used the fact that the complex \(\Q\)-embeddings of \(K\) into \(\conj{\Q}\) come in conjugate pairs. On \(K_{\C}\) we also have linear maps
    \[
      \Trace_{K_{\C}}((z_{\s})_{\s}) = \sum_{\s}z_{\s} \quad \text{and} \quad \Norm_{K_{\C}}((z_{\s})_{\s}) = \prod_{\s}z_{\s},
    \]
    and clearly induce homomorphisms
    \[
      \Trace_{K_{\C}}:K_{\C} \to \C \quad \text{and} \quad \Norm_{K_{\C}}:K_{\C}^{\ast} \to \C^{\ast}.
    \]
    The composition of \(j\) with \(\Trace_{K_{\C}}\) and \(\Norm_{K_{\C}}\) are \(\Trace_{K}\) and \(\Norm_{K}\) respectively since
    \[
      \Trace_{K_{\C}}(j(\k)) = \sum_{\s}\s(\k) = \Trace_{K}(\k) \quad \text{and} \quad \Norm_{K_{\C}}(j(\k)) = \prod_{\s}\s(\k) = \Norm_{K}(\k),
    \]
    where the last equality in each chain follow by \cref{prop:formulas_for_trace_and_norm}. We now define the \textbf{Minkowski space}\index{Minkowski space} \(K_{\R}\) of \(K\) by
    \[
      K_{\R} = \{(z_{\s})_{\s} \in K_{\C}:F((z_{\s})_{\s}) = (z_{\s})_{\s}\}.
    \]
    In other words, \(K_{\R}\) consists of all of the \(F\)-invariant points of \(K_{\C}\). That is, \(\mathbf{z} \in K_{\R}\) if and only if \(F(\mathbf{z}) = \mathbf{z}\) or equivalently \(z_{\conj{\s}} = \conj{z_{\s}}\) for all \(\s\). In particular, \(j(K) \subset K_{\R}\) because \(\conj{\s}(\k) = \conj{\s(\k)}\) by definition of \(\conj{\s}\). We denote the restriction of the inner product \(\<\cdot,\cdot\>_{K_{\C}}\) on \(K_{\C}\) to \(K_{\R}\) by \(\<\cdot,\cdot\>_{K_{\R}}\). Note that \(K_{\R}\) is an \(\R\)-algebra. Moreover, the inner product \(\<\cdot,\cdot\>_{K_{\R}}\) turns \(K_{\R}\) into a real Hilbert space. Indeed, for any \(\mathbf{z},\mathbf{w} \in K_{\R}\) the conjugate symmetry and \(F\)-equivariance of the inner product together give
    \[
      \conj{\<\mathbf{z},\mathbf{w}\>} = F(\<\mathbf{w},\mathbf{z}\>) = \<F(\mathbf{z}),F(\mathbf{w})\> = \<\mathbf{z},\mathbf{w}\>,
    \]
    so that \(\<\mathbf{z},\mathbf{w}\> \in \R\) is real. Accordingly, we call \(\<\cdot,\cdot\>_{K_{\R}}\) the \textbf{Minkowski inner product}\index{Minkowski inner product}. We denote the restriction of the Lebesgue measure \(d\l_{\C}\) to \(K_{\R}\) by \(d\l_{K_{\R}}\) which is also the Lebesgue measure associated to \(\<\cdot,\cdot\>_{K_{\R}}\). We call \(d\l_{K_{\R}}\) the \textbf{Minkowski measure}\index{Minkowski measure}. Lastly, we denote the restrictions of \(\Trace_{K_{\C}}\) and \(\Norm_{K_{\C}}\) to \(K_{\R}\) by \(\Trace_{K_{\R}}\) and \(\Norm_{K_{\R}}\) respectively and call these maps the \textbf{Minkowski trace}\index{Minkowski trace} and \textbf{Minkowski norm}\index{Minkowski norm} respectively. We also have homomorphisms
    \[
      \Trace_{K_{\R}}:K_{\R} \to \R \quad \text{and} \quad \Norm_{K_{\R}}:K_{\R}^{\ast} \to \R^{\ast},
    \]
    \(\mathbf{z} \in K_{\R}\) if and only if \(z_{\conj{\s}} = \conj{z_{\s}}\) for all \(\s\). As \(j(K) \subset K_{\R}\), the compositions of \(j\) with the Minkowski trace and Minkowski norm are the field trace and field norm respectively. We can now give a more explicit description of \(K_{\R}\) and to do this we setup some notation. Let \(\rho\) run over the real \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\) and let \(\tau\) run over a complete set of representatives for the pairs of complex \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\). For any \(\s \in \Hom_{\Q}(K,\conj{\Q})\), let \(N_{\s} = 1,2\) according to if \(\s\) is real or complex respectively. So \(N_{\rho} = 1\) and \(N_{\tau} = 2\). As \(K_{\R}\) consists of exactly the \(F\)-invariant points of \(K_{\C}\), we have
    \[
      K_{\R} = \{(z_{\s})_{\s} \in K_{\C}:z_{\rho} \in \R \text{ and } z_{\conj{\tau}} = \conj{z_{\tau}} \text{ for all } \rho \text{ and } \tau\}.
    \]
    We now describe an explicit isomorphism from the Minkowski space and \(\R^{n}\):
    
    \begin{proposition}\label{prop:Minkowski_space_isomorphism}
      Let \(K\) be a number field of degree \(n\) and signature \((r_{1},r_{2})\). Also let \(\s\) run over \(\Hom_{\Q}(K,\conj{\Q})\), \(\rho\) run over all such real \(\Q\)-embeddings, and \(\tau\) run over a complete set of representatives for the pairs of complex \(\Q\)-embeddings. Then there is an isomorphism
      \[
        K_{\R} \to \R^{n} \qquad z_{\s} \mapsto x_{\s} = \begin{cases} z_{\s} & \text{if \(\s = \rho\)}, \\ \Re(z_{\s}) & \text{if \(\s = \tau\)}, \\ \Im(z_{\s}) & \text{if \(\s = \conj{\tau}\)}. \end{cases}
      \]
      In particular, \(K_{\R}\) is a \(n\)-dimensional real vector space. Moreover, the inner product \(\<\cdot,\cdot\>\) on \(\R^{n}\) induced by the Minkowski inner product is given by
      \[
        \<\mathbf{x},\mathbf{x}'\> = \sum_{\s}N_{\s}x_{\s}x'_{\s},
      \]
      for any \(\mathbf{x},\mathbf{x}' \in \R^{n}\).
    \end{proposition}
    \begin{proof}
      This map is an isomorphism since it is invertible and linear in each component. Since there are \(n\)  elements of \(\Hom_{\Q}(K,\conj{\Q})\), we see that \(K_{\R}\) is an \(n\)-dimensional real vector space. We will now prove the statement about the inner product. Let \((z_{\s})_{\s}\) and \((z'_{\s})_{\s}\) be elements of \(K_{\R}\) and let \((x_{\s})_{\s}\) and \((x'_{\s})_{\s}\) be the corresponding elements in \(\R^{n}\). If \(\s = \rho\) then
      \[
        x_{\rho} = z_{\rho} \quad \text{and} \quad x'_{\rho} = z'_{\rho},
      \]
      and thus
      \[
        x_{\rho}x'_{\rho} = z_{\rho}\conj{z'_{\rho}}.
      \]
      If \(\s = \tau\) then
      \[
        x_{\tau} = \Re(z_{\tau}), \quad x_{\conj{\tau}} = \Im(z_{\tau}), \quad x'_{\tau} = \Re(z'_{\tau}), \text{and} \quad x'_{\conj{\tau}} = \Im(z'_{\tau}),
      \]
      and hence
      \[
        2(x_{\tau}x'_{\tau}+x_{\conj{\tau}}x'_{\conj{\tau}}) = 2(\Re(z_{\tau})\Re(z'_{\tau})+\Im(z_{\tau})\Im(z'_{\tau})) = 2\Re(z_{\tau}\conj{z'_{\tau}}) = z_{\tau}\conj{z'_{\tau}}+z_{\conj{\tau}}\conj{z'_{\conj{\tau}}}.
      \]
      This proves the claim about the inner product.
    \end{proof}
    
    Define the \textbf{Minkowski embedding}\index{Minkowski embedding} \(\s_{K}\) of \(K\) by
    \[
      \s_{K}:K \to \R^{n} \qquad \k \mapsto (\rho_{1}(\k),\ldots,\rho_{r_{1}}(k),\Re(\tau_{1}(\k)),\Im(\tau_{1}(\k)),\ldots,\Re(\tau_{r_{2}}(\k)),\Im(\tau_{r_{2}}(\k))),
    \]
    where \(\rho_{1},\ldots,\rho_{r_{1}}\) are the real \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\) and \(\tau_{1},\ldots,\tau_{r_{2}}\) run over a complete set of representatives for the pairs of complex \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\). The Minkowski embedding \(\s_{K}\) is then a \(\Q\)-embedding of \(K\) into \(\R^{n}\) since it is the composition of the canonical embedding \(j\) (whose image under \(K\) is in \(K_{\R}\) as we have noted) and the isomorphism established by \cref{prop:Minkowski_space_isomorphism}. It is also independent of the choice of representatives \(\tau_{1},\ldots,\tau_{r_{2}}\) since the complex \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\) occur in conjugate pairs. As \(j\) is a \(\Q\)-embedding and any fractional ideal \(\mf{f}\) is a complete lattice, \(j(\mf{f})\) is a complete lattice in \(K_{\R}\). We now determine the covolume of \(j(\mf{f})\):

    \begin{proposition}\label{prop:covolume_of_fractional_ideal_under_j}
      Let \(K\) be a number field with signature \((r_{1},r_{2})\). Then \(V_{j(\mf{f})}\) is the absolute value of the determinant of any embedding matrix for \(\mf{f}\). In particular,
      \[
        V_{j(\mf{f})} = \Norm_{K}(\mf{f})\sqrt{|\D_{K}|},
      \]
      and
      \[
        V_{j(\mc{O}_{K})} = \sqrt{|\D_{K}|}.
      \]
    \end{proposition}
    \begin{proof}
      The last statement follows from the first two by taking \(\mf{f} = \mc{O}_{K}\) so it suffices to prove the first two statements. Let \(\k_{1},\ldots,\k_{n}\) be a basis for \(\mf{f}\) and let \(\s_{1},\ldots,\s_{n}\) be the elements of \(\Hom_{\Q}(K,\conj{\Q})\). Then the associated generator matrix \(P\) for \(j(\mf{f})\) is given by
      \[
        P = \begin{pmatrix} \s_{1}(\k_{1}) & \cdots & \s_{1}(\k_{n}) \\ \vdots & & \vdots & \\ \s_{n}(\k_{1}) & \cdots & \s_{n}(\k_{n}) \end{pmatrix} = M(\k_{1},\ldots,\k_{n}),
      \]
      which is an embedding matrix for \(\mf{f}\). Hence
      \[
        V_{j(\mf{f})} = |\det(M(\k_{1},\ldots,\k_{n}))|,
      \]
      proving the first statement. We will be done if we can show
      \[
        |\det(M(\k_{1},\ldots,\k_{n}))| = \Norm_{K}(\mf{f})|\det(M(\a_{1},\ldots,\a_{n}))|,
      \]
      for any integral basis \(\a_{1},\ldots,\a_{n}\) since \(|\det(M(\a_{1},\ldots,\a_{n}))| = \sqrt{|\D_{K}|}\) (as we have seen). As \(\mf{f}\) is a fractional ideal, there exists a nonzero \(\d \in \mc{O}_{K}\) and an integral ideal \(\mf{a}\) such that
      \[
        \mf{f} = \frac{1}{\d}\mf{a}.
      \]
      Then \(\d\k_{1},\ldots,\d\k_{n}\) is a basis for \(\mf{a}\). By \cref{prop:norm_and_field_norms_are_identical,prop:base_change_quotient_determinant}, we have
      \[
        |\det(M(\d\k_{1},\ldots,\d\k_{n}))| = \Norm_{K}(\mf{a})|\det(M(\a_{1},\ldots,\a_{n}))|,
      \]
      since they together show that \(\Norm_{K}(\mf{a})\) is the absolute value of the determinant of the base change matrix from \(\k_{1},\ldots,\k_{n}\) to \(\d\k_{1},\ldots,\d\k_{n}\). Similarly,
      \[
        |\det(M(\d\k_{1},\ldots,\d\k_{n}))| = |\Norm_{K}(\d)||\det(M(\k_{1},\ldots,\k_{n}))|,
      \]
      since \cref{prop:norm_and_field_norms_are_identical,prop:base_change_quotient_determinant} together show that \(|\Norm_{K}(\d)|\) is the absolute value of the determinant of the base change matrix from \(\k_{1},\ldots,\k_{n}\) to \(\d\k_{1},\ldots,\d\k_{n}\). As \(\Norm_{K}(\mf{f}) = \frac{\Norm_{K}(\mf{a})}{|\Norm_{K}(\d)|}\) by multiplicativity of the norm and \cref{prop:norm_and_field_norms_are_identical}, these two identities for \(|\det(M(\d\k_{1},\ldots,\d\k_{n}))|\) together imply the claim.
    \end{proof}
    
    Now as \(\s_{K}\) is also a \(\Q\)-embedding, \(\s_{K}(\mf{f})\) is a complete lattice in \(\R^{n}\). As a corollary of \cref{prop:covolume_of_fractional_ideal_under_j}, we can determine the covolume of \(\s_{K}(\mf{f})\):
    
    \begin{corollary}\label{cor:covolume_of_fractional_ideal_under_canonical_embedding}
      Let \(K\) be a number field with signature \((r_{1},r_{2})\). Then
      \[
        V_{\s_{K}(\mf{f})} = \Norm_{K}(\mf{f})\frac{\sqrt{|\D_{K}|}}{2^{r_{2}}}.
      \]
      In particular,
      \[
        V_{\s_{K}(\mc{O}_{K})} = \frac{\sqrt{|\D_{K}|}}{2^{r_{2}}}.
      \]
    \end{corollary}
    \begin{proof}
      The second statement follows from the first by taking \(\mf{f} = \mc{O}_{K}\) so it suffices to prove the first statement. Let \(\k_{1},\ldots,\k_{n}\) be a basis for \(\mf{f}\), \(\rho_{1},\ldots,\rho_{r_{1}}\) be the real \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\), and \(\tau_{1},\ldots,\tau_{r_{2}}\) run over a complete set of representatives for the pairs of complex \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\). Then the associated generator matrix \(P\) for \(\s_{K}(\mf{f})\) is
      \[
        P = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \Re(\tau_{1}(\k_{1})) & \Im(\tau_{1}(\k_{1})) & \cdots & \Re(\tau_{r_{2}}(\k_{1})) & \Im(\tau_{r_{2}}(\k_{1})) \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \Re(\tau_{1}(\k_{n})) & \Im(\tau_{1}(\k_{n})) & \cdots & \Re(\tau_{r_{2}}(\k_{n})) & \Im(\tau_{r_{2}}(\k_{n})) \end{pmatrix}^{t}.
      \]
      By \cref{prop:covolume_of_fractional_ideal_under_j} we are done if the absolute value of the determinant of this matrix is \(2^{-r_{2}}\) times the determinate of an embedding matrix for \(\mf{f}\). To show this, first add an \(i\) multiple of the imaginary columns to their corresponding real columns and then apply the identity \(\Im(z) = \frac{z-\conj{z}}{2i}\) to the imaginary columns to obtain
      \[
        P' = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \tau_{1}(\k_{1}) & \frac{\tau_{1}(\k_{1})-\conj{\tau_{1}}(\k_{1})}{2i} & \cdots & \tau_{r_{2}}(\k_{1}) & \frac{\tau_{r_{2}}(\k_{1})-\conj{\tau_{r_{2}}}(\k_{1})}{2i} \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \tau_{1}(\k_{n}) & \frac{\tau_{1}(\k_{n})-\conj{\tau_{1}}(\k_{n})}{2i} & \cdots & \tau_{r_{2}}(\k_{n}) & \frac{\tau_{r_{2}}(\k_{n})-\conj{\tau_{r_{2}}}(\k_{n})}{2i} \end{pmatrix}^{t}.
      \]
      Since \(P'\) differs from \(P\) by column addition, their determinants are the same. Multiplying the imaginary columns of \(P'\) by \(-2i\) and then adding the corresponding columns to annihilate the negative terms results in
      \[
        P'' = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \tau_{1}(\k_{1}) &\conj{\tau_{1}}(\k_{1}) & \cdots & \tau_{r_{2}}(\k_{1}) & \conj{\tau_{r_{2}}}(\k_{1}) \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \tau_{1}(\k_{n}) & \conj{\tau_{1}}(\k_{n}) & \cdots & \tau_{r_{2}}(\k_{n}) & \conj{\tau_{r_{2}}}(\k_{n}) \end{pmatrix}^{t}.
      \]
      As \(P''\) differs from \(P'\) by column addition and column scaling of which there were \(r_{2}\) many of factor \(-2i\), the determinant of \(P''\) is \((-2i)^{-r_{2}}\) that of \(P'\). Altogether,
      \[
        V_{\mf{f}} = |\det(P)| = |\det(P')| = |(-2i)^{-r_{2}}\det(P'')| = 2^{-r_{2}}|\det(P'')|.
      \]
      Since the complex \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\) occur in conjugate pairs and \(\k_{1},\ldots,\k_{n}\) is a basis for \(K\), we see that \(P'' = M(\k_{1},\ldots,\k_{n})\) is an embedding matrix for \(\mf{f}\).
    \end{proof}
  \section{Finiteness of the Class Number}
    Recall that the class number \(h_{K}\) is a measure of how much the ring of integers \(\mc{O}_{K}\) fails to be a principal ideal domain. From \cref{rem:general_class_number_not_finite}, the class number of an arbitrary Dedekind domain need not be finite. However, we will show that the class number \(h_{K}\) for a number field \(K\) is always finite and thus \(\mc{O}_{K}\) only has finite failure from being a principal ideal domain:

    \begin{theorem}\label{equ:finitness_of_class_number}
      Let \(K\) be a number field of degree \(n\) and signature \((r_{1},r_{2})\). Also, let \(X \subseteq \R^{n}\) be a compact convex symmetric set and set \(M = \max_{\mathbf{x} \in X}\left(\prod_{1 \le i \le n}|x_{i}|\right)\). Then every ideal class contains an integral ideal \(\mf{a}\) satisfying
      \[
        \Norm_{K}(\mf{a}) \le \frac{2^{r_{1}+r_{2}}M}{\Vol(X)}\sqrt{|\D_{K}|}.
      \]
      Moreover, the ideal class group \(\Cl(K)\) is finite so that the class number \(h_{K}\) is too.
    \end{theorem}
    \begin{proof}
      Let \(\mf{f}\) be a fractional ideal, and set
      \[
        \l^{n} = 2^{n}\frac{V_{\s_{K}(\mf{f}^{-1})}}{\Vol(X)},
      \]
      for any \(n \ge 1\). Then by construction,
      \[
        \Vol(\l X) = \l^{n}\Vol(X) = 2^{n}V_{\s_{K}(\mf{f}^{-1})}.
      \]
      By Minkowski's lattice point theorem, there exists a nonzero \(\a \in \mf{f}^{-1}\) such that \(\s_{K}(\a) \in \s_{K}(\mf{f}^{-1})\) and \(\s_{K}(\a) \in \l X\). Since \(\a \in \mf{f}^{-1}\), \(\a\mf{f} \subseteq \mc{O}_{K}\) so that \(\a\mf{f}\) is an integral ideal in the same ideal class as \(\mf{f}\). Now let \(\s\) run over \(\Hom_{\Q}(K,\conj{\Q})\). Since the norm is multiplicative, we have
      \[
        \Norm_{K}(\a\mf{f}) = |\Norm_{K}(\a)|\Norm_{K}(\mf{f}) = \left|\prod_{\s}\s(\a)\right|\Norm_{K}(\mf{f}) \le \l^{n}M\Norm_{K}(\mf{f}),
      \]
      where in the first equality we have applied multiplicativity of the norm and \cref{prop:norm_and_field_norms_are_identical}, in the second we have used \cref{prop:formulas_for_trace_and_norm}, and the inequality follows since \(\s_{K}(\a) \in \l X\). This inequality, our choice of \(\l^{n}\), and \cref{cor:covolume_of_fractional_ideal_under_canonical_embedding} together give
      \[
        \Norm_{K}(\a\mf{f}) \le \l^{n}M\Norm_{K}(\mf{f}) = 2^{n}M\Norm_{K}(\mf{f})\frac{V_{\s_{K}(\mf{f}^{-1})}}{\Vol(X)} = 2^{n}M\frac{\sqrt{|\D_{K}|}}{2^{r_{2}}\Vol(X)} = \frac{2^{r_{1}+r_{2}}M}{\Vol(X)}\sqrt{|\D_{K}|},
      \]
      which proves the first statement since the fractional ideal \(\mf{f}\) was arbitrary. We now prove that the class group is finite. By what we have just proved, we can find a complete set of representatives for \(\Cl(K)\) consisting of integral ideals of bounded norm. Since the norm is multiplicative, the prime factors of these representatives have bounded norm as well. As we have seen, the norm of a prime integral ideal is exactly the prime \(p\) below it. Thus the norms of these prime factors are bounded primes \(p\). As there are finitely many prime integral ideals above any prime \(p\) (because \(p\mc{O}_{K}\) factors into a product of prime integral ideals and these are exactly the prime integral ideals above \(p\)), it follows that these representatives have finitely many prime factors. Altogether this means that there are finitely many representatives. Hence \(\Cl(K)\) is finite and so the class number \(h_{K}\) is too.
    \end{proof}

    We would like to obtain an explicit bound in \cref{equ:finitness_of_class_number} by making a choice for the set \(X\). To obtain a bound that is not too large, we need to ensure that the volume of \(X\) is large while the constant \(M\) is small. The following lemma dictates our choice of \(X\) and computes its volume:

    \begin{lemma}\label{lem:Minkowski_bound_lemma}
      Suppose \(n\) is a positive integer and write \(n = r_{1}+2r_{2}\) for some nonnegative integers \(r_{1}\) and \(r_{2}\). Let \(X \subset \R^{n}\) to be the compact convex symmetric set given by
      \[
        X = \left\{\mathbf{x} \in \R^{n}:\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{\substack{1 \le j \le r_{2} \\ j \equiv 1 \tmod{2}}}\sqrt{x_{r_{1}+j}^{2}+x_{r_{1}+j+1}^{2}} \le n\right\}.
      \]
      Then
      \[
        \Vol(X) = \frac{n^{n}}{n!}2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}}.
      \]
    \end{lemma}
    \begin{proof}
      Making the change of variables \(x_{r_{1}+j} \mapsto u_{j}\sin(\t_{j})\) and \(x_{r_{1}+j+1} \mapsto u_{j}\cos(\t_{j})\) for all \(j\) gives
      \[
        \Vol(X) = \int_{X'}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1}\t_{1} \cdots du_{r_{2}}\t_{r_{2}},
      \]
      where
      \[
        X' = \left\{(x_{1},\ldots,x_{r_{1}},u_{1},\t_{1},\ldots,u_{r_{2}},\t_{r_{2}}):\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{1 \le j \le r_{2}}u_{j} \le n\right\}.
      \]
      Since the integrand is independent of the \(\t_{j}\), we have
      \[
        \Vol(X) = (2\pi)^{r_{2}}\int_{X'}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1} \cdots du_{r_{2}}.
      \]
      Making the change of variables \(u_{j} \mapsto \frac{u_{j}}{2}\) for all \(j\) and using the fact that the integrand is symmetric in the \(x_{i}\) for all \(i\) gives
      \begin{equation}\label{equ:Minkowski_bound_lemma_1}
        \Vol(X) = 2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}}\int_{X''}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1} \cdots du_{r_{2}},
      \end{equation}
      where
      \[
        X'' = \left\{(x_{1},\ldots,x_{r_{1}},u_{1},\ldots,u_{r_{2}}):\sum_{1 \le i \le r_{1}}x_{i}+\sum_{1 \le j \le r_{2}}u_{j} \le n\right\}.
      \]
      To compute the remaining integral, for nonnegative integers \(\ell\) and \(k\) and \(t \ge 0\), we let
      \[
        X''_{\ell,k}(t) = \left\{(x_{1},\ldots,x_{\ell},u_{1},\ldots,u_{k}):\sum_{1 \le i \le \ell}x_{i}+\sum_{1 \le j \le k}u_{j} \le t\right\},
      \]
      and set 
      \[
        I_{\ell,k}(t) = \int_{X''_{\ell,k}(t)}u_{1} \cdots u_{\ell}\,dx_{1} \cdots dx_{n}\,du_{1} \cdots du_{k}.
      \]
      Then we have to compute \(I_{r_{1},r_{2}}(n)\). To this end, the change of variables \(x_{i} \mapsto tx_{i}\) and \(u_{j} \mapsto tu_{j}\) for all \(i\) and \(j\) gives
      \begin{equation}\label{equ:Minkowski_bound_lemma_2}
        I_{\ell,k}(t) = t^{\ell+2k}I_{\ell,k}(1).
      \end{equation}
      Now note that the condition
      \[
        \sum_{1 \le i \le \ell}x_{i}+\sum_{1 \le j \le k}u_{j} \le t,
      \]
      is equivalent to
      \[
        \sum_{1 \le i \le \ell-1}x_{i}+\sum_{1 \le j \le k}u_{j} \le t-x_{i}.
      \]
      This fact together with the FubiniTonelli theorem and \cref{equ:Minkowski_bound_lemma_2} gives
      \[
        I_{\ell,k}(1) = \int_{0}^{1}I_{\ell-1,k}(1-x_{\ell})\,dx_{\ell} = \int_{0}^{1}(1-x_{\ell})^{\ell-1+2k}I_{\ell-1,k}(1)\,dx_{\ell} = \frac{1}{\ell+2k}I_{\ell-1,k}(1).
      \]
      Repeating this procedure \(\ell-1\) times results in
      \begin{equation}\label{equ:Minkowski_bound_lemma_3}
        I_{\ell,k}(1) = \frac{1}{(\ell+2k) \cdots (2k+1)}I_{0,k}(1).
      \end{equation}
      Similarly, the condition
      \[
        \sum_{1 \le j \le k}u_{j} \le t,
      \]
      is equivalent to
      \[
        \sum_{1 \le j \le k-1}u_{j} \le t-u_{k}.
      \]
      This fact together with the FubiniTonelli theorem, \cref{equ:Minkowski_bound_lemma_2}, and \cref{prop:integral_reprepsentation_for_beta_function}, gives
      \[
        I_{0,k}(1) = \int_{0}^{1}u_{k}I_{0,k-1}(1-u_{k})\,du_{k} = \int_{0}^{1}u_{k}(1-u_{k})^{2k-2}I_{0,k-1}(1)\,du_{k} = B(1,2k-1)I_{0,k-1}(1) = \frac{1}{2k}I_{0,k-1}(1).
      \]
      Repeating this procedure \(k-1\) times results in
      \begin{equation}\label{equ:Minkowski_bound_lemma_4}
        I_{0,k}(1) = \frac{1}{k!},
      \end{equation}
      since \(I_{0,0}(1) = 1\). Combining \cref{equ:Minkowski_bound_lemma_2,equ:Minkowski_bound_lemma_3,equ:Minkowski_bound_lemma_4} we find that
      \[
        I_{\ell,k}(t) = t^{\ell+2k}\frac{1}{(\ell+2k)!}.
      \]
      In particular, \(I_{r_{1},r_{2}}(n) = \frac{n^{n}}{n!}\) and from \cref{equ:Minkowski_bound_lemma_1} we obtain
      \[
        \Vol(X) = \frac{n^{n}}{n!}2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}},
      \]
      as desired.
    \end{proof}

    Observe that the set \(X\) in \cref{lem:Minkowski_bound_lemma} just consists of those points in \(\R^{n}\) whose induced norm corresponding to the induced Minkowski inner product is at most \(n\) (recall \cref{prop:Minkowski_space_isomorphism}). We can now obtain an explicit bound in \cref{equ:finitness_of_class_number} known as the \textbf{Minkowski bound}\index{Minkowski bound}:

    \begin{theorem*}[Minkowski bound]
      Let \(K\) be a number field of degree \(n\) and signature \((r_{1},r_{2})\). Then every ideal class contains an integral ideal \(\mf{a}\) satisfying
      \[
        \Norm_{K}(\mf{a}) \le \left(\frac{4}{\pi}\right)^{r_{2}}\frac{n!}{n^{n}}\sqrt{|\D_{K}|}.
      \]
    \end{theorem*}
    \begin{proof}
      Let \(X\) be given by
      \[
        X = \left\{\mathbf{x} \in \R^{n}:\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{\substack{1 \le j \le r_{2} \\ j \equiv 1 \tmod{2}}}\sqrt{x_{r_{1}+j}^{2}+x_{r_{1}+j+1}^{2}} \le n\right\}.
      \]
      Then \cref{equ:finitness_of_class_number,lem:Minkowski_bound_lemma} together show that every ideal class contains an integral ideal \(\mf{a}\) such that
      \[
        \Norm_{K}(\mf{a}) \le M\left(\frac{4}{\pi}\right)^{r_{2}}\frac{n!}{n^{n}}\sqrt{|\D_{K}|},
      \]
      where \(M = \max_{\mathbf{x} \in X}\left(\prod_{1 \le \ell \le n}|x_{\ell}|\right)\). But for all \(\mathbf{x} \in X\), the arithmetic-geometric mean inequality gives
      \[
        \left(\prod_{1 \le \ell \le n}|x_{\ell}|\right)^{\frac{1}{n}} \le \frac{1}{n}\sum_{1 \le \ell \le n}|x_{\ell}| \le 1,
      \]
      where the second inequality holds by the definition of \(X\). Hence \(M \le 1\) and this completes the proof.
    \end{proof}

    As a corollary we can obtain a lower bound for the discriminant of a number field and show that every number field \(K\), other than \(\Q\), has at least one ramified prime in \(\mc{O}_{K}/\Z\):

    \begin{corollary}
      Let \(K\) be a number field of degree \(n\). Then
      \[
        |\D_{K}| \ge \left(\frac{\pi}{4}\right)^{\frac{n}{2}}\frac{n^{n}}{n!}.
      \]
      In particular, there is at least one ramified prime in \(\mc{O}_{K}/\Z\) provided the degree of \(K\) is at least \(2\). 
    \end{corollary}
    \begin{proof}
      Since the norm of every integral ideal is at least \(1\), \(\pi < 4\), and \(r_{2}\) is at most \(n\), the desired inequality follows immediately from the Minkowski bound. Now suppose \(n \ge 2\). In the case \(n = 2\), the lower bound is larger than \(1\) so that \(|\D_{K}|\) is at least \(2\) for every quadratic number field. As \(n^{n} \ge n!\) for all \(n \ge 1\) (which easily follows by induction), \(\left(\frac{\pi}{4}\right)^{\frac{n}{2}}\frac{n^{n}}{n!}\) is an increasing function in \(n\). Therefore \(|\D_{K}| \ge 2\) for all \(n \ge 2\) so that \(|\D_{K}|\) has a prime divisor. This means at least one prime of \(K\) ramifies in \(\mc{O}_{K}/\Z\).
    \end{proof}

    Generally speaking, the class number \(h_{K}\) is one of the most difficult pieces of arithmetic data about \(K\) to compute. For example, it is still unknown if there are infinitely many number fields of class number \(1\), that is, number fields such that their ring of integers are principal ideal domains.
  \section{Dirichlet's Unit Theorem}
    Let \(K\) be a number field of signature \((r_{1},r_{2})\). We define the \textbf{rank}\index{rank} \(r_{K}\) of \(K\) to be
    \[
      r_{K} = r_{1}+r_{2}-1.
    \]
    This will be an important in the following. Another very important piece of arithmetic data about \(K\) is the structure of the unit group \(\mc{O}_{K}^{\ast}\). Note that \(\mc{O}_{K}^{\ast}\) is closed under conjugation because \(\Norm_{K}(\a) = \Norm_{K}(\conj{\a})\) as a consequence of \cref{prop:formulas_for_trace_and_norm}. Moreover, since the norm of a unit is \(\pm1\), we can express the unit group as
    \[
      \mc{O}_{K}^{\ast} = \{\e \in \mc{O}_{K}:\Norm_{K}(\e) = \pm 1\}.
    \]
    Our main goal will be to describe the group structure of \(\mc{O}_{K}^{\ast}\) completely. Let \(\W\) denote the group of all roots of unity. We will set \(\mu(K) = \mc{O}_{K}^{\ast} \cap \W\) so that \(\mu(K)\) is the subgroup of \(\mc{O}_{K}^{\ast}\) consisting of all of the roots of unity in \(K\). Clearly \(\{\pm 1\} \subseteq \mu(K)\). In fact, \(\mu(K)\) is finite since any root of unity in \(K\) is a root of \(x^{n}-1\) and thus an \(n\)-th root of unity. We set
    \[
      w_{K} = |\mu(K)|.
    \]
    Our goal will be to show that \(\mc{O}_{K}^{\ast}\) is a direct product of \(\mu(K)\) and a free abelian group of rank \(r_{K}\). Determining that the rank of the free group is exactly \(r_{K}\) will be the most difficult part of the proof. We will require a map on \(K^{\ast}\) that transitions between the field trace and the field norm. Let \(\rho_{1},\ldots,\rho_{r_{1}}\) be the real \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\) and \(\tau_{1},\ldots,\tau_{r_{2}}\) run over a complete set of representatives for the pairs of complex \(\Q\)-embeddings of \(\Hom_{\Q}(K,\conj{\Q})\). First consider the map
    \[
      \ell:K_{\R}^{\ast} \to \R^{r_{K}+1} \qquad (z_{\s})_{\s} \mapsto (\log|z_{\rho_{1}}|,\ldots,\log|z_{\rho_{r_{1}}}|,2\log|z_{\tau_{1}}|,\ldots,2\log|z_{\tau_{r_{2}}}|).
    \]
    This map is independent of the choice of representatives \(\tau_{1},\ldots,\tau_{r_{2}}\) because \(z_{\conj{\tau}} = \conj{z_{\tau}}\) for \(\mathbf{z} \in K_{\R}\).
    We define the \textbf{logarithmic embedding}\index{logarithmic embedding} \(\log_{K}\) of \(K\) by
    \[
      \log_{K}:K^{\ast} \to \R^{r_{K}+1} \qquad \k \mapsto (\log|\rho_{1}(\k)|,\ldots,\log|\rho_{r_{1}}(\k)|,2\log|\tau_{1}(\k)|,\ldots,2\log|\tau_{r_{2}}(\k)|).
    \]
    Then \(\log_{K}\) is just the restriction of \(j\) to \(K^{\ast}\) composed with \(\ell\). Since \(\ell\) is a homomorphism and \(j\) is a \(\Q\)-embedding, \(\log_{K}\) is a homomorphism. We distinguish the subsets
    \[
      S = \{\mathbf{x} \in  \R_{+}^{r_{K}+1}:\Norm_{\R^{r_{K}+1}/\R}(\mathbf{x}) = 1\} \quad \text{and} \quad H = \{\mathbf{x} \in \R^{r_{K}+1}:\Trace_{\R^{r_{K}+1}/\R}(\mathbf{x}) = 0\},
    \]
    called the \textbf{norm-one hypersurface}\index{norm-one hypersurface} and \textbf{trace-zero hyperplane}\index{trace-zero hyperplane} of \(\R^{r_{K}+1}\) respectively. Note that \(H\) is an \(r_{K}\)-dimensional subspace of \(\R^{r_{K}+1}\). We will also make use of the subset
    \[
      U = \{\mathbf{z} \in K_{\R}:\Norm_{K_{\R}}(\mathbf{z}) = \pm 1\}.
    \]
    Let \(\l\) denote the restriction of \(\log_{K}\) to \(\mc{O}_{K}^{\ast}\) and set
    \[
      \L = \log_{K}(\mc{O}_{K}^{\ast}),
    \]
    so that \(\L\) is the image of \(\l\). We call \(\L\) the \textbf{unit lattice}\index{unit lattice} of \(K\). It is not immediately obvious that \(\L\) is a lattice, but we will show this and more. Observe that \(\ell\) takes \(U\) into \(H\) since \(\Trace_{\R^{r_{K}+1}/\R}(\ell(\mathbf{z})) = \log|\Norm_{K_{\R}}(\mathbf{z})| = 1\). In particular, \(\L \subset H\) since \(j(\mc{O}_{K}^{\ast}) \subset U\). All of this data can be collected into the following commutative diagram:

    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mc{O}_{K}^{\ast} \arrow{d} \arrow{r}{j} \arrow[bend left]{rr}{\log_{K}} & U \arrow{d} \arrow{r}{\ell} & H \arrow{d} \\
        K^{\ast} \arrow{d}{\Norm} \arrow{r}{j} & K_{\R} \arrow{d}{\Norm_{K_{\R}}}^{\ast} \arrow{r}{\ell} & \R^{r_{K}+1} \arrow{d}{\Trace_{\R^{r_{K}+1}/\R}} \\
        \Q^{\ast} \arrow{r} & \R^{\ast} \arrow{r}{\log|\phantom{\cdot}|} & \R.
      \end{tikzcd}
    \end{center}
    We first show that the logarithmic embedding fits into an exact sequence:

    \begin{proposition}\label{prop:exact_sequence_for_Dirichlets_unit_theorem}
      Let \(K\) be a number field. Then the sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & \mu(K) \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r}{\l} & \L \arrow{r} & 0,
        \end{tikzcd}
      \end{center}

      is exact.
    \end{proposition}
    \begin{proof}
      Exactness of this sequence means that \(\mu(K)\) is the kernel of \(\l\). If \(\w \in \mu(K)\) then \(|\w| = 1\) and it follows that \(\l(\w) = 0\). Therefore \(\ker\l\) contains \(\mu(K)\). To see that this is all of \(\ker\l\), suppose \(\e \in \mc{O}_{K}^{\ast}\) is such that \(\l(\e) = 0\). But then every component of \(j(\e)\) is has absolute value \(1\) and therefore belongs to a bounded subset of the Minkowski space \(K_{\R}\). Since \(\mc{O}_{K}^{\ast}\) is a subgroup of \(\mc{O}_{K}\) and \(j(\mc{O}_{K})\) is a complete lattice in \(K_{\R}\) (as we have already remarked), \(j(\mc{O}_{K}^{\ast})\) is a lattice in \(K_{\R}\). But then \(j(\e)\) belongs to a discrete set by \cref{prop:integral lattice_if_and_only_if_discrete_subgroup}. Together, \(j(\e)\) belongs to a discrete and bounded set and hence is necessarily finite. Since \(j\) is a \(\Q\)-embedding, it follows that the subgroup \(\ker\l\) of \(\mc{O}_{K}^{\ast}\) contains finitely many elements and hence only roots of unity because \(\ker\l \subset K \subset \C\). Thus \(\ker\l = \mu(K)\).
    \end{proof}

    Our aim now is to show that the unit lattice \(\L\) is a a free abelian group of rank \(r_{K}\). For this, we will require a lemma:

    \begin{lemma}\label{lem:finitely_many_elements_of_fixed_norm}
      Let \(K\) be a number field. There are finitely many elements in \(\mc{O}_{K}\) of a given norm up to multiplication by units.
    \end{lemma}
    \begin{proof}
      Recall that the norm of an algebraic integer is an integer and that the elements of norm \(\pm1\) are exactly the units of \(K\). Therefore it suffices to prove the claim for norm \(n \ge 2\) (the norm is only zero for zero itself). Further recall that \(\mc{O}_{K}/n\mc{O}_{K}\) is finite (with \(\Norm_{K}(n\mc{O}_{K})\) many elements). Therefore, it suffices to show that in each coset there is at most one element of norm \(n\) up to multiplication by units. To show this, suppose \(\a\) and \(\b\) are two representatives in the same coset and are of norm \(n\). Writing \(\a = \b+n\g\) for some \(n\g \in n\mc{O}_{K}\), we have
      \[
        \frac{\a}{\b} = 1+\frac{n}{\b}\g = 1+\frac{\Norm_{K}(\b)}{\b}\g,
      \]
      which is an element of \(\mc{O}_{K}\) because \(\frac{\Norm_{K}(\b)}{\b}\) is since \(\Norm_{K}(\b) \in \b\mc{O}_{K}\) as any integral ideal contains it norm. Hence \(\frac{\a}{\b} \in \mc{O}_{K}\), and interchanging the roles of \(\a\) and \(\b\) shows that \(\frac{\b}{\a} \in \mc{O}_{K}\) too. But then \(\frac{\a}{\b}\) is a unit in \(\mc{O}_{K}\) and thus \(\a\) and \(\b\) differ up to multiplication by a unit.
    \end{proof}

    Recall that \(\L \subset H\). We will show \(\L\) is a lattice in \(H\), actually a complete lattice, and compute its rank as a free abelian group:

    \begin{theorem}\label{thm:unit_group_complete_lattice}
      Let \(K\) be a number field of degree \(n\) and signature \((r_{1},r_{2})\). Then the unit lattice \(\L\) is a complete lattice in the trace-zero hyperplane \(H\) of \(\R^{r_{K}+1}\). In particular, \(\L\) is a free abelian group of rank \(r_{K}\).
    \end{theorem}
    \begin{proof}
      Throughout, let \(\s\) run over \(\Hom_{\Q}(K,\conj{\Q})\), \(\rho\) run over all such real \(\Q\)-embeddings, and \(\tau\) run over a complete set of representatives for the pairs of complex \(\Q\)-embeddings. We first prove \(\L\) is a lattice in \(H\). Since \(\l\) is a homomorphism (because \(\log_{K}\) is), \(\L\) is a subgroup of \(H\). So by \cref{prop:integral lattice_if_and_only_if_discrete_subgroup}, \(\L\) is a lattice if and only if it is discrete. In particular, we will show that for any \(c > 0\), the bounded region
      \[
        X = \{\mathbf{x} \in \R^{r_{K}+1}:|x_{\rho}| \le c \text{ and } |x_{\tau}| \le 2c \text{ for all } \rho \text{ and } \tau\},
      \]
      contains only finitely many points of \(\L\). The preimage of \(X\) under \(\ell\) is
      \[
        \ell^{-1}(X) = \{\mathbf{z} \in K_{\R}:e^{-c} \le |z_{\s}| \le e^{c} \text{ for all } \s\},
      \]
      and hence it contains finitely many points of \(j(\mc{O}_{K}^{\ast})\) because this is a subset of the lattice \(j(\mc{O}_{K})\). It follows that \(X\) contains finitely many points of \(\L\) (as the preimage of \(\mathbf{x}\) in \(\R^{n}\) under \(\ell\) contains \(2^{n}\) points of \(K_{\R}\)) so that \(\L\) is discrete and thus a lattice. We will now show that \(\L\) is a complete lattice in \(H\) and since \(H\) is an \(r_{K}\)-dimensional real vector space, this will also prove the claim about the rank of \(\L\). By \cref{prop:complete_integral lattice_if_and_only_if_bounded_translates_cover} it suffices to show that there is a bounded subset \(M\) of the trace-zero hyperplane \(H\) whose translates by \(\L\) cover \(H\). Actually, since \(\ell\) is surjective it suffices to construct a bounded subset \(T\) of \(U\) such that
      \[
        U = \bigcup_{\e \in \mc{O}_{K}^{\ast}}j(\e)T.
      \]
      Indeed, if such \(T\) exists then any \(\mathbf{z} \in T\) satisfies \(|\Norm_{K_{\R}}(\mathbf{z})| = \prod_{\s}|z_{\s}| = 1\) and hence each \(z_{\s}\) is bounded above and away from zero because \(T\) is bounded. Setting \(M = \ell(T)\), it follows that \(M\) is also bounded (because \(\log|z|\) is continuous) and
      \[
        H = \bigcup_{\l}(M+\l).
      \]
      It now suffices to construct such a subset \(T\). For every \(\s\), fix constants \(c_{\s} > 0\) satisfying
      \[
        c_{\s} = c_{\conj{\s}} \quad \text{and} \quad \prod_{\s}c_{\s} > \left(\frac{2}{\pi}\right)^{r_{2}}\sqrt{|D_{K}|},
      \]
      and set \(C = \prod_{\s}c_{\s}\). Now consider the bounded subset
      \[
        Z = \{\mathbf{z} \in K_{\R}:|z_{\s}| < c_{\s} \text{ for all } \s\}.
      \]
      For any \(\mathbf{w} \in U\), we have
      \[
        \mathbf{w}Z = \{\mathbf{z} \in K_{\R}:|z_{\s}| < |w_{\s}|c_{\s} \text{ for all } \s\},
      \]
      and \(\prod_{\s}|w_{\s}|c_{\s} = \Norm_{K_{\R}}(\mathbf{w})C = C\) so that \(\mathbf{w}Z\) is also bounded. By \cref{prop:Minkowski_space_isomorphism}, the volume of \(\mathbf{w}Z\) is \(2^{r_{2}}\) times the volume of
      \[
        X = \{\mathbf{x} \in \R^{n}:|x_{\rho}| < c_{\rho} \text{ and } x_{\tau}^{2}+x_{\conj{\tau}}^{2} < c_{\tau}^{2} \text{ for all } \rho \text{ and } \tau\},
      \]
      which is \(\prod_{\rho}(2c_{\rho})\prod_{\tau}(\pi c_{\tau}^{2}) = C2^{r_{1}}\pi^{r_{2}}\) because \(X\) is the product of \(r_{1}\) many intervals each of length \(2c_{\rho}\) and \(r_{2}\) many disks each of of radius \(c_{\tau}\). Thus \(\Vol(\mathbf{w}Z) = C2^{r_{K}+1}\pi^{r_{2}}\). By \cref{prop:covolume_of_fractional_ideal_under_j}, \(V_{j(\mc{O}_{K})} = \sqrt{|D_{K}|}\) and our choice of \(C\) gives
      \[
        \Vol(\mathbf{w}Z) > 2^{n}V_{j(\mc{O}_{K})}.
      \]
      Since \(j(\mc{O}_{K})\) is a complete lattice in \(K_{\R}\), Minkowski's lattice point theorem implies that there exists some nonzero \(\a \in \mc{O}_{K}\) such that \(j(\a) \in \mathbf{w}Z\). Now by \cref{lem:finitely_many_elements_of_fixed_norm}, there exist finitely many nonzero elements \(\a_{1},\ldots,\a_{m}\) of \(\mc{O}_{K}\) such that every \(\a \in \mc{O}_{K}\) with \(0 < \Norm_{K}(\a) \le C\) is equal to \(\a_{i}\) for some \(1 \le i \le m\) by multiplying by a unit. Set
      \[
        T = U \cap \left(\bigcup_{1 \le i \le m}j(\a_{i})^{-1}Z\right).
      \]
      Then \(T\) is a bounded subset of \(U\) since \(Z\) is a bounded subset of \(K_{\R}\) (and thus the \(j(\a_{i})^{-1}Z\) are too). We now claim that
      \[
        U = \bigcup_{\e \in \mc{O}_{K}^{\ast}}j(\e)T.
      \]
      Indeed, since \(\mathbf{w}^{-1} \in U\) for any \(\mathbf{w} \in U\)  we have shown implies that there exists a nonzero \(\a \in \mc{O}_{K}\) such that \(j(\a) \in \mathbf{w}^{-1}Z\). Hence \(j(\a) = \mathbf{w}^{-1}\mathbf{z}\) for some \(\mathbf{z} \in Z\). But as
      \[
        |\Norm_{K}(\a)| = |\Norm_{K_{\R}}(j(\a))| = |\Norm_{K_{\R}}(\mathbf{w}^{-1}\mathbf{z})| = |\Norm_{K_{\R}}(\mathbf{z})| < C,
      \]
      it follows that there exists an \(\a_{i}\) and \(\e \in \mc{O}_{K}^{\ast}\) such that \(\a_{i} = \a\e\). Writing \(\mathbf{w} = j(\a)^{-1}\mathbf{z}\) (recall that \(K_{\R}\) is commutative), we have 
      \[
        \mathbf{w} = j(\a)^{-1}\mathbf{z} = j(\a_{i}\e^{-1})^{-1}\mathbf{z} = j(\e)j(\a_{i})^{-1}\mathbf{z},
      \]
      where the last equality holds because \(j\) is a \(\Q\)-embedding. As \(\mathbf{w},j(\e) \in U\), we see that \(j(\a_{i})^{-1}\mathbf{z} \in U\) and thus \(j(\a_{i})^{-1}\mathbf{z} \in T\). But then \(\mathbf{w} \in j(\e)T \subset U\) as desired.
    \end{proof}

    By \cref{thm:unit_group_complete_lattice}, there exist elements \(\e_{1},\ldots,\e_{r_{K}}\) of \(\mc{O}_{K}^{\ast}\) such that \(\l(\e_{1}),\ldots,\l(\e_{r_{K}})\) is a basis for the unit lattice \(\L\) by taking the preimage under \(j\) of any basis for \(\L\). We say that \(\e_{1},\ldots,\e_{r_{K}}\) are a \textbf{system of fundamental units}\index{system of fundamental units} of \(K\) and we call any such element a \textbf{fundamental unit}\index{fundamental unit} for \(K\). The structure theorem for \(\mc{O}_{K}^{\ast}\) known as \textbf{Dirichlet's unit theorem}\index{Dirichlet's unit theorem} says that \(\mc{O}_{K}^{\ast}\) is a product of a root of unity in \(K\) and powers of fundamental units:

    \begin{theorem*}[Dirichlet's unit theorem]
      Let \(K\) be a number field of signature \((r_{1},r_{2})\). Then
      \[
        \mc{O}_{K}^{\ast} \cong \mu(K) \x \Z^{r_{K}}.
      \]
      In particular, if \(\e_{1},\ldots,\e_{r_{K}}\) is a system of fundamental units for \(K\) then any unit \(\e\) of \(K\) is of the form
      \[
        \e = \w\e_{1}^{\nu_{1}} \cdots \e_{r_{K}}^{\nu_{r_{K}}},
      \]
      for some \(\w \in \mu(K)\) and \(\nu_{i} \in \Z\) for \(1 \le i \le r_{K}\).
    \end{theorem*}
    \begin{proof}
      By \cref{prop:exact_sequence_for_Dirichlets_unit_theorem} we have an exact sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & \mu(K) \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r}{\l} & \L \arrow{r} & 0,
        \end{tikzcd}
      \end{center}

      and by \cref{thm:unit_group_complete_lattice} we know that \(\L\) is a free abelian group of rank \(r_{K}\). Let \(\e_{1},\ldots,\e_{r_{K}}\) be a system of fundamental units for \(K\) and let \(E\) be the subgroup of \(\mc{O}_{K}^{\ast}\) generated by them. Then \(\l\) induces an isomorphism between \(E\) and \(\L\) so that \(\mu(K) \cap E = \{1\}\) because the sequence is exact. As \(\mu(K)\) and \(E\) are subgroups, \(\mu(K) \cap E = \{1\}\) implies \(\mc{O}_{K}^{\ast} \cong \mu(K) \x E\). Since \(E \cong \Z^{r_{K}}\) (because \(\L \cong \Z^{r_{K}}\)), we have \(\mc{O}_{K}^{\ast} \cong \mu(K) \x \Z^{r_{K}}\). Moreover, from the isomorphism \(E \cong \Z^{r_{K}}\) we see that any element of \(E\) is of the form \(\e_{1}^{\nu_{1}} \cdots \e_{r_{K}}^{\nu_{r_{K}}}\) with \(\nu_{i} \in \Z\) for \(1 \le i \le r_{K}\). This completes the proof.
    \end{proof}

    Note that Dirichlet's unit theorem also implies that \(\L\) is a complete lattice in \(H\) (by the definition of \(\l\)). In other words, we may reference this result instead of \cref{thm:unit_group_complete_lattice}. We will now discuss the covolume \(V_{\L}\) of \(\L\). Let \(\e_{1},\ldots,\e_{r_{K}}\) be a system of fundamental units for \(K\). Then \(\l(\e_{1}),\ldots,\l(\e_{r_{K}})\) is a basis for \(\L\). Setting
    \[
      \l_{0} = \frac{1}{\sqrt{r_{K}+1}}\mathbf{1},
    \]
    we see that \(\l_{0}\) is a unit vector in \(\R^{r_{K}+1}\) since \(\|\mathbf{1}\| = r_{K}+1\) and is orthogonal to \(H\) because \(\Trace_{\R^{r_{K}+1}/\R}(\l_{0}) = \sqrt{r_{K}+1}\) is nonzero. As \(\l_{0}\) is orthogonal to \(\L \subset H\), we see that \(\l_{0},\l(\e_{1}),\ldots,\l(\e_{r_{K}})\) is a basis for the complete lattice \(\L' = \Z\l_{0}+\L\) in \(\R^{r_{K}+1}\). Since \(\l_{0}\) is a unit vector, the volume of the fundamental domain for \(\L'\) in \(\R^{r_{K}+1}\) is equal to the volume of the fundamental domain for \(\L\) in \(\H\). By \cref{prop:covolume_equals_volume_of_fundamental_domain}, the corresponding covolumes are equal which is to say \(V_{\L} = V_{\L'}\). So it suffices to compute \(V_{\L'}\). The generator matrix \(P\) for \(\L'\) associated to the basis \(\l_{0},\l(\e_{1}),\ldots,\l(\e_{r_{K}})\) is given by
    \[
      P = \begin{pmatrix} \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & \vdots & & \vdots \\ \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1} \end{pmatrix}.
    \]
    Adding all of the rows to a fixed row results in
    \[
      P' = \begin{pmatrix} \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & \vdots & & \vdots \\ \sqrt{r_{K}+1} & 0 & & 0 \\ \vdots & \vdots & & \vdots \\ \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1} \end{pmatrix},
    \]
    because \(\l(\e) \in H\) for all \(\e \in \mc{O}_{K}^{\ast}\). As \(P'\) differs from \(P\) be row addition, their determinants are the same. Cofactor expanding along the row with all zeros except the first entry, and that this row is arbitrary, shows
    \begin{equation}\label{equ:covolume_of_unit_lattice}
      V_{\L} = \sqrt{r_{K}+1}R_{K},
    \end{equation}
    where \(R_{K}\) is the absolute value of the determinant of any rank \(r_{K}\) minor of
    \[
      \begin{pmatrix} \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & & \vdots \\ \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1}  \end{pmatrix}.
    \]
    We call \(R_{K}\) the \textbf{regulator}\index{regulator} of \(K\). Since \(V_{\L}\) is independent of the choice of basis, the regulator \(R_{K}\) is independent of any choice of a system of fundamental units for \(K\). Moreover, since \(H\) is a real inner product space we see that the regulator is roughly a measure of the density of the fundamental units in \(K\) (recall \cref{prop:covolume_equals_volume_of_fundamental_domain}). The smaller the regulator the more dense the fundamental units are.
\end{document}